{"version":3,"sources":["utility/CanvasImgDataConverter.ts","utility/custom-events/ImageDataEvent.ts","utility/index.ts","appProperties.ts","store/movie-view/movie-view.reducer.ts","store/user/user.reducer.ts","store/movies-browser/movies-browser.reducer.ts","store/root-reducer.ts","store/store.ts","store/index.ts","pages/home-page/home-page.module.scss","components/movie-view-actions/movie-view-actions.module.scss","store/movies-browser/movies-browser.actions.ts","store/movie-view/movie-view.actions.ts","utility/easingFuctions.js","components/app-bar/app-bar.module.scss","components/movie-result-item/movie-result-item.module.scss","components/movie-result-skeleton/movie-result-skeleton.module.scss","components/movie-view-info/movie-view-info.module.scss","store/user/user.actions.ts","components/items-scroll-x/items-scroll-x.module.scss","components/movie-view-item/movie-view-item.module.scss","components/list-item/list-item.module.scss","components/search-bar/search-bar.module.scss","pages/auth-page/auth-page.module.scss","components/movie-item-image/movie-item-image.module.scss","components/items-list/items-list.module.scss","App.module.scss","components/loading-spinner/loading-spinner.module.scss","components/error-message/error-message.module.scss","pages/search-page/search-page.module.scss","components/circled-progress-bar/circled-progress-bar.module.scss","components/movie-view-screen/movie-view-screen.module.scss","myWebWorker.ts","components/pagination-controls/pagination-controls.module.scss","components/movie-results-container/movie-results-container.module.scss","components/total-search-results/total-search-results.module.scss","components/movie-item-img-bg/movie-item-img-bg.module.scss","components/movies-grid/movies-grid.module.scss","components/movie-view-background/movie-view-background.module.scss","components/movie-view-related/movie-view-related.module.scss","components/api-logo/api-logo.module.scss","hooks/useLocationPath.ts","hooks/useAuth.ts","hooks/useIsMobile.ts","components/app-bar/app-bar.component.tsx","components/app-bar/index.ts","hooks/usePrevious.ts","hooks/useSearchParam.ts","components/search-bar/search-bar-suggestions.component.tsx","components/search-bar/index.ts","components/search-bar/search-bar.component.tsx","components/pagination-controls/index.ts","components/pagination-controls/pagination-controls.component.tsx","components/loading-spinner/index.ts","components/loading-spinner/loading-spinner.component.tsx","components/movie-results-container/movie-results-container.component.tsx","components/movie-results-container/index.ts","components/error-message/index.ts","components/error-message/error-message.component.tsx","components/total-search-results/index.ts","components/total-search-results/total-search-results.component.tsx","hooks/useSavedSessionParams.ts","hooks/useSessionAvgColor.ts","hooks/useOnMovieView.ts","components/movie-item-img-bg/movie-item-img-bg.component.tsx","components/movie-item-img-bg/index.ts","components/circled-progress-bar/circled-progress-bar.component.tsx","components/circled-progress-bar/index.ts","hooks/useLockBodyScroll.ts","components/movie-view-actions/rating-modal.component.tsx","pages/auth-page/auth-page.component.tsx","pages/auth-page/index.ts","components/movie-view-actions/movie-view-actions.component.tsx","components/movie-view-actions/index.ts","components/movie-item-image/index.ts","components/movie-item-image/movie-item-image.component.tsx","components/movie-result-item/movie-result-item.component.tsx","components/movie-result-item/index.ts","components/movie-result-skeleton/index.ts","components/movie-result-skeleton/movie-result-skeleton.component.tsx","hooks/useMovieItems.ts","components/movies-grid/index.ts","components/movies-grid/movies-grid.component.tsx","pages/search-page/index.ts","pages/search-page/search-page.component.tsx","pages/home-page/subcomponents/this-week-container.component.tsx","components/items-scroll-x/items-scroll-x.component.tsx","components/items-scroll-x/index.ts","pages/home-page/subcomponents/now-playing-container.component.tsx","pages/home-page/home-page.component.tsx","pages/home-page/index.ts","components/movie-view-info/movie-view-info-children.component.tsx","components/movie-view-info/index.ts","components/movie-view-info/movie-view-info.component.tsx","components/movie-view-background/movie-view-background.component.tsx","components/movie-view-background/index.ts","components/movie-view-related/movie-view-related.component.tsx","components/movie-view-related/index.ts","components/movie-view-item/index.ts","components/movie-view-item/movie-view-item.component.tsx","utility/custom-events/MovieViewEvent.ts","hooks/useMovieForView.ts","components/movie-view-screen/movie-view-screen.component.tsx","components/movie-view-screen/index.ts","components/list-item/list-item.component.tsx","components/list-item/index.ts","components/items-list/items-list.component.tsx","components/items-list/index.ts","pages/watchlist-page/index.ts","pages/watchlist-page/watchlist-page.component.tsx","pages/favorites-page/index.ts","pages/favorites-page/favorites-page.component.tsx","components/auth-route/index.ts","components/auth-route/auth-route.component.tsx","components/api-logo/logo.svg","components/api-logo/api-logo.component.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["CanvasImgDataConverter","imgEl","data","canvas","CANVAS","context","CONTEXT","Error","width","height","length","i","rgb","r","g","b","jpgData","count","naturalHeight","offsetHeight","naturalWidth","offsetWidth","drawImage","getImageData","toDataURL","e","console","error","blockSize","averageColor","document","createElement","getContext","ImageDataEvent","movieId","imgData","detail","CustomEvent","buildFetchMovieViewUrl","appProperties","newSessionUrl","getAccountUrl","itemsPerPageUI","checkIsMobile","window","innerWidth","hslInterval","weight","h1","s1","l1","h2","s2","l2","h_toAdd","Math","abs","s_toAdd","l_toAdd","hslToHex","h","s","l","hue2rgb","p","q","t","toHex","x","hex","round","toString","convertResultsData","results","pageApi","transformedData","startIndex","forEach","value","index","insertIndex","key","onWorkerFetchedDoneEvent","blobUrl","id","sessionStorage","getItem","String","URL","revokeObjectURL","img","Image","crossOrigin","onload","movieImgDataObj","makeMovieImgSessionObj","movieImgSessionObj","setItem","JSON","stringify","dispatchEvent","src","goFetchPostersOnWorker","item_s_","toFetch","isArray","Array","filter","poster_path","worker","postMessage","getMovieImgObjFromSession","imgJsonData","parse","months","getReadableDate","isoDate","date","split","map","n","Number","month","day","year","formatToUSD","Intl","NumberFormat","currency","format","minutesToRuntimeDisplay","minutes","hours","floor","remaining","getSearchParam","paramName","query","location","hash","fixParamValue","URLSearchParams","get","param","paramNum","Object","is","NaN","setSearchParam","hashQuery","newParams","delete","set","substr","isMovieView","movie","goFetchMovieView","movieId_or_Item","Promise","resolve","fetch","then","res","json","catch","goFetch","url","options","log","scrollToTop","scrollingElement","scrollTo","goFetchUserAccount","a","session_id","localStorage","searchParams","search","requestToken","approved","goFetchSessionId","fetchedSessionId","fetchUrl","alert","request_token","init","method","body","headers","calculatePageOnApi","pageUI","offSet","offBy","ceil","getHashPath","includes","getHashQuery","isValidRequestToken","tokenResponse","Date","expires_at","getTime","now","process","API_KEY","REACT_APP_API_KEY","NODE_ENV","BASE_API_URL","REDIRECT_LOGGING","getApiKeyQuery","getSessionQuery","getPosterSrcPathPrefix","size","buildFetchMovieSearchUrl","searchTerm","page","addPath","searchPageTransitionConfig","duration","easing","easeOutQuad","getLogoutConfig","newRequestTokenUrl","buildLoginRedirectUrl","itemActions","favorite","favState","media_type","media_id","watchlist","watchState","rate","unRate","getItemsBrowseUrl","name","pageOnApi","browseUrl","INITIAL_STATE","item","movieViewReducer","state","action","type","MovieViewActionsTypes","SET_MOVIE_VIEW","payload","CLEAR_MOVIE_VIEW","userReducer","UserActionsTypes","SET_USER","CLEAR_USER","searchData","searchError","isFetching","isFetchingMore","apiFetchedPages","unshiftToObj","obj","newItem","temp","tempHold","keys","removeFromObjById","removed","numKey","undefined","makeMoviesBrowserReducer","MoviesBrowserActionTypes","UNSHIFT_TO_LIST_ITEMS","total_pages","total_results","REMOVE_FROM_LIST_ITEMS","CLEAR_FETCHED_MOVIES","FETCH_MOVIES_START","FETCH_MOVIES_SUCCESS","fetchedData","errors","FETCH_MOVIES_FAILURE","FETCH_MORE_MOVIES_START","FETCH_MORE_MOVIES_SUCCESS","fetchedPage","Set","FETCH_MORE_MOVIES_FAILURE","rootReducer","combineReducers","store","configureStore","reducer","module","exports","getMoviesBrowserActions","unshiftToFavorites","removeFromListItems","clearFetchedMovies","fetchMoviesStart","fetchMoviesSuccess","fetchMoviesFailure","fetchMoviesAsync","dispatch","ok","fetchMoreMoviesStart","fetchMoreMoviesSuccess","fetchMoreMoviesFailure","fetchMoreMoviesAsync","nextPageOnApi","otherPagesOnApi","getState","resultsObject","checkIfFetchMore","nextUIPageOnApi","pagesToFetch","isFetchPage","push","setMovieView","easeOutCubic","easeOutQuart","setUser","user","clearUser","Worker","useLocationPath","useState","path","setPath","useLayoutEffect","listener","oldURL","newURL","oldPath","newPath","addEventListener","removeEventListener","selectUser","equalUser","left","right","logOut","success","removeItem","logIn","open","useAuth","useSelector","isAuth","signOut","signIn","useIsMobile","isMobile","setIsMobile","useEffect","onresize","searchActions","navItems","icon","HomeIcon","text","to","SearchIcon","FavoriteIcon","BookmarkIcon","NavItem","Icon","setOpen","active","username","className","styles","navItem","onClick","currentTarget","target","preventDefault","aria-current","IconButton","color","aria-label","navItemIcon","avatar","charAt","toUpperCase","navItemTxt","AppBar","isOpen","pathname","root","onMouseEnter","onMouseLeave","toolBar","logo","AccountCircleIcon","usePrevious","ref","useRef","current","useSearchParam","onParamChange","paramNameRef","selectedParam","setSelectedParam","fixSelectedParam","selectedRef","oldSelectedParam","oldQuery","newQuery","oldParam","newParam","updateParam","useCallback","extraParam","newSearchParams","newValue","SearchBarSuggestions","keyword","onSubmit","inputRef","suggestions","setSuggestions","selected","setSelected","visible","setVisible","isMount","setTimeout","isEffect","slice","ev","code","newSelected","title","handleClickSubmit","suggestionsDropdown","aria-selected","bind","SearchBar","React","memo","isMounted","setError","setInputTxt","searchParam","inputTxt","keyWord","setKeyWord","isFocus","setFocus","setFocusOn","focus","select","setFocusOff","blur","activeElement","is-focused","autoComplete","TextField","bar","label","helperText","onBlur","onChange","onFocus","inputProps","event","onKeyDown","PaginationControls","totalPages","currentPage","setCurrentPage","movieIdParam","goToNextPage","goToPreviousPage","keydownListener","altKey","ctrlKey","shiftKey","MobileStepper","position","variant","steps","activeStep","nextButton","Button","disabled","backButton","LoadingSpinner","darken","delay","fixed","rest","mounted","style","opacity","CircularProgress","MovieItemsContainer","MovieResultsContainer","children","prevPage","isNextSlide","transition","useTransition","initial","translateX","from","enter","leave","config","unique","getTransitionConfig","props","div","transform","interpolate","v","ErrorMessage","message","TotalSearchResults","totalResults","onHashChange","locationPath","searchQuery","useSavedSessionParams","hashPath","savedPathParams","useSessionAvgColor","idRef","setImgData","imgObj","onColorReadyListener","movieIdSaved","useOnMovieView","configRef","setProps","onEvent","configPropName","capitalize","configProp","newStateProps","MovieItemImgBg","itemView","isRevealed","setRevealed","opacityReveal","onEnter","onClose","opacityOnMovView","eventState","useSpring","imgSrc","alt","item-view","imageRendering","display","backgroundColor","defaultProps","circleCircumference","circleRadius","PI","minScoreColor","maxScoreColor","CircledProgressBar","score","rootRef","progressMultiplier","progressColor","strokeDashOffsetVal","stroke","strokeDashoffset","ignore","visibility","viewBox","overflow","cx","viewBoxSize","cy","fill","strokeWidth","zIndex","circle","strokeDasharray","strokeLinecap","strokeMiterlimit","scoreValue","toPrecision","useLockBodyScroll","maxWidth","maxWidthRef","originalStyle","getComputedStyle","valuesMap","0","1","2","3","4","5","6","7","8","9","10","RatingModal","rateItem","defaultValue","setRatingModal","setValue","onTouch","getBoundingClientRect","maxPoint","touchPoint","targetTouches","clientX","pointPercent","resultPercent","ratingModalContainer","clientY","innerHeight","ratingModal","removeButton","Rating","precision","onTouchMove","onTouchStart","mobileSubmit","AuthPage","setRequestToken","localToken","getValidLocalToken","tokenData","userField","isLoading","rated","initial_state","favoriteActions","watchlistActions","checkAllowToRemove","itemName","confirm","MovieViewActionButtons","MovieViewActions","showLogin","setShowLogin","useReducer","setLoading","actionName","auth","ratedValue","ignoreActions","Tooltip","enterDelay","PopperProps","toolTip","iconWrapper","active-icon","action-name","is-loading","newFavValue","newVal","prev","showAuth","xButton","MovieItemImage","backGroundUrl","backgroundImage","image","imageIcon","onViewConfigNotItemView","onLeave","MovieResultItem","itemRef","vote_average","release_date","overview","imgSrcPath","setImgSrcPath","initialOnViewProps","onView","onMovieProps","propsState","titleStyle","fontSize","newSrc","visibilityState","classList","add","runAnimation","remove","memoizedItemImage","useMemo","content","wrapper","header","overViewSection","info","MovieResultSkeleton","imageWrapper","infoWrapper","isMovieItem","isFetchingOrLengthEquality","newState","oldState","selectItemsUIPortion","browseState","fromIndex","grabIndex","useMovieItems","totalResultsApi","actionsInit","actionsRef","nameRef","setPage","clearTimeout","items","totalPagesUI","goToPage","MoviesGrid","Grid","container","alignItems","spacing","xs","sm","md","SearchPage","searchHead","ThisWeekItem","onClickHandler","gridArea","movie-title","gridItem","hoveredBg","ThisWeekContainer","gridContainer","backdrop_path","RelatedMovieItem","canClick","itemClassName","relatedMovieItemWrapper","onDragStart","relatedMovieItem","isLoadingItem","noPoster","prevProps","nextProps","setClientXOnRef","MovieItemsXScrollList","ItemsScrollX","noResultsFound","scrollByX","infoTabMessage","scrollXPos","setScrollXPos","onFrame","scroll","update","onMouseMoveHandler","maxScrollLeft","scrollWidth","clientWidth","movementX","buttons","prevState","nextState","onWheelHandler","deltaY","onDownRef","onUpRef","itemChildren","onWheel","onMouseMove","onMouseDown","onMouseUp","overflowX","noMoviesFound","NowPlayingContainer","mainItem","nowPlayingContainer","mainMovieItem","subMovieItemContainerWrapper","subMovieItemContainer","subMovieItemContainerItem","SpotlightSection","sectionSpotlight","sectionTitle","sectionContentWrapper","sectionContent","HomePage","MovieViewInfoChildren","movieView","budget","homepage","revenue","runtime","status","hostname","jsx","sideInfoItem","href","rel","trail","Element","animated","MovieViewInfo","colorSessionObj","fade","defaultBgColor","MovieViewBackground","transitionDuration","cssProps","bgColor","bgStyle","background","MovieViewRelated","relatedMovies","setRelatedMovies","MovieViewItem","movieItem","movieItemRef","isMovView","isViewing","mainInfo","mobileRateActions","mobileOverview","sideInfo","MovieViewEvent","movieViewItem","onSetMovieItem","selectedAreEqual","oldItem","useMovieForView","setMovieId","clearMovieId","selectMovieItem","selectedMovie","fromSelectedId","movieForViewState","setMovieForViewState","MovieViewRootDiv","MovieViewScreen","transitionConfig","animatedDiv","getElementById","domRect","initialPosition","animatedDomRect","firstElementChild","top","bottom","mass","tension","friction","clamp","onStart","onRest","prevConfig","appliedConfig","transitionDiv","ListItem","movieTitle","onSetMovieView","actionButtons","ListChild","initialStyles","maxHeight","paddingBottom","next","ItemsList","itemType","head","WatchlistPage","FavoritesPage","AuthRoute","Component","component","render","_extends","assign","arguments","source","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","y1","x2","y2","gradientUnits","offset","stopColor","d","_ref","svgRef","ForwardRef","forwardRef","ApiLogo","routesChildren","exact","App","clear","main","Container","isLocalhost","Boolean","match","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","onmessage","origin","response","contentType","ready","unregister","reload","checkValidServiceWorker","require","default","ReactDOM","StylesProvider","injectFirst"],"mappings":"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","file":"static/js/main.4e94fa6d.chunk.js","sourcesContent":["import IMovieImgSessionObj from \"../interfaces/app-types/IMovieImgSessionObj\";\r\n\r\nclass CanvasImgDataConverter {\r\n    private static CANVAS = document.createElement('canvas');\r\n    private static CONTEXT = CanvasImgDataConverter.CANVAS.getContext && CanvasImgDataConverter.CANVAS.getContext('2d');\r\n\r\n    public static makeMovieImgSessionObj(imgEl: HTMLImageElement): IMovieImgSessionObj | never {\r\n        let canvas = CanvasImgDataConverter.CANVAS;\r\n        let context = CanvasImgDataConverter.CONTEXT;\r\n\r\n        if (!context) {\r\n            throw new Error(\"canvas context not supported\");\r\n        }\r\n        let data: ImageData;\r\n        let blockSize = 8, // only visit every 8 pixels\r\n            width, height,\r\n            i = -4,\r\n            length,\r\n            rgb = {r: 0, g: 0, b: 0}, jpgData = '',\r\n            count = 0;\r\n\r\n        height = canvas.height = imgEl.naturalHeight || imgEl.offsetHeight || imgEl.height;\r\n        width  = canvas.width  = imgEl.naturalWidth  || imgEl.offsetWidth  || imgEl.width;\r\n\r\n        context.drawImage(imgEl, 0, 0);\r\n\r\n        try {\r\n            data = context.getImageData(0, 0, width, height);\r\n            jpgData = canvas.toDataURL(\"image/jpeg\", .1);\r\n        } catch(e) {\r\n            console.error(e)\r\n            throw new Error(e);\r\n        }\r\n\r\n        length = data.data.length;\r\n\r\n        while ( (i += blockSize * 4) < length ) {\r\n            ++count;\r\n            rgb.r += data.data[i];\r\n            rgb.g += data.data[i+1];\r\n            rgb.b += data.data[i+2];\r\n        }\r\n\r\n        // ~~ used to floor values\r\n        rgb.r = ~~(rgb.r/count);\r\n        rgb.g = ~~(rgb.g/count);\r\n        rgb.b = ~~(rgb.b/count);\r\n\r\n        return {\r\n            jpgData,\r\n            averageColor: `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`\r\n        };\r\n    }\r\n}\r\n\r\nexport default CanvasImgDataConverter;","import IMovieImgSessionObj from \"../../interfaces/app-types/IMovieImgSessionObj\";\r\n\r\nclass ImageDataEvent extends CustomEvent<ImageDataEventDetail> {\r\n    constructor(movieId: number, imgData: IMovieImgSessionObj) {\r\n        super(\"imageData\", {\r\n            detail: {\r\n                movieId,\r\n                imgData\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\ninterface ImageDataEventDetail {\r\n    movieId: number;\r\n    imgData: IMovieImgSessionObj;\r\n}\r\n\r\nexport default ImageDataEvent;","import IMovieResultItem from \"../interfaces/app-types/IMovieResultItem\";\r\nimport { ResultItemsObject } from \"../interfaces/app-types/IMoviesSearchData\";\r\nimport IMovieImgSessionObj from \"../interfaces/app-types/IMovieImgSessionObj\";\r\nimport appProperties from \"../appProperties\";\r\nimport CanvasImgDataConverter from \"./CanvasImgDataConverter\";\r\nimport WorkerFetchedDoneEvent from \"../interfaces/custom-events-types/WorkerFetchedDoneEvent\";\r\nimport ImageDataEvent from \"./custom-events/ImageDataEvent\";\r\nimport SearchParamsMap from \"../interfaces/app-types/SearchParamsMap\";\r\nimport IMovieView from \"../interfaces/app-types/IMovieView\";\r\nimport { UserState } from \"store/user\";\r\nimport TokenData from \"../interfaces/app-types/TokenData\";\r\n\r\nconst {buildFetchMovieViewUrl, newSessionUrl, getAccountUrl, itemsPerPageUI} = appProperties;\r\n\r\nexport function wait(time: number) {\r\n\treturn new Promise((resolve) => {\r\n\t\tsetTimeout(resolve, time);\r\n\t});\r\n}\r\n\r\nexport function checkIsMobile(): boolean {\r\n\treturn window.innerWidth <= 600;\r\n}\r\n\r\nexport function hslInterval(\r\n\t[h1, s1, l1]: [number, number, number],\r\n\t[h2, s2, l2]: [number, number, number],\r\n\tweight: number): [number, number, number] {\r\n\t// difference * weight\r\n\tconst [h_toAdd, s_toAdd, l_toAdd] = [\r\n\t\tMath.abs(h1 - h2) * weight,\r\n\t\tMath.abs(s1 - s2) * weight,\r\n\t\tMath.abs(l1 - l2) * weight,\r\n\t];\r\n\r\n\treturn [\r\n\t\th1 < h2 ? h1 + h_toAdd : h1 - h_toAdd,\r\n\t\ts1 < s2 ? s1 + s_toAdd : s1 - s_toAdd,\r\n\t\tl1 < l2 ? l1 + l_toAdd : l1 - l_toAdd,\r\n\t];\r\n}\r\n\r\nexport function hslToHex([h, s, l]: [number, number, number]): string {\r\n\th /= 360;\r\n\ts /= 100;\r\n\tl /= 100;\r\n\tlet r, g, b;\r\n\tif (s === 0) {\r\n\t\tr = g = b = l; // achromatic\r\n\t} else {\r\n\t\tconst hue2rgb = (p: number, q: number, t: number) => {\r\n\t\t\tif (t < 0) t += 1;\r\n\t\t\tif (t > 1) t -= 1;\r\n\t\t\tif (t < 1 / 6) return p + (q - p) * 6 * t;\r\n\t\t\tif (t < 1 / 2) return q;\r\n\t\t\tif (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\r\n\t\t\treturn p;\r\n\t\t};\r\n\t\tconst q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n\t\tconst p = 2 * l - q;\r\n\t\tr = hue2rgb(p, q, h + 1 / 3);\r\n\t\tg = hue2rgb(p, q, h);\r\n\t\tb = hue2rgb(p, q, h - 1 / 3);\r\n\t}\r\n\tconst toHex = (x: number) => {\r\n\t\tconst hex = Math.round(x * 255).toString(16);\r\n\t\treturn hex.length === 1 ? '0' + hex : hex;\r\n\t};\r\n\treturn `#${toHex(r)}${toHex(g)}${toHex(b)}`;\r\n}\r\n\r\n\r\n/**\r\n * Converts IMovieResultItem[] to ResultItemsObject\r\n * @see ResultItemsObject\r\n * @see IMovieResultItem\r\n * @return {ResultItemsObject} The transformed array to a map(object)\r\n * */\r\nexport function convertResultsData(results: IMovieResultItem[], pageApi: number = 1): ResultItemsObject {\r\n\tlet transformedData: ResultItemsObject = {};\r\n\tlet startIndex = (pageApi - 1) * 20;\r\n\tresults.forEach((value, index) => {\r\n\t\tlet insertIndex = startIndex + index;\r\n\t\ttransformedData[insertIndex] = value\r\n\t\t// @ts-ignore\r\n\t\ttransformedData[insertIndex].key = insertIndex\r\n\t});\r\n\treturn transformedData;\r\n}\r\n\r\nexport function onWorkerFetchedDoneEvent({data: {blobUrl, id}}: WorkerFetchedDoneEvent) {\r\n\tif (sessionStorage.getItem(String(id))) {\r\n\t\tURL.revokeObjectURL(blobUrl);\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet img = new Image();\r\n\timg.crossOrigin = \"anonymous\";\r\n\timg.onload = () => {\r\n\t\ttry {\r\n\t\t\tlet movieImgDataObj = (CanvasImgDataConverter.makeMovieImgSessionObj(img) as IMovieImgSessionObj);\r\n\t\t\tsaveMovieImgDataOnSession(movieImgDataObj, id);\r\n\t\t\tdispatchEvent(new ImageDataEvent(id, movieImgDataObj));\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error(e);\r\n\t\t}\r\n\t};\r\n\timg.src = blobUrl;\r\n}\r\n\r\nexport function goFetchPostersOnWorker(item_s_: IMovieResultItem[] | IMovieResultItem | undefined): void {\r\n\tif (!item_s_) return;\r\n\r\n\tconst isArray = Array.isArray(item_s_);\r\n\tlet toFetch: IMovieResultItem[];\r\n\r\n\tif (isArray) {\r\n\t\ttoFetch = (item_s_ as IMovieResultItem[]).filter(({id, poster_path}) =>\r\n\t\t\tposter_path && !sessionStorage.getItem(String(id))\r\n\t\t);\r\n\t} else toFetch = [item_s_ as IMovieResultItem];\r\n\r\n\tif (!(isArray && (toFetch as []).length === 0))\r\n\t\twindow.worker.postMessage(toFetch);\r\n}\r\n\r\nfunction saveMovieImgDataOnSession(movieImgSessionObj: IMovieImgSessionObj, movieId: number) {\r\n\tsessionStorage.setItem(String(movieId), JSON.stringify(movieImgSessionObj));\r\n}\r\n\r\nexport function getMovieImgObjFromSession(movieId: number): IMovieImgSessionObj | undefined {\r\n\tlet movieImgDataObj: IMovieImgSessionObj | undefined;\r\n\tlet imgJsonData = sessionStorage.getItem(String(movieId));\r\n\r\n\tif (imgJsonData)\r\n\t\tmovieImgDataObj = (JSON.parse(imgJsonData) as IMovieImgSessionObj);\r\n\r\n\treturn movieImgDataObj;\r\n}\r\n\r\nexport function clearTimeouts(...timeouts: (NodeJS.Timeout | undefined)[]): void {\r\n\tfor (let timeout of timeouts)\r\n\t\tif (timeout)\r\n\t\t\tclearTimeout(timeout);\r\n}\r\n\r\nconst months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\r\n\r\nexport function getReadableDate(isoDate: string) {\r\n\tlet date = isoDate.split('-').map(n => Number(n));\r\n\tlet month = months[date[1] - 1];\r\n\tlet day = date[2];\r\n\tlet year = date[0];\r\n\r\n\treturn `${month} ${day}, ${year}`;\r\n}\r\n\r\nexport const formatToUSD = new Intl.NumberFormat('en-US', {\r\n\tcurrency: \"USD\"\r\n}).format;\r\n\r\nexport function minutesToRuntimeDisplay(minutes: number) {\r\n\tlet hours = Math.floor(minutes / 60);\r\n\tlet remaining = minutes % 60;\r\n\treturn `${hours}h ${remaining}m`;\r\n}\r\n\r\nexport function getSearchParam<Param extends keyof SearchParamsMap>(paramName: Param): SearchParamsMap[Param] | null {\r\n\tlet query = window.location.hash.split(\"?\")[1];\r\n\tlet param = new URLSearchParams(query).get(paramName);\r\n\treturn fixParamValue<Param>(param);\r\n}\r\n\r\nexport function fixParamValue<Param extends keyof SearchParamsMap>(param: string | null) {\r\n\tif(param === null) return null;\r\n\tlet paramNum = Number(param);\r\n\treturn (Object.is(paramNum, NaN) ? param : paramNum) as SearchParamsMap[Param] | null;\r\n}\r\n\r\nexport function setSearchParam<Param extends keyof SearchParamsMap>\r\n(paramName: Param, value: SearchParamsMap[Param] | null): void {\r\n\tlet [hash, hashQuery] = window.location.hash.split(\"?\");\r\n\tlet newParams = new URLSearchParams(hashQuery);\r\n\r\n\tvalue === null ?\r\n\t\tnewParams.delete(paramName) : newParams.set(paramName, String(value));\r\n\r\n\twindow.location.hash = hash.substr(1) + \"?\" + newParams.toString();\r\n}\r\n\r\nexport function isMovieView(movie: IMovieResultItem | IMovieView | null): movie is IMovieView {\r\n\tif (!movie) return false;\r\n\treturn 'budget' in movie;\r\n}\r\n\r\nexport function goFetchMovieView(movieId_or_Item: number | IMovieResultItem): Promise<IMovieView> {\r\n\tlet id: number;\r\n\r\n\tif (typeof movieId_or_Item === \"number\") {\r\n\t\tid = movieId_or_Item;\r\n\t} else {\r\n\t\tid = movieId_or_Item.id;\r\n\t\tgoFetchPostersOnWorker(movieId_or_Item);\r\n\t}\r\n\r\n\treturn new Promise<IMovieView>((resolve) => {\r\n\t\tfetch(buildFetchMovieViewUrl(id))\r\n\t\t\t.then(res => res.json())\r\n\t\t\t.then(resolve)\r\n\t\t\t.catch(console.error);\r\n\t});\r\n}\r\n\r\nexport function goFetch<T = any>(url: string, options?: RequestInit) {\r\n\treturn new Promise<T>((resolve) => {\r\n\t\tfetch(url, options)\r\n\t\t\t.then(res => res.json())\r\n\t\t\t.then(resolve)\r\n\t\t\t.catch(console.log);\r\n\t});\r\n}\r\n\r\nexport function scrollToTop() {\r\n\tdocument.scrollingElement?.scrollTo(0, 0);\r\n}\r\n\r\nexport async function goFetchUserAccount(): Promise<UserState> {\r\n\tlet fetchUrl: string;\r\n\r\n\tconst session_id = localStorage.getItem(\"session_id\");\r\n\r\n\tif (!session_id) {\r\n\t\tconst searchParams = new URLSearchParams(window.location.search);\r\n\t\tconst requestToken = searchParams.get('request_token');\r\n\t\tconst approved = searchParams.get('approved');\r\n\r\n\t\tif (requestToken && approved && approved === 'true') {\r\n\t\t\ttry {\r\n\t\t\t\tlet fetchedSessionId = await goFetchSessionId(requestToken);\r\n\t\t\t\tfetchUrl = getAccountUrl(fetchedSessionId);\r\n\t\t\t\talert(\"Successfully logged in!\");\r\n\t\t\t\tlocalStorage.setItem(\"session_id\", fetchedSessionId);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tthrow e;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// eslint-disable-next-line no-throw-literal\r\n\t\telse throw \"No user logged in\";\r\n\r\n\t} else {\r\n\t\tfetchUrl = getAccountUrl(session_id);\r\n\t}\r\n\r\n\tconst res = await fetch(fetchUrl);\r\n\r\n\treturn await res.json();\r\n}\r\n\r\nasync function goFetchSessionId(request_token: string): Promise<string> {\r\n\r\n\tconst init: RequestInit = {\r\n\t\tmethod: 'POST',\r\n\t\tbody: JSON.stringify({request_token}),\r\n\t\theaders: {\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t}\r\n\t};\r\n\r\n\tconst res = await fetch(newSessionUrl, init);\r\n\r\n\tconst data = await res.json();\r\n\r\n\treturn data.session_id as string;\r\n}\r\n\r\n/**\r\n * @return The corresponding page in API based on the current page on UI\r\n * */\r\nexport function calculatePageOnApi(pageUI: number, offSet: \"current\" | \"previous\" | \"next\" = \"current\") {\r\n\t// (API = 20 items/page) & (UI = 9 items/page)\r\n\tlet offBy = 0;\r\n\tswitch (offSet) {\r\n\t\tcase \"previous\":\r\n\t\t\t(offBy = -itemsPerPageUI);\r\n\t\t\tbreak;\r\n\t\tcase \"next\":\r\n\t\t\t(offBy = itemsPerPageUI);\r\n\t\t\tbreak;\r\n\t\tdefault: break;\r\n\t}\r\n\treturn Math.ceil(\r\n\t\t((pageUI * itemsPerPageUI) + offBy) / 20\r\n\t) || 1;\r\n}\r\n\r\n\r\nexport function goFetchRequestToken() {\r\n\r\n}\r\n\r\n/**\r\n *  @return the current path on a HashBrowser-based url\r\n *  @param url Can be either a full URL of a hash portion\r\n * */\r\nexport const getHashPath = (url: string = window.location.hash): string =>\r\n\t(url[0] === '#' ? url.substr(1) :\r\n\t\t\t(url.includes('#') ? (url.split('#')[1] || '') : url)\r\n\t).split('?')[0] || '/';\r\n\r\n/**\r\n *  @return a string of query parameters on a HashBrowser-based url\r\n *  @param url Can be either a full URL of a hash portion\r\n * */\r\nexport const getHashQuery = (url: string = window.location.hash): string =>\r\n\t(url[0] === '#' ? url.substr(1) :\r\n\t\t\t(url.includes('#') ? (url.split('#')[1] || '') : url)\r\n\t).split('?')[1] || '';\r\n\r\nexport function isValidRequestToken(tokenResponse: TokenData): boolean {\r\n\tconst expireTime = new Date(tokenResponse.expires_at).getTime();\r\n\t// at least five(5) minutes remaining until expiration\r\n\treturn expireTime - Date.now() > 300_000;\r\n}","import { easeOutQuad } from \"./utility/easingFuctions\";\r\nimport { MoviesBrowseNames } from \"store/movies-browser\";\r\n\r\nconst {REACT_APP_API_KEY: API_KEY, NODE_ENV} = process.env;\r\nconst BASE_API_URL = 'https://api.themoviedb.org/3'\r\n\r\ntype ImageSizes = \"200\" | \"300\" | \"400\" | \"500\";\r\n\r\nconst REDIRECT_LOGGING = NODE_ENV === 'development' ?\r\n    'http://192.168.1.8:3000/' : 'http://jrdeveloper.me/movie-ratings-app/';\r\n\r\nconst getApiKeyQuery = () => `api_key=${API_KEY}`;\r\nconst getSessionQuery = () => `session_id=${localStorage.getItem(\"session_id\")}`;\r\n\r\nconst appProperties = {\r\n    //application properties here\r\n    itemsPerPageUI: 9,\r\n\r\n    getPosterSrcPathPrefix: (size: ImageSizes = \"200\") =>  `https://image.tmdb.org/t/p/w${size}`,\r\n\r\n    buildFetchMovieSearchUrl: (searchTerm: string, page: number = 1) =>\r\n        `${BASE_API_URL}/search/movie?${getApiKeyQuery()}&query=${searchTerm}&page=${page}&include_adult=false`,\r\n\r\n    buildFetchMovieViewUrl: (movieId: number, addPath?: string) => {\r\n        return `${BASE_API_URL}/movie/${movieId}${addPath || ''}?${getApiKeyQuery()}`;\r\n    },\r\n\r\n    searchPageTransitionConfig: {\r\n        duration: 400,\r\n        easing: easeOutQuad,\r\n    },\r\n\r\n    newSessionUrl: `${BASE_API_URL}/authentication/session/new?${getApiKeyQuery()}`,\r\n\r\n    getAccountUrl: (session_id: string) =>\r\n        `${BASE_API_URL}/account?${getApiKeyQuery()}&session_id=${session_id}`,\r\n\r\n    getLogoutConfig: (session_id: string): [string, RequestInit] => [\r\n        `${BASE_API_URL}/authentication/session?${getApiKeyQuery()}`,\r\n        {\r\n            method: 'DELETE',\r\n            body: JSON.stringify({session_id}),\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n\r\n\r\n            }\r\n        }\r\n    ],\r\n\r\n    newRequestTokenUrl: `${BASE_API_URL}/authentication/token/new?${getApiKeyQuery()}`,\r\n\r\n    buildLoginRedirectUrl: (request_token: string) =>\r\n        `https://www.themoviedb.org/authenticate/${request_token}?redirect_to=${REDIRECT_LOGGING}`,\r\n\r\n    itemActions: {\r\n        favorite: async (favState: boolean, movieId: number) => {\r\n            const url = `${BASE_API_URL}/account/0/favorite?${getApiKeyQuery()}&${getSessionQuery()}`\r\n            await fetch(url, {\r\n                body: JSON.stringify({\r\n                    media_type: \"movie\",\r\n                    media_id: movieId,\r\n                    favorite: favState\r\n                }),\r\n                headers: {\r\n                    'Content-Type': 'application/json;charset=utf-8'\r\n                },\r\n                method: 'POST'\r\n            })\r\n            return true;\r\n        },\r\n        watchlist: async (watchState: boolean, movieId: number) => {\r\n            const url = `${BASE_API_URL}/account/0/watchlist?${getApiKeyQuery()}&${getSessionQuery()}`\r\n            await fetch(url, {\r\n                body: JSON.stringify({\r\n                    media_type: \"movie\",\r\n                    media_id: movieId,\r\n                    watchlist: watchState\r\n                }),\r\n                headers: {\r\n                    'Content-Type': 'application/json;charset=utf-8'\r\n                },\r\n                method: 'POST'\r\n            })\r\n            return true;\r\n        },\r\n        rate: async (value: number, movieId: number) => {\r\n            const url = `${BASE_API_URL}/movie/${movieId}/rating?${getApiKeyQuery()}&${getSessionQuery()}`\r\n            await fetch(url, {\r\n                body: JSON.stringify({\r\n                    value\r\n                }),\r\n                headers: {\r\n                    'Content-Type': 'application/json;charset=utf-8'\r\n                },\r\n                method: 'POST'\r\n            })\r\n            return true;\r\n        },\r\n        unRate: async (movieId: number) => {\r\n            const url = `${BASE_API_URL}/movie/${movieId}/rating?${getApiKeyQuery()}&${getSessionQuery()}`\r\n            await fetch(url, {\r\n                headers: {\r\n                    'Content-Type': 'application/json;charset=utf-8'\r\n                },\r\n                method: 'DELETE'\r\n            })\r\n            return true;\r\n        }\r\n\r\n    },\r\n\r\n    getItemsBrowseUrl(name: MoviesBrowseNames, searchTerm: string = '', pageOnApi: number = 1): string {\r\n        let browseUrl = BASE_API_URL;\r\n\r\n        // concat path\r\n        switch (name) {\r\n            case \"favorite\":\r\n                browseUrl += \"/account/0/favorite/movies\";\r\n                break;\r\n            case \"watchlist\":\r\n                browseUrl += \"/account/0/watchlist/movies\";\r\n                break;\r\n            case \"search\":\r\n                browseUrl += \"/search/movie\";\r\n                break;\r\n            case \"nowPlaying\":\r\n                browseUrl += \"/movie/now_playing\";\r\n                break;\r\n            case \"trendingWeek\":\r\n                browseUrl += \"/trending/movie/week\";\r\n                break;\r\n        }\r\n\r\n        browseUrl += \"?\";\r\n\r\n\r\n        // concat query\r\n        switch (name) {\r\n            case \"favorite\":\r\n                browseUrl += getSessionQuery() + \"&sort_by=created_at.desc\";\r\n                break;\r\n            case \"watchlist\":\r\n                browseUrl += getSessionQuery() + \"&sort_by=created_at.desc\";\r\n                break;\r\n            case \"search\":\r\n                browseUrl += `query=${searchTerm}&include_adult=false`\r\n                break;\r\n            case \"nowPlaying\":\r\n                break;\r\n            case \"trendingWeek\":\r\n                break;\r\n        }\r\n\r\n        return browseUrl + \"&\" + getApiKeyQuery() + `&page=${pageOnApi}`;\r\n    }\r\n\r\n};\r\n\r\nexport default appProperties;","import { IMovieViewActions } from \"./index\";\r\nimport IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\nimport { MovieViewActionsTypes } from \"./movie-view.actions\";\r\nimport { setSearchParam } from \"utility\";\r\n\r\nexport interface MovieItemState {\r\n\titem: IMovieResultItem | null,\r\n}\r\n\r\nconst INITIAL_STATE: MovieItemState = {\r\n\titem: null,\r\n};\r\n\r\nconst movieViewReducer = (state = INITIAL_STATE, action: IMovieViewActions): MovieItemState => {\r\n\tswitch (action.type) {\r\n\t\tcase MovieViewActionsTypes.SET_MOVIE_VIEW:\r\n\t\t\tsetSearchParam(\"movieId\", action.payload.id);\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\titem: action.payload,\r\n\t\t\t};\r\n\t\tcase MovieViewActionsTypes.CLEAR_MOVIE_VIEW:\r\n\t\t\treturn {\r\n\t\t\t\t...INITIAL_STATE\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n};\r\n\r\nexport default movieViewReducer;","import { UserActions, UserState } from \"./index\";\r\nimport { UserActionsTypes } from \"./user.actions\";\r\n\r\nconst INITIAL_STATE: UserState | null = null;\r\n\r\nconst userReducer = ( state = INITIAL_STATE, action: UserActions ): UserState | null => {\r\n    switch (action.type) {\r\n\t    case UserActionsTypes.SET_USER:\r\n\t    \treturn action.payload\r\n\t    case UserActionsTypes.CLEAR_USER:\r\n\t    \treturn null;\r\n\t    default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default userReducer;","import IMoviesSearchData, { ResultItemsObject } from \"../../interfaces/app-types/IMoviesSearchData\";\r\nimport IMoviesSearchError from \"../../interfaces/app-types/IMoviesSearchError\";\r\nimport { MoviesBrowserActionTypes } from \"./movies-browser.actions\";\r\nimport { ISearchActions, MoviesBrowseNames } from \"./\";\r\nimport { Reducer } from \"redux\";\r\nimport IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\n\r\nexport interface MoviesBrowseState {\r\n\tsearchData: IMoviesSearchData | null;\r\n\tsearchError: IMoviesSearchError | null;\r\n\tisFetching: boolean;\r\n\tisFetchingMore: boolean;\r\n\tapiFetchedPages: number[];\r\n\tsearchTerm: string;\r\n}\r\n\r\nconst INITIAL_STATE: MoviesBrowseState = {\r\n\tsearchData: null,\r\n\tsearchError: null,\r\n\tisFetching: false,\r\n\tisFetchingMore: false,\r\n\tapiFetchedPages: [],\r\n\tsearchTerm: ''\r\n};\r\n\r\nfunction makeMoviesBrowserReducer(name: MoviesBrowseNames): Reducer<MoviesBrowseState, ISearchActions> {\r\n\treturn function(state = INITIAL_STATE, action) {\r\n\r\n\t\tif (action.name !== name) return state;\r\n\r\n\t\tswitch (action.type) {\r\n\t\t\tcase MoviesBrowserActionTypes.UNSHIFT_TO_LIST_ITEMS:\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tsearchData: state.searchData && {\r\n\t\t\t\t\t\t...state.searchData,\r\n\t\t\t\t\t\tresults: unshiftToObj({...state.searchData.results}, action.payload),\r\n\t\t\t\t\t\ttotal_pages: Math.ceil((state.searchData.total_results+1)/20),\r\n\t\t\t\t\t\ttotal_results: state.searchData.total_results+1\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\tcase MoviesBrowserActionTypes.REMOVE_FROM_LIST_ITEMS:\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tsearchData: state.searchData && {\r\n\t\t\t\t\t\t...state.searchData,\r\n\t\t\t\t\t\tresults: removeFromObjById({...state.searchData.results}, action.payload),\r\n\t\t\t\t\t\ttotal_pages: Math.ceil((state.searchData.total_results-1)/20),\r\n\t\t\t\t\t\ttotal_results: state.searchData.total_results-1\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\tcase MoviesBrowserActionTypes.CLEAR_FETCHED_MOVIES:\r\n\t\t\t\treturn INITIAL_STATE;\r\n\t\t\tcase MoviesBrowserActionTypes.FETCH_MOVIES_START:\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...INITIAL_STATE,\r\n\t\t\t\t\tisFetching: true,\r\n\t\t\t\t};\r\n\t\t\tcase MoviesBrowserActionTypes.FETCH_MOVIES_SUCCESS:\r\n\t\t\t\tlet {data: fetchedData} = action.payload;\r\n\r\n\t\t\t\tif (!fetchedData.total_results)\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...INITIAL_STATE,\r\n\t\t\t\t\t\tsearchError: {\r\n\t\t\t\t\t\t\terrors: [\"No results found.\"]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...INITIAL_STATE,\r\n\t\t\t\t\tsearchData: fetchedData,\r\n\t\t\t\t\tapiFetchedPages: [1],\r\n\t\t\t\t\tsearchTerm: action.payload.searchTerm || ''\r\n\t\t\t\t};\r\n\t\t\tcase MoviesBrowserActionTypes.FETCH_MOVIES_FAILURE:\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...INITIAL_STATE,\r\n\t\t\t\t\tsearchError: action.payload\r\n\t\t\t\t};\r\n\r\n\t\t\tcase MoviesBrowserActionTypes.FETCH_MORE_MOVIES_START:\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tisFetchingMore: true\r\n\t\t\t\t};\r\n\t\t\tcase MoviesBrowserActionTypes.FETCH_MORE_MOVIES_SUCCESS:\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tsearchData: {\r\n\t\t\t\t\t\t...state.searchData!,\r\n\t\t\t\t\t\tresults: {\r\n\t\t\t\t\t\t\t...state.searchData!.results,\r\n\t\t\t\t\t\t\t...action.payload.results\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tpage: action.payload.fetchedPage\r\n\t\t\t\t\t},\r\n\t\t\t\t\tapiFetchedPages: [\r\n\t\t\t\t\t\t...new Set([...state.apiFetchedPages, action.payload.fetchedPage])\r\n\t\t\t\t\t],\r\n\t\t\t\t\tisFetchingMore: false\r\n\t\t\t\t};\r\n\t\t\tcase MoviesBrowserActionTypes.FETCH_MORE_MOVIES_FAILURE:\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tsearchError: action.payload,\r\n\t\t\t\t\tisFetchingMore: false\r\n\t\t\t\t};\r\n\t\t\tdefault:\r\n\t\t\t\treturn state;\r\n\t\t}\r\n\t};\r\n\r\n}\r\n\r\nfunction unshiftToObj(obj: ResultItemsObject, newItem: IMovieResultItem): ResultItemsObject {\r\n\r\n\tlet temp = newItem;\r\n\r\n\tfor (let key in obj) {\r\n\t\tlet tempHold = obj[key]!;\r\n\t\tobj[key] = temp;\r\n\t\ttemp = tempHold;\r\n\t}\r\n\r\n\tobj[Object.keys(obj).length] = temp;\r\n\r\n\treturn obj;\r\n}\r\n\r\nfunction removeFromObjById(obj: ResultItemsObject, id: number): ResultItemsObject {\r\n\tlet removed = false;\r\n\tfor (let key in obj) {\r\n\t\tlet numKey = Number(key)\r\n\t\tif (obj[numKey]?.id !== id && !removed) continue;\r\n\r\n\t\tif (removed) {\r\n\t\t\tobj[numKey - 1] = obj[numKey]!;\r\n\t\t} else {\r\n\t\t\tobj[numKey] = undefined;\r\n\t\t\tremoved = true;\r\n\t\t}\r\n\t}\r\n\tif (removed)\r\n\t\tdelete obj[Object.keys(obj).length-1];\r\n\treturn obj;\r\n}\r\n\r\nexport default makeMoviesBrowserReducer;\r\n","import { combineReducers } from \"redux\";\r\nimport movieViewReducer from \"./movie-view/movie-view.reducer\";\r\nimport userReducer from \"./user/user.reducer\";\r\nimport makeMoviesBrowserReducer from \"./movies-browser/movies-browser.reducer\";\r\n\r\nconst rootReducer = combineReducers({\r\n  \"trendingWeek\"   : makeMoviesBrowserReducer(\"trendingWeek\"),\r\n  \"nowPlaying\"     : makeMoviesBrowserReducer(\"nowPlaying\"),\r\n  \"watchlist\"      : makeMoviesBrowserReducer(\"watchlist\"),\r\n  \"favorite\"       : makeMoviesBrowserReducer(\"favorite\"),\r\n  \"search\"         : makeMoviesBrowserReducer(\"search\"),\r\n  \"user\"           : userReducer,\r\n  \"movieItem\"      : movieViewReducer,\r\n});\r\n\r\nexport default rootReducer;\r\n","import rootReducer from \"./root-reducer\";\r\nimport { configureStore } from \"@reduxjs/toolkit\";\r\n\r\nconst store = configureStore({\r\n    reducer: rootReducer\r\n})\r\n\r\n\r\n// @ts-ignore\r\nif (process.env.NODE_ENV === 'development' && module.hot) {\r\n    // @ts-ignore\r\n    module.hot.accept(\"./root-reducer\", () => {\r\n        const newRootReducer = require(\"./root-reducer\").default\r\n        store.replaceReducer(newRootReducer)\r\n    })\r\n}\r\n\r\nexport default store;","import { ISearchActions } from \"./movies-browser\";\r\nimport { IMovieViewActions } from \"./movie-view\";\r\nimport { ThunkAction } from \"redux-thunk\";\r\nimport { Action, AnyAction } from \"redux\";\r\nimport rootReducer from \"./root-reducer\";\r\nimport store from \"./store\";\r\n\r\nexport type AppActions =\r\n\t| ISearchActions\r\n\t| IMovieViewActions\r\n\r\nexport { default as store } from './store'\r\n\r\nexport type AppState = ReturnType<typeof rootReducer>\r\n\r\nexport default store;\r\n\r\nexport type AppThunk<A extends Action = AnyAction> = ThunkAction<void, AppState, null, A>","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"home-page_root__2-E_q\",\"content\":\"home-page_content__2DYa5\",\"sectionSpotlight\":\"home-page_sectionSpotlight__234NV\",\"sectionTitle\":\"home-page_sectionTitle__ND_aN\",\"sectionContentWrapper\":\"home-page_sectionContentWrapper__1qtbg\",\"sectionContent\":\"home-page_sectionContent__3oypc\",\"gridContainer\":\"home-page_gridContainer__3QeH7\",\"gridItem\":\"home-page_gridItem__Q70rq\",\"nowPlayingContainer\":\"home-page_nowPlayingContainer__3GXQT\",\"mainMovieItem\":\"home-page_mainMovieItem__2yXC8\",\"subMovieItemContainerWrapper\":\"home-page_subMovieItemContainerWrapper__3Twb0\",\"subMovieItemContainer\":\"home-page_subMovieItemContainer__4tiGn\",\"subMovieItemContainerItem\":\"home-page_subMovieItemContainerItem__2zsRL\",\"hoveredBox\":\"home-page_hoveredBox__bpY7K\",\"hoveredBg\":\"home-page_hoveredBg__2OVsD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"movie-view-actions_root__1keFE\",\"iconWrapper\":\"movie-view-actions_iconWrapper__373Yc\",\"rotateLoading\":\"movie-view-actions_rotateLoading__1IIst\",\"icon\":\"movie-view-actions_icon__3FBHQ\",\"ratingModalContainer\":\"movie-view-actions_ratingModalContainer__qWecy\",\"ratingModal\":\"movie-view-actions_ratingModal__1pStS\",\"removeButton\":\"movie-view-actions_removeButton__3q4JD\",\"showAuth\":\"movie-view-actions_showAuth__1NDq0\",\"xButton\":\"movie-view-actions_xButton__3q70E\",\"toolTip\":\"movie-view-actions_toolTip__23lw6\",\"mobileSubmit\":\"movie-view-actions_mobileSubmit__1N0Va\"};","import IMoviesSearchData, { ResultItemsObject } from \"../../interfaces/app-types/IMoviesSearchData\";\r\nimport IMoviesSearchError from \"../../interfaces/app-types/IMoviesSearchError\";\r\nimport { AccountItemsNames, ISearchActions, MoviesBrowseNames } from \"./\";\r\nimport { ThunkAction } from \"redux-thunk\";\r\nimport { AppState, AppThunk } from \"store\";\r\nimport IMoviesResponseData from \"../../interfaces/app-types/IMoviesResponseData\";\r\nimport { calculatePageOnApi, convertResultsData, getSearchParam, goFetchPostersOnWorker } from \"utility\";\r\nimport appProperties from \"../../appProperties\";\r\nimport IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\n\r\nconst {buildFetchMovieSearchUrl, itemsPerPageUI, getItemsBrowseUrl} = appProperties;\r\n\r\nexport enum MoviesBrowserActionTypes {\r\n    FETCH_MOVIES_START = \"FETCH_MOVIES_START\",\r\n    FETCH_MOVIES_SUCCESS = \"FETCH_MOVIES_SUCCESS\",\r\n    FETCH_MOVIES_FAILURE = \"FETCH_MOVIES_FAILURE\",\r\n    FETCH_MORE_MOVIES_START = \"FETCH_MORE_MOVIES_START\",\r\n    FETCH_MORE_MOVIES_SUCCESS = \"FETCH_MORE_MOVIES_SUCCESS\",\r\n    FETCH_MORE_MOVIES_FAILURE = \"FETCH_MORE_MOVIES_FAILURE\",\r\n    CLEAR_FETCHED_MOVIES = \"CLEAR_FETCHED_MOVIES\",\r\n    UNSHIFT_TO_LIST_ITEMS = \"UNSHIFT_TO_LIST_ITEMS\", // these last two are for updating \"favorite\" and \"watchlist\"\r\n    REMOVE_FROM_LIST_ITEMS = \"REMOVE_FROM_LIST_ITEMS\"\r\n}\r\n\r\n/**\r\n * @param name Values: \"watchlist\" & \"favorite\" need authentication\r\n * */\r\nexport default function getMoviesBrowserActions<T extends MoviesBrowseNames>(name: T) {\r\n\r\n    let unshiftToFavorites: ((item: IMovieResultItem) => ISearchActions)|undefined = undefined;\r\n    let removeFromListItems: ((id: number) => ISearchActions)|undefined = undefined;\r\n\r\n    if (name === \"favorite\" || name === \"watchlist\") {\r\n        unshiftToFavorites = (item: IMovieResultItem): ISearchActions => ({\r\n            type: MoviesBrowserActionTypes.UNSHIFT_TO_LIST_ITEMS,\r\n            payload: item,\r\n            name: name as AccountItemsNames\r\n        });\r\n\r\n        removeFromListItems = (id: number): ISearchActions => ({\r\n            type: MoviesBrowserActionTypes.REMOVE_FROM_LIST_ITEMS,\r\n            payload: id,\r\n            name: name as AccountItemsNames\r\n        });\r\n    }\r\n\r\n    const browseActions = {\r\n        clearFetchedMovies: (): ISearchActions => ({\r\n            type: MoviesBrowserActionTypes.CLEAR_FETCHED_MOVIES,\r\n            name\r\n        }),\r\n\r\n        fetchMoviesStart: (): ISearchActions => ({\r\n            type: MoviesBrowserActionTypes.FETCH_MOVIES_START,\r\n            name\r\n        }),\r\n\r\n        fetchMoviesSuccess: (data: IMoviesSearchData, searchTerm: string): ISearchActions => ({\r\n            type: MoviesBrowserActionTypes.FETCH_MOVIES_SUCCESS,\r\n            payload: {data, searchTerm},\r\n            name\r\n        }),\r\n\r\n        fetchMoviesFailure: (error: IMoviesSearchError): ISearchActions => ({\r\n            type: MoviesBrowserActionTypes.FETCH_MOVIES_FAILURE,\r\n            payload: error,\r\n            name\r\n        }),\r\n\r\n        fetchMoviesAsync(searchTerm: string = '', pageApi: number = 1): AppThunk<ISearchActions> {\r\n            return async dispatch => {\r\n                if (name === \"search\" && !searchTerm) return;\r\n                // Start\r\n                dispatch(this.fetchMoviesStart());\r\n                try {\r\n                    let res = await fetch(getItemsBrowseUrl(name, searchTerm, pageApi));\r\n                    if (!res.ok) {\r\n                        let error: IMoviesSearchError = await res.json();\r\n                        dispatch(this.fetchMoviesFailure(error)); // Failure\r\n                    } else {\r\n                        let data: IMoviesResponseData = await res.json();\r\n\r\n                        goFetchPostersOnWorker(data.results);\r\n\r\n                        let transformedData: IMoviesSearchData = {\r\n                            ...data,\r\n                            results: convertResultsData(data.results, pageApi)\r\n                        };\r\n\r\n                        dispatch(this.fetchMoviesSuccess(transformedData, searchTerm)); // Success\r\n                    }\r\n                } catch (error) {\r\n                    dispatch(\r\n                        this.fetchMoviesFailure({\r\n                            errors: [\"Internal server error.\"] // Failure\r\n                        })\r\n                    );\r\n                }\r\n            };\r\n        },\r\n\r\n        fetchMoreMoviesStart: (): ISearchActions => ({\r\n            type: MoviesBrowserActionTypes.FETCH_MORE_MOVIES_START,\r\n            name\r\n        }),\r\n\r\n        fetchMoreMoviesSuccess: (results: ResultItemsObject, fetchedPage: number): ISearchActions => ({\r\n            type: MoviesBrowserActionTypes.FETCH_MORE_MOVIES_SUCCESS,\r\n            payload: {results, fetchedPage},\r\n            name\r\n        }),\r\n\r\n        fetchMoreMoviesFailure: (error: IMoviesSearchError): ISearchActions => ({\r\n            type: MoviesBrowserActionTypes.FETCH_MORE_MOVIES_FAILURE,\r\n            payload: error,\r\n            name\r\n        }),\r\n\r\n        fetchMoreMoviesAsync(nextPageOnApi: number, ...otherPagesOnApi: number[]):\r\n            ThunkAction<void, AppState, null, ISearchActions> {\r\n            return async (dispatch, getState) => {\r\n                let searchTerm = getSearchParam(\"s\") || '';\r\n                // Start\r\n                dispatch(this.fetchMoreMoviesStart());\r\n                try {\r\n                    let res = await fetch(getItemsBrowseUrl(name, searchTerm, nextPageOnApi));\r\n                    if (!res.ok) {\r\n                        let error: IMoviesSearchError = await res.json();\r\n                        dispatch(this.fetchMoreMoviesFailure(error)); // Failure\r\n                    } else {\r\n                        let data: IMoviesResponseData = await res.json();\r\n\r\n                        goFetchPostersOnWorker(data.results);\r\n\r\n                        let resultsObject = convertResultsData(data.results, nextPageOnApi);\r\n\r\n                        dispatch(this.fetchMoreMoviesSuccess(resultsObject, nextPageOnApi)) // Success\r\n                    }\r\n                } catch (error) {\r\n                    dispatch(\r\n                        this.fetchMoreMoviesFailure({\r\n                            errors: [\"Internal server error.\"] // Failure\r\n                        })\r\n                    );\r\n                } finally {\r\n                    if (otherPagesOnApi.length) {\r\n                        // @ts-ignore\r\n                        dispatch(this.fetchMoreMoviesAsync(...otherPagesOnApi))\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        checkIfFetchMore(pageUI: number): AppThunk<ISearchActions> {\r\n            return async (dispatch, getState) => {\r\n                if (!pageUI || name === \"trendingWeek\") return;\r\n                const { apiFetchedPages, searchData, isFetchingMore } = getState()[name];\r\n\r\n                if (isFetchingMore) return;\r\n\r\n                const pageOnApi = calculatePageOnApi(pageUI);\r\n                const nextUIPageOnApi = calculatePageOnApi(pageUI, \"next\")\r\n                const total_pages = searchData?.total_pages || 0;\r\n\r\n                const isFetchPage = (pageOnApi: number) =>\r\n                    pageOnApi>0 && pageOnApi<=total_pages && !apiFetchedPages.includes(pageOnApi);\r\n\r\n                const pagesToFetch: number[] = [];\r\n\r\n                isFetchPage(nextUIPageOnApi)   && pagesToFetch.push(nextUIPageOnApi);\r\n                isFetchPage(pageOnApi)         && pagesToFetch.push(pageOnApi);\r\n                isFetchPage(pageOnApi-1)       && pagesToFetch.push(pageOnApi-1);\r\n                isFetchPage(pageOnApi-2)       && pagesToFetch.push(pageOnApi-2);\r\n\r\n                if (pagesToFetch.length) {\r\n                    // @ts-ignore\r\n                    dispatch(this.fetchMoreMoviesAsync(...pagesToFetch));\r\n                }\r\n            }\r\n        },\r\n        unshiftToFavorites: (unshiftToFavorites as T extends AccountItemsNames ? NonNullable<typeof unshiftToFavorites> : undefined),\r\n        removeFromListItems: (removeFromListItems as T extends AccountItemsNames ? NonNullable<typeof removeFromListItems> : undefined),\r\n\r\n    }\r\n\r\n    return browseActions as T extends AccountItemsNames ? typeof browseActions : Omit<typeof browseActions, \"unshiftToFavorites\" | \"removeFromListItems\">\r\n}\r\n","import IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\nimport { IMovieViewActions } from \"./\";\r\n\r\nexport enum MovieViewActionsTypes {\r\n\tSET_MOVIE_VIEW = 'SET_MOVIE_VIEW',\r\n\tCLEAR_MOVIE_VIEW = 'CLEAR_MOVIE_VIEW'\r\n}\r\n\r\nexport const setMovieView = (item: IMovieResultItem): IMovieViewActions => ({\r\n\ttype: MovieViewActionsTypes.SET_MOVIE_VIEW,\r\n\tpayload: item\r\n});\r\n\r\nexport const clearMovieView = (): IMovieViewActions => ({\r\n\ttype: MovieViewActionsTypes.CLEAR_MOVIE_VIEW,\r\n});","// no easing, no acceleration\r\nexport const linear = function(t) {\r\n  return t;\r\n};\r\n// accelerating from zero velocity\r\nexport const easeInQuad = function(t) {\r\n  return t * t;\r\n};\r\n// decelerating to zero velocity\r\nexport const easeOutQuad = function(t) {\r\n  return t * (2 - t);\r\n};\r\n// acceleration until halfway, then deceleration\r\nexport const easeInOutQuad = function(t) {\r\n  return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n};\r\n// accelerating from zero velocity\r\nexport const easeInCubic = function(t) {\r\n  return t * t * t;\r\n};\r\n// decelerating to zero velocity\r\nexport const easeOutCubic = function(t) {\r\n  return --t * t * t + 1;\r\n};\r\n// acceleration until halfway, then deceleration\r\nexport const easeInOutCubic = function(t) {\r\n  return t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n};\r\n// accelerating from zero velocity\r\nexport const easeInQuart = function(t) {\r\n  return t * t * t * t;\r\n};\r\n// decelerating to zero velocity\r\nexport const easeOutQuart = function(t) {\r\n  return 1 - --t * t * t * t;\r\n};\r\n// acceleration until halfway, then deceleration\r\nexport const easeInOutQuart = function(t) {\r\n  return t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\r\n};\r\n// accelerating from zero velocity\r\nexport const easeInQuint = function(t) {\r\n  return t * t * t * t * t;\r\n};\r\n// decelerating to zero velocity\r\nexport const easeOutQuint = function(t) {\r\n  return 1 + --t * t * t * t * t;\r\n};\r\n// acceleration until halfway, then deceleration\r\nexport const easeInOutQuint = function(t) {\r\n  return t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\r\n};\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"app-bar_root__ZaWLU\",\"logo\":\"app-bar_logo__gW0P4\",\"toolBar\":\"app-bar_toolBar__3tX9V\",\"navItem\":\"app-bar_navItem__EZmlQ\",\"navItemIcon\":\"app-bar_navItemIcon__3IKWo\",\"avatar\":\"app-bar_avatar__1X2-X\",\"navItemTxt\":\"app-bar_navItemTxt__huMFw\",\"isOpen\":\"app-bar_isOpen__35lBP\",\"onNavHover\":\"app-bar_onNavHover__K89v7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"runAnimation\":\"movie-result-item_runAnimation__X9hb_\",\"onViewRest\":\"movie-result-item_onViewRest__1-46_\",\"root\":\"movie-result-item_root__1UwRT\",\"content\":\"movie-result-item_content__1TfaJ\",\"wrapper\":\"movie-result-item_wrapper__3XDt2\",\"header\":\"movie-result-item_header__1Vzu4\",\"title\":\"movie-result-item_title__39tTB\",\"year\":\"movie-result-item_year__1Mho9\",\"overViewSection\":\"movie-result-item_overViewSection__38QXw\",\"info\":\"movie-result-item_info__3nKmA\",\"loadingPulse\":\"movie-result-item_loadingPulse__1B3cH\",\"opacityPulse\":\"movie-result-item_opacityPulse__2XXIc\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"movie-result-skeleton_root__3qHsq\",\"imageWrapper\":\"movie-result-skeleton_imageWrapper__33o31\",\"opacityPulse\":\"movie-result-skeleton_opacityPulse__1Z9f0\",\"image\":\"movie-result-skeleton_image__2mssJ\",\"content\":\"movie-result-skeleton_content__2DMMu\",\"wrapper\":\"movie-result-skeleton_wrapper__21vpy\",\"header\":\"movie-result-skeleton_header__2B94f\",\"title\":\"movie-result-skeleton_title__2zcIy\",\"year\":\"movie-result-skeleton_year__2u-ar\",\"info\":\"movie-result-skeleton_info__2zErA\",\"infoWrapper\":\"movie-result-skeleton_infoWrapper__L_6pL\",\"circle\":\"movie-result-skeleton_circle__1qM-d\",\"loadingPulse\":\"movie-result-skeleton_loadingPulse__2GBI2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"movie-view-info_root__29ehZ\",\"title\":\"movie-view-info_title__2UGWO\",\"sideInfoItem\":\"movie-view-info_sideInfoItem__-MyRA\"};","import { UserActions, UserState } from \"./index\";\r\n\r\nexport enum UserActionsTypes {\r\n\tSET_USER = \"SET_USER\",\r\n\tCLEAR_USER = \"CLEAR_USER\"\r\n}\r\n\r\n\r\nexport const setUser = (user: UserState): UserActions => ({\r\n\ttype: UserActionsTypes.SET_USER,\r\n\tpayload: user\r\n});\r\n\r\nexport const clearUser = (): UserActions => ({\r\n\ttype: UserActionsTypes.CLEAR_USER\r\n});","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"items-scroll-x_root__3c9UL\",\"noMoviesFound\":\"items-scroll-x_noMoviesFound__2-fDP\",\"relatedMovieItemWrapper\":\"items-scroll-x_relatedMovieItemWrapper__EHdJ7\",\"relatedMovieItem\":\"items-scroll-x_relatedMovieItem__3fqg8\",\"noPoster\":\"items-scroll-x_noPoster__2sOrv\",\"isLoadingItem\":\"items-scroll-x_isLoadingItem__1RwSn\",\"loadingPulse\":\"items-scroll-x_loadingPulse__2-Z61\",\"opacityPulse\":\"items-scroll-x_opacityPulse__2aTxh\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"movie-view-item_root__29mJy\",\"mainInfo\":\"movie-view-item_mainInfo__3aRXn\",\"movieItem\":\"movie-view-item_movieItem__cnJAR\",\"sideInfo\":\"movie-view-item_sideInfo__2gth1\",\"mobileOverview\":\"movie-view-item_mobileOverview__PuMxJ\",\"mobileRateActions\":\"movie-view-item_mobileRateActions__gs6h4\",\"loadingPulse\":\"movie-view-item_loadingPulse__2TSh7\",\"opacityPulse\":\"movie-view-item_opacityPulse__3OJ1H\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"list-item_root__3K_Eq\",\"image\":\"list-item_image__8W0Zw\",\"info\":\"list-item_info__3wCV1\",\"movieTitle\":\"list-item_movieTitle__3zky-\",\"itemActions\":\"list-item_itemActions__AfTc2\",\"actionButtons\":\"list-item_actionButtons__5ncys\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"search-bar_root__3CzrZ\",\"bar\":\"search-bar_bar__2gGAM\",\"suggestionsDropdown\":\"search-bar_suggestionsDropdown__2UdGS\",\"loadingPulse\":\"search-bar_loadingPulse__TFS67\",\"opacityPulse\":\"search-bar_opacityPulse__1lUZ8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"auth-page_root__Ocxm3\",\"userField\":\"auth-page_userField__2Rh--\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"movie-item-image_root__1JXgj\",\"image\":\"movie-item-image_image__X04m2\",\"imageIcon\":\"movie-item-image_imageIcon__31gPF\",\"loadingPulse\":\"movie-item-image_loadingPulse__hFBnd\",\"opacityPulse\":\"movie-item-image_opacityPulse__3iP0F\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"items-list_root__1f0lq\",\"head\":\"items-list_head__1zGqy\",\"title\":\"items-list_title__2oh11\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"App_root__27yrb\",\"main\":\"App_main__1a1JF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"loading-spinner_root__11EEJ\",\"darken\":\"loading-spinner_darken__A_g8a\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"error-message_root__1fZb_\",\"title\":\"error-message_title__2fMjM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"search-page_root__2Nc1S\",\"searchHead\":\"search-page_searchHead__1M6GA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"circled-progress-bar_root__2mkbI\",\"scoreValue\":\"circled-progress-bar_scoreValue__1k3e4\",\"loadingPulse\":\"circled-progress-bar_loadingPulse__FHvDD\",\"opacityPulse\":\"circled-progress-bar_opacityPulse__3VR5b\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"movie-view-screen_root__2Ig-W\",\"transitionDiv\":\"movie-view-screen_transitionDiv__3fEVy\"};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"61e5ac1b1711edde28bd.worker.js\");\n};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bob\":\"pagination-controls_bob__1kgUG\",\"root\":\"pagination-controls_root__17AgS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"movie-results-container_root__2rRnr\",\"grid\":\"movie-results-container_grid__t-GlL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"total-search-results_root__302j4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"movie-item-img-bg_root__N-Q75\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"movies-grid_root__Bm5D1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"movie-view-background_root__2pCqN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"movie-view-related_root__1_IrX\",\"loadingPulse\":\"movie-view-related_loadingPulse__1CnAp\",\"opacityPulse\":\"movie-view-related_opacityPulse__fpUUx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"api-logo_root__2WUSY\"};","import { useLayoutEffect, useState } from \"react\";\r\nimport { getHashPath } from \"utility\";\r\n\r\n\r\nfunction useLocationPath() {\r\n\tconst [path, setPath] = useState('/');\r\n\r\n\tuseLayoutEffect(() => {\r\n\t\tsetPath(getHashPath())\r\n\t\tconst listener = ({oldURL, newURL}: HashChangeEvent) => {\r\n\t\t\tconst oldPath = getHashPath(oldURL), newPath = getHashPath(newURL);\r\n\t\t\tif (oldPath !== newPath)\r\n\t\t\t\tsetPath(newPath);\r\n\t\t};\r\n\t\twindow.addEventListener(\"hashchange\", listener)\r\n\t\treturn () => window.removeEventListener(\"hashchange\", listener);\r\n\t}, []);\r\n\r\n\treturn path;\r\n}\r\n\r\nexport default useLocationPath;","import store, { AppState } from \"store\";\r\nimport { UserState } from \"store/user\";\r\nimport { useSelector } from \"react-redux\";\r\nimport appProperties from \"../appProperties\";\r\nimport { clearUser } from \"store/user/user.actions\";\r\n\r\nconst {getLogoutConfig, buildLoginRedirectUrl} = appProperties;\r\n\r\n\r\nconst selectUser = (state: AppState) => state.user;\r\n\r\nconst equalUser = (left: UserState|null, right: UserState|null) => left?.id === right?.id;\r\n\r\nfunction useAuth(): AuthHook {\r\n\r\n\tconst user = useSelector<AppState, UserState | null>(selectUser, equalUser);\r\n\r\n\treturn {\r\n\t\tuser,\r\n\t\tisAuth: !!user,\r\n\t\tsignOut: logOut,\r\n\t\tsignIn: logIn\r\n\t}\r\n}\r\n\r\nfunction logOut() {\r\n\tconst session_id = localStorage.getItem(\"session_id\");\r\n\tif (!session_id) return;\r\n\r\n\tfetch(...getLogoutConfig(session_id))\r\n\t\t.then(res => res.json())\r\n\t\t.then(data => {\r\n\t\t\tif (data.success) {\r\n\t\t\t\tconsole.log(\"logout success\");\r\n\t\t\t\talert(\"Successfully logged out.\")\r\n\t\t\t\tstore.dispatch(clearUser());\r\n\t\t\t\tlocalStorage.removeItem(\"session_id\");\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(console.log)\r\n}\r\n\r\nfunction logIn(requestToken: string) {\r\n\twindow.open(buildLoginRedirectUrl(requestToken), \"_blank\");\r\n}\r\n\r\ninterface AuthHook {\r\n\tuser: UserState | null,\r\n\tisAuth: boolean,\r\n\tsignOut: () => void,\r\n\tsignIn: (requestToken: string) => void,\r\n}\r\n\r\nexport default useAuth;","import { checkIsMobile } from \"utility\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\n\r\nfunction useIsMobile() {\r\n\r\n\tconst [isMobile, setIsMobile] = useState(() => checkIsMobile());\r\n\r\n\tuseEffect(() => {\r\n\t\tconst onresize = () => {\r\n\t\t\tsetIsMobile(checkIsMobile())\r\n\t\t};\r\n\t\twindow.addEventListener(\"resize\", onresize);\r\n\t\treturn () => window.removeEventListener(\"resize\", onresize);\r\n\t}, []);\r\n\r\n\treturn isMobile;\r\n}\r\n\r\nexport default useIsMobile;","import React, { Dispatch, FC, SetStateAction, useEffect, useState } from \"react\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport DoubleArrowIcon from \"@material-ui/icons/DoubleArrow\";\r\nimport HomeIcon from \"@material-ui/icons/Home\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\r\nimport BookmarkIcon from \"@material-ui/icons/Bookmark\";\r\nimport AccountCircleIcon from \"@material-ui/icons/AccountCircle\";\r\nimport styles from \"./app-bar.module.scss\";\r\n// import styles from \"./app-bar.module.scss\";\r\nimport { Link } from \"react-router-dom\";\r\nimport useLocationPath from \"hooks/useLocationPath\";\r\nimport useAuth from \"hooks/useAuth\";\r\nimport useIsMobile from \"hooks/useIsMobile\";\r\nimport { OverridableComponent } from \"@material-ui/core/OverridableComponent\";\r\nimport { SvgIconTypeMap } from \"@material-ui/core\";\r\nimport store from \"../../store\";\r\nimport getMoviesBrowserActions from \"../../store/movies-browser/movies-browser.actions\";\r\nimport { scrollToTop } from \"../../utility\";\r\n\r\nconst searchActions = getMoviesBrowserActions(\"search\");\r\n\r\nconst navItems = [\r\n\t{\r\n\t\ticon: HomeIcon,\r\n\t\ttext: \"Home\",\r\n\t\tto: \"/\"\r\n\t},\r\n\t{\r\n\t\ticon: SearchIcon,\r\n\t\ttext: \"Search\",\r\n\t\tto: \"/search\"\r\n\t},\r\n\t{\r\n\t\ticon: FavoriteIcon,\r\n\t\ttext: \"Favorites\",\r\n\t\tto: \"/favorites\"\r\n\t},\r\n\t{\r\n\t\ticon: BookmarkIcon,\r\n\t\ttext: \"Watchlist\",\r\n\t\tto: \"/watchlist\"\r\n\t},\r\n] as const;\r\n\r\n\r\ntype NavPaths = (typeof navItems[number])[\"to\"] | \"/account\"\r\n\r\ninterface INavItem {\r\n\ticon:  OverridableComponent<SvgIconTypeMap>\r\n\ttext: string,\r\n\tto: NavPaths\r\n}\r\n\r\nconst AppBar = () => {\r\n\tconst isMobile = useIsMobile();\r\n\tconst [isOpen, setOpen] = useState(false);\r\n\tconst pathname = useLocationPath();\r\n\r\n\tuseEffect(() => {\r\n\t\tisMobile && scrollToTop();\r\n\t}, [isMobile, pathname]);\r\n\r\n\tconst { user } = useAuth();\r\n\r\n\treturn (\r\n\t\t<nav className={`${styles.root} ${isOpen ? styles.isOpen : ''}`}\r\n\t\t     onMouseEnter={() => setOpen(true)} onMouseLeave={() => setOpen(false)}>\r\n\t\t\t<ul className={styles.toolBar}>\r\n\t\t\t\t<li className={styles.navItem}>\r\n\t\t\t\t\t<span className={`${styles.navItemTxt} ${styles.logo}`}>MovieApp</span>\r\n\t\t\t\t\t<IconButton color=\"inherit\" aria-label=\"menu\" className={styles.navItemIcon}>\r\n\t\t\t\t\t\t<DoubleArrowIcon/>\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</li>\r\n\t\t\t\t{navItems.map((item, i) =>\r\n\t\t\t\t\t<NavItem key={i} {...item} setOpen={setOpen} active={item.to === pathname}/>\r\n\t\t\t\t)}\r\n\t\t\t\t<NavItem\r\n\t\t\t\t\tactive={\"/account\" === pathname}\r\n\t\t\t\t\tsetOpen={setOpen} to=\"/account\"\r\n\t\t\t\t\ticon={AccountCircleIcon} text={user?.username || \"Login\"}\r\n\t\t\t\t\tusername={user?.username}\r\n\t\t\t\t/>\r\n\t\t\t</ul>\r\n\t\t</nav>\r\n\t);\r\n};\r\n\r\ninterface INavItemProps {\r\n\tactive: boolean,\r\n\tsetOpen: Dispatch<SetStateAction<boolean>>,\r\n\tusername?: string\r\n}\r\n\r\ntype NavItemProps = INavItemProps & INavItem;\r\n\r\nconst NavItem: FC<NavItemProps> = ({icon: Icon, text, to, setOpen, active, username}) => {\r\n\r\n\tconst isMobile = useIsMobile();\r\n\r\n\tfunction handleClick(e: React.MouseEvent<HTMLAnchorElement>) {\r\n\t\tif (e.currentTarget === e.target)\r\n\t\t\treturn e.preventDefault();\r\n\t\t!isMobile && setOpen(false);\r\n\r\n\t\tif (to === \"/search\" && active)\r\n\t\t\tstore.dispatch(searchActions.clearFetchedMovies())\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Link to={to} className={styles.navItem} onClick={handleClick} aria-current={active}>\r\n\t\t\t<IconButton color=\"inherit\" aria-label=\"menu\" className={styles.navItemIcon}>\r\n\t\t\t\t{username ?\r\n\t\t\t\t\t<div className={styles.avatar} >{username.charAt(0).toUpperCase()}</div>\r\n\t\t\t\t\t: <Icon/>\r\n\t\t\t\t}\r\n\t\t\t</IconButton>\r\n\t\t\t{text && <span className={styles.navItemTxt}>{text}</span>}\r\n\t\t</Link>\r\n\t);\r\n};\r\n\r\nexport default AppBar;\r\n","import AppBar from \"./app-bar.component\";\r\n\r\nexport default AppBar;","import { MutableRefObject, useEffect, useRef } from \"react\";\r\n\r\nfunction usePrevious<T>(value: T): T | undefined {\r\n  const ref: MutableRefObject<T | undefined> = useRef();\r\n  useEffect(() => {\r\n    ref.current = value;\r\n  }, [value]);\r\n  return ref.current;\r\n}\r\n\r\nexport default usePrevious;\r\n","import SearchParamsMap from \"../interfaces/app-types/SearchParamsMap\";\r\nimport { useCallback, useEffect, useLayoutEffect, useRef, useState } from \"react\";\r\nimport usePrevious from \"./usePrevious\";\r\nimport { fixParamValue, getHashPath, getHashQuery } from \"utility\";\r\n\r\ntype useSearchParamUpdate<Param extends keyof SearchParamsMap, Extra extends keyof SearchParamsMap = keyof SearchParamsMap> =\r\n\t(\r\n\t\tvalue: SearchParamsMap[Param] | null | ((currentValue: SearchParamsMap[Param] | null) => SearchParamsMap[Param] | null),\r\n\t    extraParam?: [Extra, SearchParamsMap[Extra] | null]\r\n\t) => void\r\n\r\ntype useSearchParamReturnType<Param extends keyof SearchParamsMap> = [SearchParamsMap[Param] | undefined, useSearchParamUpdate<Param>]\r\ntype onParamChangeType<Param extends keyof SearchParamsMap> = (newValue: SearchParamsMap[Param] | null, oldValue: SearchParamsMap[Param] | null) => any;\r\n\r\nfunction useSearchParam<Param extends keyof SearchParamsMap>\r\n(paramName: Param, onParamChange?: onParamChangeType<Param>): useSearchParamReturnType<Param> {\r\n\r\n\tconst paramNameRef = useRef(paramName);\r\n\t// URL bar's searchParam with effect to keep in sync (based on [location.movies-browser])\r\n\tconst [selectedParam, setSelectedParam] = useState(() => {\r\n\t\treturn new URLSearchParams(getHashQuery()).get(paramNameRef.current);\r\n\t});\r\n\tconst fixSelectedParam = fixParamValue<Param>(selectedParam) // convert value to correct data type\r\n\r\n\tconst selectedRef = useRef(fixSelectedParam);\r\n\r\n\tuseLayoutEffect(() => {\r\n\t\tselectedRef.current = fixSelectedParam\r\n\t}, [fixSelectedParam]);\r\n\r\n\tconst oldSelectedParam = usePrevious(fixSelectedParam) || null;\r\n\r\n\tuseEffect(() => {\r\n\t\tif (oldSelectedParam !== fixSelectedParam)\r\n\t\t\tonParamChange && onParamChange(fixSelectedParam, oldSelectedParam);\r\n\t}, [fixSelectedParam, onParamChange, oldSelectedParam]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst listener = ({oldURL, newURL}: HashChangeEvent) => {\r\n\t\t\tif (oldURL === newURL) return;\r\n\t\t\tconst oldQuery = getHashQuery(oldURL);\r\n\t\t\tconst newQuery = getHashQuery(newURL);\r\n\t\t\tconst oldParam = new URLSearchParams(oldQuery).get(paramNameRef.current);\r\n\t\t\tconst newParam = new URLSearchParams(newQuery).get(paramNameRef.current);\r\n\t\t\tif (oldParam !== newParam)\r\n\t\t\t\tsetSelectedParam(newParam);\r\n\t\t};\r\n\t\twindow.addEventListener(\"hashchange\", listener)\r\n\t\treturn () => window.removeEventListener(\"hashchange\", listener);\r\n\t}, []);\r\n\r\n\r\n\t// Update function for the selected searchParam\r\n\tconst updateParam = useCallback<useSearchParamUpdate<Param>>((value, extraParam) => {\r\n\t\tif (selectedRef.current === value && !extraParam) return;\r\n\t\tlet newSearchParams = new URLSearchParams(getHashQuery());\r\n\r\n\t\tlet newValue = (typeof value === \"function\") ?\r\n\t\t\tvalue(selectedRef.current)\r\n\t\t\t: value;\r\n\r\n\t\tif (newValue === null)\r\n\t\t\tnewSearchParams.delete(paramNameRef.current);\r\n\t\telse newSearchParams.set(paramNameRef.current, String(newValue));\r\n\r\n\t\tif (extraParam) {\r\n\t\t\tif (extraParam[1] === null)\r\n\t\t\t\tnewSearchParams.delete(extraParam[0]);\r\n\t\t\telse newSearchParams.set(extraParam[0], String(extraParam[1]));\r\n\t\t}\r\n\r\n\t\t// Update to new location (hash Browser)\r\n\t\twindow.location.hash = getHashPath() + \"?\" + newSearchParams.toString();\r\n\r\n\t}, []);\r\n\r\n\r\n\treturn [fixSelectedParam ?? undefined, updateParam];\r\n}\r\n\r\nexport default useSearchParam;\r\n","import React, { FC, RefObject, useEffect, useState } from \"react\";\r\nimport styles from \"./search-bar.module.scss\";\r\nimport appProperties from \"../../appProperties\";\r\nimport IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\n\r\nconst {buildFetchMovieSearchUrl} = appProperties;\r\n\r\ninterface OwnProps {\r\n\tkeyword: string\r\n\tonSubmit: () => void;\r\n\tinputRef: RefObject<HTMLInputElement>\r\n}\r\nconst SearchBarSuggestions: FC<OwnProps> = ({keyword,  onSubmit, inputRef}) => {\r\n\r\n\tconst [suggestions, setSuggestions] = useState<IMovieResultItem[]>([]);\r\n\tconst [selected, setSelected] = useState<number | null>(null);\r\n\tconst [visible, setVisible] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet isMount = true;\r\n\t\tsetTimeout(() => isMount && setVisible(true), 360);\r\n\t\treturn () => { isMount = false; }\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet isEffect = true;\r\n\t\tsetTimeout(() => {\r\n\t\t\tisEffect && fetch(buildFetchMovieSearchUrl(keyword))\r\n\t\t\t\t.then(res => isEffect && res.json())\r\n\t\t\t\t.then(data => {\r\n\t\t\t\t\tif (!isEffect) return;\r\n\t\t\t\t\tsetSuggestions(data.results.slice(0, 12) ?? []);\r\n\t\t\t\t\tsetSelected(null);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(console.log)\r\n\t\t}, 300);\r\n\t\treturn () => {\r\n\t\t\tisEffect = false;\r\n\t\t}\r\n\t}, [keyword]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst listener = (ev: KeyboardEvent) => {\r\n\t\t\tif (!suggestions.length) return;\r\n\t\t\tswitch (ev.code) {\r\n\t\t\t\tcase \"ArrowUp\":\r\n\t\t\t\t\treturn setSelected(selected => {\r\n\t\t\t\t\t\t\tlet newSelected =\r\n\t\t\t\t\t\t\t\tselected ? Math.abs(--selected % suggestions.length) : suggestions.length - 1;\r\n\t\t\t\t\t\t\tinputRef.current!.value = suggestions[newSelected].title;\r\n\t\t\t\t\t\t\treturn newSelected;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\tcase \"ArrowDown\":\r\n\t\t\t\t\treturn setSelected(selected => {\r\n\t\t\t\t\t\t\tlet newSelected =\r\n\t\t\t\t\t\t\t\tselected !== null ? Math.abs(++selected % suggestions.length) : 0;\r\n\t\t\t\t\t\t\tinputRef.current!.value = suggestions[newSelected].title;\r\n\t\t\t\t\t\t\treturn newSelected;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\tdefault: break;\r\n\t\t\t}\r\n\t\t};\r\n\t\twindow.addEventListener(\"keydown\", listener);\r\n\t\treturn () => window.removeEventListener(\"keydown\", listener);\r\n\t}, [inputRef, suggestions]);\r\n\r\n\r\n\tconst handleClickSubmit = (title: string) => {\r\n\t\tinputRef.current!.value = title;\r\n\t\tonSubmit()\r\n\t};\r\n\r\n\r\n    return visible && suggestions.length ? (\r\n        <ul className={styles.suggestionsDropdown}\r\n            onMouseLeave={() => setSelected(null)}\r\n        >\r\n\t        {suggestions.map(({id, title}, index) => (\r\n\t\t        // eslint-disable-next-line jsx-a11y/role-supports-aria-props\r\n\t        \t<li key={id} aria-selected={(index === selected)}\r\n\t\t            onMouseEnter={() => setSelected(index)}\r\n\t\t            onClick={handleClickSubmit.bind(null, title)}\r\n\t\t        >{title}</li>\r\n\t        ))}\r\n        </ul>\r\n    ) : null;\r\n};\r\n\r\n\r\nexport default SearchBarSuggestions;","import SearchBar from \"./search-bar.component\";\r\n\r\nexport default SearchBar;","import React, { FC, FormEvent, useCallback, useEffect, useLayoutEffect, useRef, useState } from \"react\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport styles from \"./search-bar.module.scss\";\r\nimport useSearchParam from \"hooks/useSearchParam\";\r\nimport SearchBarSuggestions from \"./search-bar-suggestions.component\";\r\n\r\n\r\ninterface OwnProps {\r\n    className?: string,\r\n}\r\n\r\nconst SearchBar: FC<OwnProps> = ({ className }) => {\r\n    const isMounted = useRef(false);\r\n    const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n    const [error, setError] = useState(\"\");\r\n\r\n    const [searchParam = '', setSearchParam] = useSearchParam(\"s\", newValue => {\r\n        !newValue && setInputTxt('')\r\n    });\r\n\r\n    const [inputTxt, setInputTxt] = useState(searchParam);\r\n    const [keyWord, setKeyWord] = useState('');\r\n\r\n    const [isFocus, setFocus] = useState(false);\r\n\r\n    const setFocusOn = useCallback(() => isMounted.current && setFocus(() => {\r\n        setTimeout(() => {\r\n            inputRef.current?.focus();\r\n            inputRef.current?.select();\r\n        }, 200);\r\n        return true;\r\n    }), []);\r\n\r\n    const setFocusOff = useCallback(() => isMounted.current && setFocus(() => {\r\n        inputRef.current?.blur();\r\n        setError(\"\");\r\n        return false;\r\n    }), []);\r\n\r\n\r\n    function onSubmit (e?: FormEvent<HTMLFormElement>) {\r\n        e?.preventDefault();\r\n        let searchTerm = inputRef.current?.value || '';\r\n\r\n        if (!searchTerm)\r\n            return setError(\"Search can't be empty.\");\r\n\r\n        if (searchParam !== searchTerm) {\r\n            setFocusOff();\r\n            error && setError(\"\");\r\n            setTimeout(() => setSearchParam(searchTerm, [\"page\", 1]), 150);\r\n        } else {\r\n            setError(\"Search results already showing.\");\r\n        }\r\n\r\n        setInputTxt(searchTerm);\r\n        setKeyWord('');\r\n    }\r\n\r\n    useEffect(() => {\r\n        isMounted.current = true;\r\n        const listener = (e: KeyboardEvent) => {\r\n            switch (e.code) {\r\n                case \"Slash\":\r\n                    document.activeElement !== inputRef.current && setTimeout(setFocusOn ,50);\r\n                    break;\r\n                case \"Escape\": setFocusOff();\r\n                    break;\r\n                default: break;\r\n            }\r\n        };\r\n        window.addEventListener(\"keydown\", listener);\r\n        return () => {\r\n            isMounted.current = false;\r\n            window.removeEventListener(\"keydown\", listener);\r\n        }\r\n    }, [setFocusOff, setFocusOn]);\r\n\r\n    useLayoutEffect(() => {\r\n        setFocus(!searchParam);\r\n    }, [searchParam]);\r\n\r\n\r\n    return (\r\n        <div className={`${styles.root} ${className || ''}`} is-focused={`${isFocus}`}>\r\n            <form autoComplete=\"off\" onSubmit={onSubmit}>\r\n                <TextField\r\n                    className={styles.bar}\r\n                    label=\"Movie Search\"\r\n                    error={!!error}\r\n                    helperText={error}\r\n                    onBlur={() => {\r\n                        if (!searchParam || keyWord) return;\r\n                        setFocusOff();\r\n                    }}\r\n                    inputRef={inputRef}\r\n                    name={\"searchTerm\"}\r\n                    value={inputTxt}\r\n                    onChange={({target}) => {\r\n                        setInputTxt(target.value);\r\n                        setKeyWord(target.value);\r\n                    }}\r\n                    onFocus={setFocusOn}\r\n                    inputProps={{\r\n                        id: \"movies-browser-bar-input\",\r\n                        onClick: event => event.preventDefault(),\r\n                        onKeyDown: (e) => (e.key === \"ArrowUp\" || e.key === \"ArrowDown\") && e.preventDefault()\r\n                    }}\r\n                />\r\n            </form>\r\n            {!!keyWord && isFocus &&\r\n                <SearchBarSuggestions\r\n                    keyword={keyWord}\r\n                    onSubmit={onSubmit}\r\n                    inputRef={inputRef}\r\n                />\r\n            }\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default React.memo(SearchBar);\r\n","import PaginationControls from \"./pagination-controls.component\";\r\n\r\nexport default PaginationControls;","import React, { FC, memo, useCallback, useEffect } from \"react\";\r\nimport MobileStepper from \"@material-ui/core/MobileStepper\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport KeyboardArrowLeft from \"@material-ui/icons/KeyboardArrowLeft\";\r\nimport KeyboardArrowRight from \"@material-ui/icons/KeyboardArrowRight\";\r\nimport styles from \"./pagination-controls.module.scss\";\r\nimport useSearchParam from \"hooks/useSearchParam\";\r\nimport { scrollToTop } from \"utility\";\r\nimport useIsMobile from \"hooks/useIsMobile\";\r\n\r\ninterface OwnProps {\r\n    className?: string,\r\n    totalPages: number,\r\n}\r\n\r\ntype Props = OwnProps\r\n\r\nconst PaginationControls: FC<Props> = ({className, totalPages}) => {\r\n    const isMobile = useIsMobile();\r\n    const [currentPage = 0, setCurrentPage] = useSearchParam(\"page\");\r\n    const [movieIdParam] = useSearchParam(\"movieId\");\r\n\r\n    const goToNextPage = useCallback(() => setCurrentPage(page => {\r\n        if (page && page < totalPages) {\r\n            isMobile && scrollToTop();\r\n            return page + 1;\r\n        }\r\n        return page || 0;\r\n    }), [isMobile, setCurrentPage, totalPages]);\r\n\r\n    const goToPreviousPage = useCallback(() => setCurrentPage(page => {\r\n        if (page && page > 1) {\r\n            isMobile && scrollToTop();\r\n            return page - 1;\r\n        }\r\n        return page || 0;\r\n    }), [isMobile, setCurrentPage]);\r\n\r\n    useEffect(() => {\r\n        const keydownListener = ({code, altKey, ctrlKey, shiftKey}: KeyboardEvent) => {\r\n            if (altKey || ctrlKey || shiftKey) return ;\r\n            if (document.activeElement?.id === \"movies-browser-bar-input\") return;\r\n            if (totalPages)\r\n                switch (code) {\r\n                    case \"ArrowRight\": return goToNextPage();\r\n                    case \"ArrowLeft\":  return goToPreviousPage();\r\n                    default: break;\r\n                }\r\n        };\r\n        if (!movieIdParam) // Only add listener of there is no movie being viewed.\r\n            window.addEventListener(\"keydown\", keydownListener);\r\n\r\n        return () => window.removeEventListener(\"keydown\", keydownListener)\r\n    }, [totalPages, currentPage, movieIdParam, goToNextPage, goToPreviousPage]);\r\n\r\n\r\n    return totalPages ? (\r\n        <MobileStepper\r\n            className={`${styles.root} ${className || ''}`}\r\n            position={\"static\"}\r\n            variant=\"text\"\r\n            steps={totalPages}\r\n            activeStep={currentPage && (currentPage - 1)}\r\n            nextButton={\r\n                <Button\r\n                    size=\"small\"\r\n                    onClick={goToNextPage}\r\n                    disabled={currentPage >= totalPages}\r\n                >\r\n                    Next <KeyboardArrowRight/>\r\n                </Button>\r\n            }\r\n            backButton={\r\n                <Button\r\n                    size=\"small\"\r\n                    onClick={goToPreviousPage}\r\n                    disabled={currentPage <= 1}\r\n                >\r\n                    <KeyboardArrowLeft/> Back\r\n                </Button>\r\n            }\r\n        />\r\n    ) : null\r\n};\r\n\r\nexport default memo(PaginationControls);\r\n","import LoadingSpinner from \"./loading-spinner.component\";\r\n\r\nexport default LoadingSpinner;","import React, { FC, useEffect, useState } from \"react\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport styles from \"./loading-spinner.module.scss\";\r\nimport useIsMobile from \"hooks/useIsMobile\";\r\n\r\n\r\ninterface OwnProps {\r\n    className?: string;\r\n    darken?: boolean;\r\n    delay?: number;\r\n    fixed?: boolean;\r\n}\r\n\r\n\r\nconst LoadingSpinner: FC<OwnProps> = ({className, darken = false, delay = 0, fixed = false, ...rest}) => {\r\n    const [visible, setVisible] = useState(delay === 0);\r\n\r\n    const isMobile = useIsMobile();\r\n\r\n    useEffect(() => {\r\n        let mounted = true;\r\n        if (!visible)\r\n            setTimeout(() => mounted && setVisible(true), delay);\r\n        return () => { mounted = false };\r\n    }, [delay, visible]);\r\n\r\n    return (\r\n        <div\r\n            className={`${styles.root} ${className || ''} ${darken ? styles.darken : ''}`} {...rest}\r\n            style={{opacity: visible ? 1 : 0, position: fixed ? \"fixed\" : \"absolute\"}}\r\n        >\r\n            <CircularProgress\r\n                size={\"15\" + (isMobile ? \"vw\" : \"vh\")}/>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default LoadingSpinner;","import React, { FC } from \"react\";\r\nimport styles from \"./movie-results-container.module.scss\";\r\nimport { animated, useTransition, UseTransitionProps } from \"react-spring\";\r\nimport usePrevious from \"hooks/usePrevious\";\r\nimport appProperties from \"../../appProperties\";\r\n\r\nlet { searchPageTransitionConfig } = appProperties;\r\n\r\ninterface Props {\r\n    page: number;\r\n    children: (page: number) => JSX.Element | JSX.Element[] | null\r\n}\r\nconst MovieItemsContainer: FC<Props> = ({page, children}) => {\r\n\r\n    const prevPage = usePrevious(page);\r\n    const isNextSlide = !prevPage || prevPage < page;\r\n    const transition = useTransition(page, page, getTransitionConfig(isNextSlide));\r\n\r\n    return (\r\n        <>\r\n            {transition.map(({key, props, item: page}) => page ?\r\n                <animated.div key={key} className={`${styles.root} transition-page`}\r\n                              style={{\r\n                                  ...props,\r\n                                  transform: props.translateX.interpolate(v =>\r\n                                      v ? `translateX(${v}%)`: ''\r\n                                  )\r\n                              }}\r\n                >\r\n                    {children(page)}\r\n                </animated.div> : null\r\n            )}\r\n        </>\r\n    )\r\n};\r\n\r\nfunction getTransitionConfig(isNextSlide: boolean): UseTransitionProps<number> {\r\n    let xOffset = 8;\r\n    return {\r\n        initial: {\r\n            opacity: 0,\r\n            translateX: 0,\r\n        },\r\n        from: {\r\n            opacity: -.2,\r\n            translateX: xOffset * (isNextSlide ? 1 : -1)\r\n        },\r\n        enter: {\r\n            opacity: 1,\r\n            translateX: 0\r\n        },\r\n        leave: {\r\n            opacity: -.2,\r\n            translateX: xOffset * (isNextSlide ? -1 : 1)\r\n        },\r\n        config: searchPageTransitionConfig,\r\n        unique: true,\r\n    };\r\n}\r\n\r\nexport default MovieItemsContainer;\r\n","import MovieResultsContainer from \"./movie-results-container.component\";\r\n\r\nexport default MovieResultsContainer;","import ErrorMessage from \"./error-message.component\";\r\n\r\nexport default ErrorMessage;","import React, { FC } from \"react\";\r\nimport IMoviesSearchError from \"../../interfaces/app-types/IMoviesSearchError\";\r\nimport styles from \"./error-message.module.scss\";\r\n\r\n\r\ninterface OwnProps {\r\n    error: IMoviesSearchError,\r\n    className?: string\r\n}\r\n\r\ntype Props = OwnProps;\r\n\r\nconst ErrorMessage: FC<Props> = ({className, error}) => {\r\n    return (\r\n        <div className={`${className ? className : ''} ${styles.root}`}>\r\n            <div className={styles.title}>- Search error -</div>\r\n            {error.errors.map((message, index) =>\r\n                <div key={index}>\"{message}\"</div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\nexport default ErrorMessage;","import TotalSearchResults from \"./total-search-results.component\";\r\n\r\nexport default TotalSearchResults;","import React, { FC } from \"react\";\r\nimport styles from \"./total-search-results.module.scss\";\r\nimport { formatToUSD } from \"utility\";\r\n\r\ninterface OwnProps {\r\n    totalResults: number\r\n}\r\n\r\nconst TotalSearchResults: FC<OwnProps> = ({totalResults}) => (\r\n    <div className={styles.root}>\r\n        Found: {formatToUSD(totalResults)}{totalResults === 10_000 && \"+\"}\r\n    </div>\r\n);\r\n\r\nexport default TotalSearchResults;","import { useLayoutEffect } from \"react\";\r\nimport { getHashPath, getHashQuery } from \"utility\";\r\n\r\nfunction onHashChange(e: HashChangeEvent) {\r\n\tconst pathURL = e.newURL.split(\"#\")[1];\r\n\tconst [locationPath, searchQuery = ''] = pathURL.split(\"?\");\r\n\tsessionStorage.setItem(locationPath, searchQuery);\r\n}\r\n\r\nfunction useSavedSessionParams() {\r\n\tuseLayoutEffect(() => {\r\n\t\tconst hashPath = getHashPath();\r\n\t\tconst savedPathParams = sessionStorage.getItem(hashPath);\r\n\r\n\t\tif (savedPathParams && !getHashQuery())\r\n\t\t\twindow.location.hash = hashPath + \"?\" + savedPathParams;\r\n\r\n\t\twindow.addEventListener(\"hashchange\", onHashChange);\r\n\t\treturn () => window.removeEventListener(\"hashchange\", onHashChange)\r\n\t}, [])\r\n}\r\n\r\nexport default useSavedSessionParams;","import { getMovieImgObjFromSession } from \"utility\";\r\nimport { useLayoutEffect, useRef, useState } from \"react\";\r\nimport ImageDataEvent from \"../utility/custom-events/ImageDataEvent\";\r\nimport IMovieImgSessionObj from \"../interfaces/app-types/IMovieImgSessionObj\";\r\n\r\n\r\nexport function useSessionAvgColor(movieId: number) {\r\n    const idRef = useRef(movieId);\r\n    const [imgData, setImgData] = useState<IMovieImgSessionObj | undefined>();\r\n\r\n    useLayoutEffect(() => {\r\n        const imgObj = getMovieImgObjFromSession(idRef.current);\r\n        function onColorReadyListener({detail: { movieId: movieIdSaved, imgData }}: ImageDataEvent) {\r\n            if (movieIdSaved === idRef.current) {\r\n                setImgData(imgData);\r\n                window.removeEventListener(\"imageData\", onColorReadyListener);\r\n            }\r\n        }\r\n        if (!imgObj) window.addEventListener(\"imageData\", onColorReadyListener);\r\n        else setImgData(imgObj);\r\n        return () => window.removeEventListener(\"imageData\", onColorReadyListener);\r\n    }, []);\r\n\r\n\r\n    return imgData;\r\n}\r\n\r\n","import { useEffect, useRef, useState } from \"react\";\r\nimport MovieViewEvent, { MovieViewEventState } from \"../utility/custom-events/MovieViewEvent\";\r\nimport capitalize from \"@material-ui/core/utils/capitalize\";\r\n\r\n\r\ninterface OnMovieViewConfig<T> {\r\n\tonEnter?:  T | (() => T);\r\n\tonUpdate?: T | (() => T);\r\n\tonView?:   T | (() => T);\r\n\tonClose?:  T | (() => T);\r\n\tonLeave?:  T | (() => T);\r\n}\r\n\r\ntype HookState<T> = [T, MovieViewEventState | \"initial\"]\r\n\r\nfunction useOnMovieView<T>(id: number, initial: T, config: OnMovieViewConfig<T>): HookState<T> {\r\n\tconst idRef = useRef(id);\r\n\tconst configRef = useRef(config);\r\n\r\n\tconst [props, setProps] = useState<HookState<T>>([initial, \"initial\"]);\r\n\r\n\r\n\tuseEffect(() => {idRef.current = id}, [id]);\r\n\tuseEffect(() => {configRef.current = config}, [config]);\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tlet mounted = true;\r\n\r\n\t\tfunction onEvent({detail:{state, movieId}}: MovieViewEvent) {\r\n\t\t\tif (movieId !== idRef.current) return;\r\n\r\n\t\t\tconst configPropName = `on${capitalize(state)}` as keyof OnMovieViewConfig<T>;\r\n\r\n\t\t\tif (configPropName in configRef.current) {\r\n\r\n\t\t\t\tlet configProp = configRef.current[configPropName]!;\r\n\t\t\t\t// @ts-ignore (because the truthy ternary expression is indeed callable)\r\n\t\t\t\tlet newStateProps = typeof configProp === \"function\" ? configProp() : configProp;\r\n\r\n\t\t\t\tmounted && setProps([newStateProps, state]);\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.addEventListener(\"movieView\", onEvent);\r\n\t\treturn () => {\r\n\t\t\tmounted = false;\r\n\t\t\twindow.removeEventListener(\"movieView\", onEvent);\r\n\t\t}\r\n\t}, []);\r\n\r\n\treturn props;\r\n}\r\n\r\nexport default useOnMovieView;","import React, { FC, useEffect, useState } from \"react\";\r\nimport styles from \"./movie-item-img-bg.module.scss\";\r\nimport { animated, useSpring } from \"react-spring\";\r\nimport { easeOutCubic } from \"../../utility/easingFuctions\";\r\nimport { useSessionAvgColor } from \"hooks/useSessionAvgColor\";\r\nimport useOnMovieView from \"hooks/useOnMovieView\";\r\nimport useIsMobile from \"hooks/useIsMobile\";\r\n\r\n\r\ninterface OwnProps {\r\n    movieId: number,\r\n    itemView?: boolean,\r\n    className?: string,\r\n}\r\n\r\ntype Props = OwnProps;\r\n\r\n\r\nconst MovieItemImgBg: FC<Props> = ({className, movieId, itemView = false}) => {\r\n    const isMobile = useIsMobile();\r\n\r\n    const [isRevealed, setRevealed] = useState<boolean>(itemView);\r\n\r\n    const opacityReveal = isRevealed ? .4 : 0;\r\n\r\n    useEffect(() => {\r\n        let mounted = true;\r\n        if (!itemView) { // reveal\r\n            setTimeout(() => {\r\n                mounted && setRevealed(true)\r\n            }, 450);\r\n        }\r\n        return () => { mounted = false };\r\n    }, [itemView]);\r\n\r\n    const [opacityOnMovView, eventState] = useOnMovieView(movieId, opacityReveal, {\r\n        ...(itemView ? {\r\n            onEnter: 0,\r\n            onClose: opacityReveal\r\n        } : {})\r\n    });\r\n\r\n    let props = useSpring({\r\n        opacity: itemView ? opacityOnMovView : opacityReveal,\r\n        config: {\r\n            duration: eventState === \"close\" ? 450 : 2100,\r\n            easing: eventState === \"close\" ? undefined : easeOutCubic\r\n        }\r\n    });\r\n\r\n    let imgSrc = '';\r\n\r\n    let movieImgDataObj = useSessionAvgColor(movieId);\r\n\r\n    if (!!movieImgDataObj?.jpgData && !isMobile)\r\n        imgSrc = movieImgDataObj.jpgData;\r\n\r\n    return (\r\n        <animated.img src={imgSrc} className={`${styles.root} ${className || ''}`}\r\n            alt={''} crossOrigin={\"anonymous\"} item-view={String(itemView)} style={{\r\n                imageRendering: \"pixelated\",\r\n                display: !!movieImgDataObj ? \"block\" : \"none\",\r\n                backgroundColor: movieImgDataObj?.averageColor,\r\n                ...props\r\n            }}\r\n        />\r\n    );\r\n};\r\n\r\nMovieItemImgBg.defaultProps = {\r\n    itemView: false\r\n};\r\n\r\n\r\nexport default React.memo(MovieItemImgBg);","import MovieItemImgBg from \"./movie-item-img-bg.component\";\r\n\r\nexport default MovieItemImgBg;","import React, { CSSProperties, FC, RefObject, useEffect, useRef } from \"react\";\r\nimport styles from \"./circled-progress-bar.module.scss\";\r\nimport { hslInterval, hslToHex } from \"utility\";\r\nimport { animated, useSpring } from \"react-spring\";\r\nimport { easeOutQuad } from \"../../utility/easingFuctions\";\r\nimport useIsMobile from \"hooks/useIsMobile\";\r\n\r\ninterface OwnProps {\r\n    score: number;\r\n    itemView: boolean;\r\n    className?: string;\r\n}\r\n\r\ntype Props = OwnProps;\r\n\r\nconst viewBoxSize = 60;\r\nconst strokeWidth = viewBoxSize / 15;\r\nconst circleRadius = viewBoxSize / 2 - strokeWidth;\r\nconst circleCircumference = circleRadius * 2 * Math.PI;\r\n\r\n// (min & max) colors MUST be in hsl\r\nconst minScoreColor: [number, number, number] = [1, 81, 40];\r\nconst maxScoreColor: [number, number, number] = [117, 88, 67];\r\nconst backFill = \"rgba(0, 0, 0, .25)\";\r\nconst backStroke = \"#5d5d5d\";\r\n\r\nconst RatingProgressBar: FC<Props> = ({score, itemView = false, className, ...rest}) => {\r\n    const rootRef: RefObject<HTMLDivElement> = useRef(null);\r\n    const progressMultiplier = score / 10;\r\n\r\n    const isMobile = useIsMobile();\r\n\r\n    const progressColor = hslInterval(\r\n        minScoreColor,\r\n        maxScoreColor,\r\n        progressMultiplier\r\n    );\r\n\r\n    const progressValue = circleCircumference * progressMultiplier;\r\n    const strokeDashOffsetVal = circleCircumference - progressValue;\r\n\r\n    const [props, set] = useSpring(() => ({\r\n        stroke: hslToHex(!itemView ? minScoreColor : progressColor),\r\n        strokeDashoffset: !itemView ? circleCircumference : strokeDashOffsetVal,\r\n        config: {\r\n            duration: 3000 * progressMultiplier,\r\n            easing: easeOutQuad\r\n        },\r\n    }));\r\n\r\n    useEffect(onComponentMount, []);\r\n\r\n    const style: CSSProperties = {\r\n        visibility: !itemView ? \"hidden\" : undefined,\r\n        opacity: !itemView ? 0 : 1\r\n    };\r\n\r\n    return (\r\n            <div className={`${styles.root} ${className ? className : ''}`} {...rest} style={style} ref={rootRef}>\r\n                <svg height=\"100%\" width={viewBoxSize} viewBox={`0 0 ${viewBoxSize} ${viewBoxSize}`}\r\n                     overflow={\"visible\"}>\r\n                    <circle\r\n                        cx={viewBoxSize / 2}\r\n                        cy={viewBoxSize / 2}\r\n                        r={circleRadius}\r\n                        fill={backFill}\r\n                        stroke={backStroke}\r\n                        strokeWidth={strokeWidth}\r\n                        style={{zIndex: -1}}\r\n                    />\r\n                    <animated.circle\r\n                        style={!isMobile ? props : undefined}\r\n                        cx={viewBoxSize / 2}\r\n                        cy={viewBoxSize / 2}\r\n                        r={circleRadius}\r\n                        stroke={hslToHex(progressColor)}\r\n                        fill={\"none\"}\r\n                        strokeDasharray={circleCircumference}\r\n                        strokeLinecap={\"round\"}\r\n                        strokeDashoffset={strokeDashOffsetVal.toString()}\r\n                        strokeWidth={strokeWidth}\r\n                        strokeMiterlimit={viewBoxSize / 10}\r\n                        transform={`rotate(-90 ${viewBoxSize / 2} ${viewBoxSize / 2})`}\r\n                    />\r\n                </svg>\r\n                <span className={styles.scoreValue}>{score ? score.toPrecision(2) : 'NR'}</span>\r\n            </div>\r\n    );\r\n\r\n    function onComponentMount() {\r\n        let ignore = false;\r\n        setTimeout(() => {\r\n            if (ignore) return;\r\n            if (!itemView) {\r\n                rootRef.current!.style.visibility = \"visible\";\r\n                rootRef.current!.style.opacity = \"1\";\r\n                animateProgress()\r\n            }\r\n        } ,400);\r\n        return () => void (ignore = true);\r\n    }\r\n\r\n    function animateProgress() {\r\n        set({\r\n            stroke: hslToHex(progressColor),\r\n            strokeDashoffset: strokeDashOffsetVal\r\n        });\r\n    }\r\n};\r\n\r\nexport default RatingProgressBar;\r\n","import CircledProgressBar from \"./circled-progress-bar.component\";\r\n\r\nexport default CircledProgressBar;","import { useLayoutEffect, useRef } from \"react\";\r\n\r\nfunction useLockBodyScroll(maxWidth?: number) {\r\n\tconst maxWidthRef = useRef(maxWidth);\r\n\tuseLayoutEffect(() => {\r\n\t\t// Get original body overflow\r\n\t\t// const originalBodyStyle = window.getComputedStyle(document.body).overflow;\r\n\t\tconst originalStyle = document.scrollingElement ?\r\n\t\t\twindow.getComputedStyle(document.scrollingElement).overflow : ''\r\n\t\t// Prevent scrolling on mount\r\n\t\tif (typeof maxWidthRef.current === \"undefined\" || window.innerWidth <= maxWidthRef.current) {\r\n\t\t\t// document.body.style.overflow = 'hidden';\r\n\t\t\tif (document.scrollingElement)\r\n\t\t\t\t(document.scrollingElement as HTMLElement).style.overflow = 'hidden';\r\n\t\t}\r\n\t\t// Re-enable scrolling on component unmount\r\n\t\treturn () => {\r\n\t\t\tif (document.scrollingElement)\r\n\t\t\t\t(document.scrollingElement as HTMLElement).style.overflow = originalStyle;\r\n\t\t}\r\n\t}, []); // Empty array ensures effect is only run on mount and unmount\r\n}\r\n\r\nexport default useLockBodyScroll;","import React, { FC, useState } from \"react\";\r\nimport Rating from \"@material-ui/lab/Rating\";\r\nimport styles from \"./movie-view-actions.module.scss\";\r\nimport useIsMobile from \"hooks/useIsMobile\";\r\nimport useLockBodyScroll from \"hooks/useLockBodyScroll\";\r\n\r\n\r\ninterface Props {\r\n    rateItem: (newValue: number | null) => void;\r\n    defaultValue?: number;\r\n    setRatingModal: (state: boolean) => void\r\n}\r\n\r\nconst valuesMap = {\r\n    0  : 0.0,\r\n    1  : 0.5,\r\n    2  : 1.0,\r\n    3  : 1.5,\r\n    4  : 2.0,\r\n    5  : 2.5,\r\n    6  : 3.0,\r\n    7  : 3.5,\r\n    8  : 4.0,\r\n    9  : 4.5,\r\n    10 : 5.0\r\n}\r\n\r\nconst RatingModal: FC<Props> = ({rateItem, defaultValue = 0, setRatingModal}) => {\r\n    const isMobile = useIsMobile();\r\n    const [value, setValue] = useState<number | null>(defaultValue/2);\r\n\r\n    useLockBodyScroll(600);\r\n\r\n    const unRate = () => {\r\n        if (isMobile)\r\n            setValue(null)\r\n        else rateItem(null);\r\n    }\r\n    const handleClickAway = (e: React.MouseEvent) => {\r\n        const screenYPercent = e.clientY / window.innerHeight;\r\n        if (screenYPercent < .55)\r\n            setRatingModal(false);\r\n    }\r\n    function onTouch(e: React.TouchEvent<HTMLSpanElement>) {\r\n        const {left, right} = e.currentTarget.getBoundingClientRect();\r\n        const maxPoint = right - left;\r\n        const touchPoint = e.targetTouches[0].clientX - left;\r\n        const pointPercent = Math.round((touchPoint / maxPoint)*100);\r\n        const resultPercent =\r\n            pointPercent > 0 ? (pointPercent <= 100 ? pointPercent : 100) : 0\r\n\r\n        const newValue = valuesMap[Math.round(resultPercent / 10) as keyof typeof valuesMap];\r\n        setValue(newValue);\r\n    }\r\n\r\n    return (\r\n        <div className={styles.ratingModalContainer} onClick={handleClickAway} >\r\n            <div className={styles.ratingModal}>\r\n                {!!defaultValue &&\r\n                <button onClick={unRate} title=\"remove rating\" className={styles.removeButton}>-</button>\r\n                }\r\n                <Rating\r\n                    name=\"movie-rating\"\r\n                    precision={0.5}\r\n                    value={value}\r\n                    onChange={(event, newValue) => {\r\n                        if (isMobile)\r\n                            return;\r\n                        else rateItem((newValue || 0) * 2);\r\n                    }}\r\n                    onTouchMove={onTouch}\r\n                    onTouchStart={onTouch}\r\n                    size={isMobile ? \"large\" : \"medium\"}\r\n                />\r\n                {isMobile && <button\r\n                    disabled={(defaultValue/2) === value}\r\n                    className={styles.mobileSubmit}\r\n                    onClick={() => {\r\n                        rateItem(value ? value*2 : value)\r\n                    }}\r\n                >{value === null ? \"Un-Rate\" : \"Rate\"}</button>\r\n                }\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\nexport default RatingModal;","import React, { FC, useEffect, useState } from \"react\";\r\nimport useAuth from \"hooks/useAuth\";\r\nimport styles from \"./auth-page.module.scss\";\r\nimport TokenData from \"../../interfaces/app-types/TokenData\";\r\nimport { goFetch, isValidRequestToken } from \"utility\";\r\nimport appProperties from \"../../appProperties\";\r\n\r\nconst {newRequestTokenUrl} = appProperties;\r\n\r\nconst AuthPage: FC = ({children}) => {\r\n\tconst [requestToken, setRequestToken] = useState<string | null>(null);\r\n\tconst {isAuth, user, signOut, signIn} = useAuth();\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tlet ignore = false;\r\n\t\tconst localToken = getValidLocalToken();\r\n\r\n\t\tif (localToken)\r\n\t\t\tsetRequestToken(localToken);\r\n\r\n\t\telse goFetch<TokenData>(newRequestTokenUrl)\r\n\t\t\t\t.then(tokenData => {\r\n\t\t\t\t\tlocalStorage.setItem(\"token_data\", JSON.stringify(tokenData));\r\n\t\t\t\t\t!ignore && setRequestToken(tokenData.request_token);\r\n\t\t\t\t});\r\n\r\n\t\treturn () => void (ignore = true)\r\n\t}, []);\r\n\r\n\r\n\tconst handleLogin = () => {\r\n\t\tif (!requestToken) return;\r\n\t\tsignIn(requestToken);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className={styles.root}>\r\n\t\t\t{isAuth ? (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<div className={styles.userField}>\r\n\t\t\t\t\t\t<span>Username:</span>\r\n\t\t\t\t\t\t<span>{user!.username}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className={styles.userField}>\r\n\t\t\t\t\t\t<span>Name:</span>\r\n\t\t\t\t\t\t<span>{user!.name || '-- '}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</>\r\n\t\t\t) : (\r\n\t\t\t\t<div className={styles.userField}>\r\n\t\t\t\t\t<p>No user logged in</p>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t{isAuth ? (\r\n\t\t\t\t<button onClick={signOut}>Log out</button>\r\n\t\t\t) : (\r\n\t\t\t\t<button disabled={!requestToken} onClick={handleLogin}>Log in</button>\r\n\t\t\t)}\r\n\t\t\t{children}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nfunction getValidLocalToken(): string | null {\r\n\tconst localToken = localStorage.getItem(\"token_data\");\r\n\tif (localToken) {\r\n\t\tconst tokenResponse = JSON.parse(localToken) as TokenData;\r\n\t\treturn isValidRequestToken(tokenResponse) ? tokenResponse.request_token : null;\r\n\t} else return null;\r\n}\r\n\r\nexport default AuthPage;","import AuthPage from \"./auth-page.component\";\r\n\r\nexport default AuthPage;","import React, { FC, useEffect, useReducer, useRef, useState } from \"react\";\r\nimport styles from \"./movie-view-actions.module.scss\";\r\nimport { Tooltip } from \"@material-ui/core\";\r\nimport IMovieUserState, { Rated } from \"../../interfaces/app-types/IMovieUserState\";\r\nimport useAuth from \"hooks/useAuth\";\r\nimport { goFetch } from \"utility\";\r\nimport appProperties from \"../../appProperties\";\r\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\r\nimport BookmarkIcon from \"@material-ui/icons/Bookmark\";\r\nimport GradeIcon from \"@material-ui/icons/Grade\";\r\nimport RatingModal from \"./rating-modal.component\";\r\nimport AuthPage from \"pages/auth-page\";\r\nimport store from \"store\";\r\nimport IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\nimport getMoviesBrowserActions from \"../../store/movies-browser/movies-browser.actions\";\r\nimport { AccountItemsNames } from \"../../store/movies-browser\";\r\n\r\nconst {buildFetchMovieViewUrl, itemActions} = appProperties;\r\n\r\ninterface Props {\r\n    item: IMovieResultItem,\r\n    className?: string;\r\n}\r\ntype State = IMovieUserState & {isLoading: Array<keyof IMovieUserState>}\r\n\r\ntype ReducerActions =\r\n    | { type: 'set-account-state', payload: IMovieUserState }\r\n    | { type: 'update-favorite',   payload: boolean }\r\n    | { type: 'update-watchlist',  payload: boolean }\r\n    | { type: 'update-rated',      payload: boolean | Rated }\r\n    | { type: 'set-is-loading',    payload: Array<keyof IMovieUserState> }\r\n    | { type: 'clear-loading' };\r\n\r\nfunction reducer(state: State, action: ReducerActions): State {\r\n    switch (action.type) {\r\n        case \"set-account-state\":\r\n            return {\r\n                ...action.payload,\r\n                isLoading: []\r\n            }\r\n        case \"update-favorite\":\r\n            return {\r\n                ...state,\r\n                favorite: action.payload,\r\n                isLoading: state.isLoading.filter(value => value !== \"favorite\")\r\n            }\r\n        case \"update-watchlist\":\r\n            return {\r\n                ...state,\r\n                watchlist: action.payload,\r\n                isLoading: state.isLoading.filter(value => value !== \"watchlist\")\r\n            }\r\n        case \"update-rated\":\r\n            return {\r\n                ...state,\r\n                rated: action.payload,\r\n                isLoading: state.isLoading.filter(value => value !== \"rated\")\r\n            }\r\n        case \"set-is-loading\":\r\n            return {\r\n                ...state,\r\n                isLoading: [...new Set(\r\n                    [...state.isLoading, ...action.payload]\r\n                )]\r\n            }\r\n        case \"clear-loading\":\r\n            return {\r\n                ...state,\r\n                isLoading: []\r\n            }\r\n        default: return state;\r\n    }\r\n}\r\n\r\nconst initial_state: State = {\r\n    rated: false,\r\n    watchlist: false,\r\n    favorite: false,\r\n    isLoading: [],\r\n    id: 0\r\n}\r\nconst favoriteActions =  getMoviesBrowserActions(\"favorite\");\r\nconst watchlistActions =  getMoviesBrowserActions(\"watchlist\");\r\n\r\n\r\nconst MovieViewActionButtons: FC<Props> = ({item, className}) => {\r\n    const {id: movieId} = item;\r\n    const isMounted = useRef(false);\r\n\r\n    useEffect(() => {\r\n        isMounted.current = true;\r\n        return () => { isMounted.current = false }\r\n    }, []);\r\n\r\n    const [ratingModal, setRatingModal] = useState(false);\r\n    const [showLogin, setShowLogin] = useState(false);\r\n\r\n\r\n    const [state, dispatch] = useReducer(reducer, initial_state);\r\n    const setLoading = (actionName: keyof IMovieUserState) => dispatch({type: 'set-is-loading', payload: [actionName]});\r\n\r\n    const auth = useAuth();\r\n    const ratedValue = typeof state.rated === \"object\" ? state.rated.value : undefined;\r\n\r\n    const ignoreActions = !auth.isAuth || !state.id;\r\n\r\n    useEffect(() => {\r\n        let ignore = false;\r\n        if (auth.isAuth && !state.id) {\r\n            dispatch({type: 'set-is-loading', payload: ['id']});\r\n            goFetch<IMovieUserState>\r\n            (`${buildFetchMovieViewUrl(movieId, \"/account_states\")}&session_id=${localStorage.getItem(\"session_id\")}`)\r\n                .then(data => {\r\n                    !ignore && dispatch({type: 'set-account-state', payload: data});\r\n                });\r\n        }\r\n\r\n        return () => void (ignore = true)\r\n    }, [state.id, auth.isAuth, movieId]);\r\n\r\n    const markFavorite = () => {\r\n        if (ignoreActions) return !auth.isAuth && setShowLogin(true);\r\n        let newFavValue = !state.favorite;\r\n\r\n        if (checkAllowToRemove(newFavValue, \"favorite\")) {\r\n            setLoading('favorite');\r\n            itemActions.favorite(newFavValue, movieId)\r\n                .then(() => {\r\n                    if (newFavValue)\r\n                        store.dispatch(favoriteActions.unshiftToFavorites(item));\r\n                    else store.dispatch(favoriteActions.removeFromListItems(movieId));\r\n\r\n                    isMounted.current && dispatch({\r\n                        type: 'update-favorite', payload: newFavValue\r\n                    });\r\n                })\r\n                .catch(e => {\r\n                    console.error(e);\r\n                    alert(\"Error: could not mark to item-list :(\");\r\n                    isMounted.current && dispatch({type: 'clear-loading'});\r\n                });\r\n        }\r\n    }\r\n\r\n    const markWatchlist = () => {\r\n        if (ignoreActions) return !auth.isAuth && setShowLogin(true);\r\n        let newVal = !state.watchlist;\r\n\r\n        if (checkAllowToRemove(newVal, \"watchlist\")) {\r\n            setLoading('watchlist');\r\n            itemActions.watchlist(newVal, movieId)\r\n                .then(() => {\r\n                    if (newVal)\r\n                        store.dispatch(watchlistActions.unshiftToFavorites(item));\r\n                    else store.dispatch(watchlistActions.removeFromListItems(movieId));\r\n                    isMounted.current && dispatch({\r\n                        type: 'update-watchlist', payload: newVal\r\n                    });\r\n                })\r\n                .catch(e => {\r\n                    console.error(e);\r\n                    alert(\"Error: could not update watchlist :(\");\r\n                    isMounted.current && dispatch({type: 'clear-loading'});\r\n                });\r\n        }\r\n    }\r\n\r\n    const rateItem = (newVal: number | null) => {\r\n        if (ignoreActions) return setRatingModal(false);\r\n        if ((typeof state.rated === \"object\" && newVal === state.rated.value)\r\n            || (newVal === null && state.rated === false)\r\n        )\r\n            return setRatingModal(false);\r\n\r\n        setLoading(\"rated\");\r\n        setRatingModal(false);\r\n        if (newVal)\r\n            itemActions.rate(newVal, movieId)\r\n                .then(() => {\r\n                    isMounted.current && dispatch({\r\n                        type: 'update-rated', payload: {value: newVal}\r\n                    });\r\n                })\r\n                .catch(e => {\r\n                    console.error(e);\r\n                    alert(\"Error: could not update rating :(\")\r\n                    isMounted.current && dispatch({type: 'clear-loading'});\r\n                })\r\n        else itemActions.unRate(movieId)\r\n            .then(() => {\r\n                isMounted.current && dispatch({\r\n                    type: 'update-rated', payload: false\r\n                });\r\n            })\r\n            .catch(e => {\r\n                console.error(e);\r\n                alert(\"Error: could not update rating :(\")\r\n                isMounted.current && dispatch({type: 'clear-loading'});\r\n            })\r\n    }\r\n\r\n    return (\r\n        <ul className={`${styles.root} ${className || ''}`}>\r\n            <Tooltip key={\"favorite\"}\r\n                     title={(!state.favorite ? \"Mark as\" : \"Remove from\") + \" Favorite\"}\r\n                     enterDelay={300}\r\n                     PopperProps={{className: styles.toolTip}}>\r\n                <div className={styles.iconWrapper}\r\n                     active-icon={String(state.favorite)}\r\n                     action-name={\"favorite\"}\r\n                     is-loading={String(state.isLoading.includes(\"favorite\"))}\r\n                     onClick={markFavorite}\r\n                >\r\n                    <FavoriteIcon className={styles.icon} />\r\n                </div>\r\n            </Tooltip>\r\n            <Tooltip key={\"watchlist\"}\r\n                     title={(!state.watchlist ? \"Add to\" : \"Remove from\") + \" Watchlist\"}\r\n                     enterDelay={300}\r\n                     PopperProps={{className: styles.toolTip}}>\r\n                <div className={styles.iconWrapper}\r\n                     active-icon={String(state.watchlist)}\r\n                     action-name={\"watchlist\"}\r\n                     is-loading={String(state.isLoading.includes(\"watchlist\"))}\r\n                     onClick={markWatchlist}\r\n                >\r\n                    <BookmarkIcon className={styles.icon} />\r\n                </div>\r\n            </Tooltip>\r\n            <Tooltip key={\"rated\"}\r\n                     title={\"Rate it!\"}\r\n                     enterDelay={300}\r\n                     PopperProps={{className: styles.toolTip}}>\r\n                <div className={styles.iconWrapper}\r\n                     active-icon={String(!!state.rated)}\r\n                     action-name={\"rated\"}\r\n                     is-loading={String(state.isLoading.includes(\"rated\"))}\r\n                     onClick={() => {\r\n                         if (!auth.isAuth) return setShowLogin(true);\r\n                         setRatingModal(prev => !prev)\r\n                     }}\r\n                     {...(!!state.rated ?\r\n                         {\"icon-score\": (state.rated as Rated).value} : {})}\r\n                >\r\n                    <GradeIcon className={styles.icon} />\r\n                </div>\r\n            </Tooltip>\r\n            {ratingModal && <RatingModal setRatingModal={setRatingModal} rateItem={rateItem} defaultValue={ratedValue}/>}\r\n            {showLogin && (\r\n                <div className={styles.showAuth} onClick={e => {\r\n                    if (e.target === e.currentTarget) setShowLogin(false)\r\n                }}>\r\n                    <AuthPage>\r\n                        <button className={styles.xButton}\r\n                                onClick={() => setShowLogin(false)}\r\n                        >&#10005;</button>\r\n                    </AuthPage>\r\n                </div>\r\n            )}\r\n        </ul>\r\n    );\r\n};\r\n\r\nfunction checkAllowToRemove(newValue: boolean, itemName: AccountItemsNames): boolean {\r\n    if (newValue) return true;\r\n    else return window.confirm(`Remove item from ${itemName === \"favorite\" ? \"favorites\" : itemName}?`)\r\n}\r\n\r\n\r\n\r\nexport default MovieViewActionButtons;\r\n","import MovieViewActions from \"./movie-view-actions.component\";\r\n\r\nexport default MovieViewActions;","import MovieItemImage from \"./movie-item-image.component\";\r\n\r\nexport default MovieItemImage;","import React, { FC } from \"react\";\r\nimport IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\nimport store from \"store\";\r\nimport { setMovieView } from \"store/movie-view/movie-view.actions\";\r\nimport ImageIcon from \"@material-ui/icons/Image\";\r\nimport styles from \"./movie-item-image.module.scss\";\r\n\r\n\r\ninterface OwnProps {\r\n\tbackGroundUrl: string;\r\n\tposter_path: string | null;\r\n\tmovie: IMovieResultItem;\r\n\titemView?: boolean;\r\n\tclassName?: string;\r\n}\r\n\r\nconst MovieItemImage: FC<OwnProps> =\r\n\t({movie, backGroundUrl, poster_path, itemView = false, className}) =>\r\n\t\t<div className={`${styles.root} ${className || ''}`} item-view={String(itemView)}>\r\n\t\t\t<div style={{backgroundImage: backGroundUrl}}\r\n\t\t\t     onClick={() => !itemView && store.dispatch(setMovieView(movie))}\r\n\t\t\t     className={styles.image}>\r\n\t\t\t\t{!poster_path && <>\r\n                    <ImageIcon className={styles.imageIcon}/>\r\n                    <span>No<br/>Image</span>\r\n                </>}\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\r\n\r\nexport default MovieItemImage;","import React, { CSSProperties, FC, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport MovieItemImgBg from \"components/movie-item-img-bg\";\r\nimport RatingProgressBar from \"components/circled-progress-bar\";\r\nimport MovieViewActionButtons from \"components/movie-view-actions\";\r\nimport styles from \"./movie-result-item.module.scss\";\r\nimport IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\nimport appProperties from \"../../appProperties\";\r\nimport useOnMovieView from \"hooks/useOnMovieView\";\r\nimport useIsMobile from \"hooks/useIsMobile\";\r\nimport MovieItemImage from \"components/movie-item-image\";\r\n\r\nconst {getPosterSrcPathPrefix} = appProperties;\r\n\r\ninterface OwnProps {\r\n\tmovie: IMovieResultItem;\r\n\titemView?: boolean;\r\n\tclassName?: string;\r\n}\r\n\r\ntype OnViewConfigGeneric = \"hidden\" | \"visible\";\r\n\r\nconst MovieResultItem: FC<OwnProps> = ({movie, className, itemView = false}) => {\r\n\tconst isMobile = useIsMobile();\r\n\tconst itemRef = useRef<HTMLDivElement>(null);\r\n\tlet {poster_path, title, vote_average, release_date, overview} = movie;\r\n\r\n\tconst [imgSrcPath, setImgSrcPath] = useState(() => `${getPosterSrcPathPrefix()}${poster_path}`);\r\n\r\n\tconst initialOnViewProps: CSSProperties = {opacity: 0, visibility: \"hidden\"};\r\n\tconst [onMovieProps, propsState] = useOnMovieView<CSSProperties>(movie.id, initialOnViewProps, {\r\n\t\t...(itemView ? {\r\n\t\t\tonEnter: initialOnViewProps,\r\n\t\t\tonView: {opacity: 1, transition: \"opacity 650ms ease\"},\r\n\t\t\tonClose: {opacity: 0, transition: \"opacity 450ms ease\"}\r\n\t\t} : {})\r\n\t});\r\n\r\n\tconst titleStyle: CSSProperties = {\r\n\t\tfontSize: (propsState === \"view\" || propsState === \"enter\" || isMobile) ?\r\n\t\t\t(itemView ? (isMobile ? \"1.4rem\" : \"1.9rem\") : undefined) : undefined\r\n\t};\r\n\r\n\tconst [visibility, visibilityState] = useOnMovieView<OnViewConfigGeneric>\r\n\t(movie.id, \"visible\", !itemView ? onViewConfigNotItemView : {\r\n\t\tonView: () => {\r\n\t\t\tif (itemView && poster_path) { // this is to make image look better (higher quality)\r\n\t\t\t\tlet newSrc = `${getPosterSrcPathPrefix(\"500\")}${poster_path}`;\r\n\t\t\t\tlet image = new Image();\r\n\t\t\t\t// set newSrc upon cached response for better UX\r\n\t\t\t\timage.onload = () => setImgSrcPath(newSrc);\r\n\t\t\t\timage.src = newSrc;\r\n\t\t\t}\r\n\t\t\treturn \"visible\";\r\n\t\t}\r\n\t});\r\n\r\n\tuseEffect(() => {\r\n\t\tif (visibilityState === \"leave\") {\r\n\t\t\tvoid itemRef.current!.offsetWidth; // this trick will trigger animation play/replay\r\n\t\t\titemRef.current!.classList.add(styles.runAnimation);\r\n\t\t} else itemRef.current!.classList.remove(styles.runAnimation);\r\n\t}, [visibilityState]);\r\n\t\r\n\t\r\n\tconst memoizedItemImage = useMemo(() =>\r\n\t\t<MovieItemImage\r\n\t\t\tbackGroundUrl={poster_path ? `url(\"${imgSrcPath}\")` : ''}\r\n\t\t\tposter_path={poster_path}\r\n\t\t\tmovie={movie}\r\n\t\t\titemView={itemView}\r\n\t\t/>, [imgSrcPath, poster_path]\r\n\t)\r\n\r\n\treturn (\r\n\t\t<div className={`${styles.root} ${className || ''}`}\r\n\t\t     item-view={String(itemView)}\r\n\t\t     id={!itemView ? String(movie.id) : ''}\r\n\t\t     ref={itemRef}\r\n\t\t     style={{visibility}}\r\n\t\t>\r\n\t\t\t{!(isMobile && itemView) && <MovieItemImgBg movieId={movie.id} itemView={itemView}/>}\r\n\t\t\t{memoizedItemImage}\r\n\t\t\t<div className={styles.content}>\r\n\t\t\t\t<div className={styles.wrapper}>\r\n\t\t\t\t\t<div className={styles.header}>\r\n\t\t\t\t\t\t<div className={styles.title} style={titleStyle}>{title}</div>\r\n\t\t\t\t\t\t{release_date && (\r\n\t\t\t\t\t\t\t<div className={styles.year}>{release_date.substr(0, 4)}</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{itemView && !isMobile && (\r\n\t\t\t\t\t\t\t<p className={styles.overViewSection} style={onMovieProps}>{overview}</p>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{!(isMobile && itemView) && (\r\n\t\t\t\t\t\t<div className={styles.info}>\r\n\t\t\t\t\t\t\t<div><RatingProgressBar score={vote_average} itemView={itemView}/></div>\r\n\t\t\t\t\t\t\t{itemView && <div style={onMovieProps}><MovieViewActionButtons item={movie}/></div>}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst onViewConfigNotItemView = {\r\n\tonEnter: \"hidden\" as OnViewConfigGeneric,\r\n\tonLeave: \"visible\" as OnViewConfigGeneric\r\n};\r\n\r\n\r\nexport default MovieResultItem;","import MovieResultItem from \"./movie-result-item.component\";\r\n\r\nexport default MovieResultItem;","import MovieResultSkeleton from \"./movie-result-skeleton.component\";\r\n\r\nexport default MovieResultSkeleton;","import React, { FC } from \"react\";\r\nimport styles from \"./movie-result-skeleton.module.scss\";\r\n\r\nconst viewBoxSize = 60;\r\nconst strokeWidth = viewBoxSize / 15;\r\nconst circleRadius = viewBoxSize / 2 - strokeWidth;\r\n\r\nconst backFill = \"rgba(0, 0, 0, .25)\";\r\nconst backStroke = \"#5d5d5d\";\r\n\r\nconst MovieResultSkeleton: FC = () => (\r\n    <div className={`${styles.root}`}>\r\n        <div className={styles.imageWrapper}>\r\n            <div className={styles.image}/>\r\n        </div>\r\n        <div className={styles.content}>\r\n            <div className={styles.wrapper}>\r\n                <div className={styles.header}>\r\n                    <div className={styles.title}/>\r\n                    <div className={styles.year}/>\r\n                </div>\r\n                <div className={styles.info}>\r\n                    <div className={styles.infoWrapper}>\r\n                        <svg height=\"100%\" width={viewBoxSize} viewBox={`0 0 ${viewBoxSize} ${viewBoxSize}`}\r\n                             overflow={\"visible\"}>\r\n                            <circle\r\n                                cx={viewBoxSize / 2}\r\n                                cy={viewBoxSize / 2}\r\n                                r={circleRadius}\r\n                                fill={backFill}\r\n                                stroke={backStroke}\r\n                                strokeWidth={strokeWidth}\r\n                                style={{zIndex: -1}}\r\n                            />\r\n                        </svg>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n);\r\n\r\n\r\nexport default MovieResultSkeleton;","import { MoviesBrowseNames } from \"store/movies-browser\";\r\nimport useSearchParam from \"./useSearchParam\";\r\nimport IMovieResultItem from \"../interfaces/app-types/IMovieResultItem\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport getMoviesBrowserActions from \"store/movies-browser/movies-browser.actions\";\r\nimport { useSelector } from \"react-redux\";\r\nimport store, { AppState } from \"store\";\r\nimport { MoviesBrowseState } from \"store/movies-browser/movies-browser.reducer\";\r\nimport { calculatePageOnApi } from \"utility\";\r\nimport appProperties from \"../appProperties\";\r\nimport IMoviesSearchError from \"../interfaces/app-types/IMoviesSearchError\";\r\n\r\nconst {itemsPerPageUI} = appProperties;\r\n\r\ntype MoviesBrowseActions = ReturnType<typeof getMoviesBrowserActions>;\r\nexport type PortionItemUI = IMovieResultItem | Pick<IMovieResultItem, \"id\">;\r\nexport type ItemsPortionUI = PortionItemUI[];\r\n\r\nexport function isMovieItem(item: PortionItemUI): item is IMovieResultItem {\r\n\treturn 'title' in item;\r\n}\r\n\r\ninterface useMovieItemsHook {\r\n\titems: ItemsPortionUI,\r\n\terror: IMoviesSearchError | null\r\n\tpageUI: number,\r\n\tisLoading: boolean,\r\n\tgoToPage: (page: number) => void,\r\n\ttotalPagesUI: number,\r\n\ttotalResults: number,\r\n}\r\ninterface useMovieItemsProps<TNames> {\r\n\tname: TNames;\r\n\tsearchQuery?: string;\r\n}\r\n\r\ntype PropTypes =\r\n\t| {name: \"favorite\" }\r\n\t| {name: \"watchlist\" }\r\n\t| {name: \"search\", searchQuery: string }\r\n\t| {name: \"nowPlaying\" }\r\n\t| {name: \"trendingWeek\" }\r\n\r\n\r\nconst isFetchingOrLengthEquality = (newState: MoviesBrowseState, oldState: MoviesBrowseState) =>\r\n\t(newState.isFetching === oldState.isFetching && newState.isFetchingMore === oldState.isFetchingMore)\r\n\t&& (Object.keys(newState.searchData?.results || {}).length === Object.keys(oldState.searchData?.results || {}).length)\r\n\r\n/**\r\n *  @description <p>The 'goToPage' property of the returned object is not available for \"trendingWeek\"</p>.\r\n *                <p>Also, authentication is required to retrieve: </p>\r\n *                <ul>\r\n *                    <li>favorite</li>\r\n *                    <li>watchlist</li>\r\n *                </ul>\r\n * */\r\nfunction useMovieItems<TNames extends MoviesBrowseNames>\r\n\t(props: useMovieItemsProps<TNames> & PropTypes) {\r\n\r\n\t// get corresponding actions\r\n\tconst [actionsInit] = useState(() => getMoviesBrowserActions(props.name));\r\n\tconst actionsRef = useRef<MoviesBrowseActions>(actionsInit);\r\n\tconst nameRef = useRef<MoviesBrowseNames>(props.name);\r\n\r\n\t// get corresponding state\r\n\tconst state = useSelector<AppState, MoviesBrowseState>\r\n\t\t(state => state[props.name], isFetchingOrLengthEquality);\r\n\r\n\r\n\tconst [pageUI = 1, setPage] = useSearchParam(\"page\", pageUI => {\r\n\t\tpageUI && store.dispatch(actionsRef.current.checkIfFetchMore(pageUI));\r\n\t});\r\n\r\n\tuseEffect(() => {\r\n\t\tif (nameRef.current === \"search\") return;\r\n\t\tif (!store.getState()[nameRef.current].searchData)\r\n\t\t\tstore.dispatch(actionsRef.current.fetchMoviesAsync())\r\n\t}, []);\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tconst id = setTimeout(() => { // this timeOut is to make sure the effect has the latest dependencies because it there could be a delay between pageUI param and searchQuery arg\r\n\t\t\tif (nameRef.current === \"search\" && state.searchTerm !== props.searchQuery && props.searchQuery && !state.isFetching)\r\n\t\t\t\tstore.dispatch(actionsRef.current.fetchMoviesAsync(props.searchQuery, calculatePageOnApi(pageUI)));\r\n\t\t}, 150)\r\n\t\treturn () => clearTimeout(id);\r\n\t}, [pageUI, props.searchQuery, state]);\r\n\r\n\r\n\treturn ({\r\n\t\t        items  :  selectItemsUIPortion(state, pageUI), // select a portion based on \"itemsPerPageUI\" defined in \"/appProperties\"\r\n\t\t        error  :  state.searchError,\r\n\t\t       pageUI  :  pageUI,\r\n\t\t    isLoading  :  state.isFetching,\r\n\t\t totalPagesUI  :  calculateTotalPagesUI(state.searchData?.total_results || 0),\r\n\t\t totalResults  :  state.searchData?.total_results || 0,\r\n\t\t     goToPage  :  (nameRef.current !== \"trendingWeek\") ? ((page: number) => setPage(page)) : undefined\r\n\t} as\r\n\t\tTNames extends \"trendingWeek\" ? Omit<useMovieItemsHook, \"goToPage\"> : useMovieItemsHook)\r\n\r\n}\r\n\r\nfunction selectItemsUIPortion(browseState: MoviesBrowseState, pageUI: number = 1) {\r\n\tlet selected: ItemsPortionUI = [];\r\n\r\n\tif (browseState.isFetching || !browseState.searchData) return selected;\r\n\r\n\tconst fromIndex = ((pageUI - 1) * itemsPerPageUI);\r\n\r\n\tfor (let i = 0; i < itemsPerPageUI; i++) {\r\n\t\tlet grabIndex = fromIndex + i;\r\n\t\tlet item = browseState.searchData.results[grabIndex];\r\n\t\tselected[i] = item || {id: grabIndex}; // provisional key\r\n\t\tif (grabIndex+1 === browseState.searchData.total_results) break; // break if last item\r\n\t}\r\n\r\n\treturn selected;\r\n}\r\n\r\nfunction calculateTotalPagesUI(totalResultsApi: number) {\r\n\treturn Math.ceil( totalResultsApi / itemsPerPageUI );\r\n}\r\n\r\nexport default useMovieItems;","import MoviesGrid from \"./movies-grid.component\";\r\n\r\nexport default MoviesGrid;","import React, { FC } from \"react\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport MovieResultItem from \"components/movie-result-item\";\r\nimport MovieResultSkeleton from \"components/movie-result-skeleton\";\r\nimport styles from \"./movies-grid.module.scss\";\r\nimport { isMovieItem, ItemsPortionUI } from \"hooks/useMovieItems\";\r\n\r\ninterface Props {\r\n\titems: ItemsPortionUI\r\n}\r\n\r\nconst MoviesGrid: FC<Props> = ({items}) => {\r\n\treturn (\r\n\t\t<Grid container alignItems=\"stretch\" spacing={2} className={styles.root}>\r\n\t\t\t{items.map(movie => (\r\n\t\t\t\t<Grid key={movie.id} item xs={12} sm={6} md={4}>\r\n\t\t\t\t\t{isMovieItem(movie) ?\r\n\t\t\t\t\t\t<MovieResultItem movie={movie}/>\r\n\t\t\t\t\t\t: <MovieResultSkeleton/>}\r\n\t\t\t\t</Grid>\r\n\t\t\t))}\r\n\t\t</Grid>\r\n\t);\r\n};\r\n\r\nexport default MoviesGrid;","import SearchPage from \"./search-page.component\";\r\n\r\nexport default SearchPage;","import React, { FC, useEffect } from \"react\";\r\nimport SearchBar from \"components/search-bar\";\r\nimport PaginationControls from \"components/pagination-controls\";\r\nimport LoadingSpinner from \"components/loading-spinner\";\r\nimport MovieResultsContainer from \"components/movie-results-container\";\r\nimport ErrorMessage from \"components/error-message\";\r\nimport TotalSearchResults from \"components/total-search-results\";\r\nimport styles from \"./search-page.module.scss\";\r\nimport useSearchParam from \"hooks/useSearchParam\";\r\nimport useSavedSessionParams from \"hooks/useSavedSessionParams\";\r\nimport MoviesGrid from \"components/movies-grid\";\r\nimport useMovieItems from \"hooks/useMovieItems\";\r\n\r\n\r\nconst SearchPage: FC = () => {\r\n\r\n\tuseSavedSessionParams();\r\n\r\n\tconst [searchQuery = ''] = useSearchParam(\"s\");\r\n\r\n\tconst {items, isLoading, pageUI, totalPagesUI, totalResults, goToPage, error } =\r\n\t\tuseMovieItems({name: \"search\", searchQuery});\r\n\r\n\t// This effect is to keep the paging declared on searchParams in sync totalPages max\r\n\tuseEffect(() => {\r\n\t\tif (pageUI > totalPagesUI && totalPagesUI)\r\n\t\t\tgoToPage(totalPagesUI);\r\n\t}, [goToPage, pageUI, totalPagesUI]);\r\n\r\n\treturn (\r\n\t\t<div className={styles.root}>\r\n\t\t\t<div className={styles.searchHead}>\r\n\t\t\t\t<SearchBar/>\r\n\t\t\t\t{!!totalResults && <TotalSearchResults totalResults={totalResults}/>}\r\n\t\t\t\t<PaginationControls totalPages={totalPagesUI} />\r\n\t\t\t</div>\r\n\t\t\t{isLoading ? <LoadingSpinner delay={800} fixed />\r\n\t\t\t\t: error ? <ErrorMessage error={error}/>\r\n\t\t\t\t\t: ( !!totalResults &&\r\n\t\t\t\t\t\t<MovieResultsContainer page={pageUI}>\r\n\t\t\t\t\t\t\t{() => <MoviesGrid items={items}/>}\r\n\t\t\t\t\t\t</MovieResultsContainer>\r\n\t\t\t\t\t)\r\n\t\t\t}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SearchPage;","import React, { FC } from \"react\";\r\nimport IMovieResultItem from \"../../../interfaces/app-types/IMovieResultItem\";\r\nimport styles from \"../home-page.module.scss\";\r\nimport appProperties from \"../../../appProperties\";\r\nimport LoadingSpinner from \"components/loading-spinner\";\r\nimport useMovieItems from \"../../../hooks/useMovieItems\";\r\nimport store from \"../../../store\";\r\nimport { setMovieView } from \"../../../store/movie-view/movie-view.actions\";\r\n\r\nconst {getPosterSrcPathPrefix} = appProperties;\r\n\r\n\r\nconst ThisWeekContainer: FC = () => {\r\n\r\n\tconst results = useMovieItems({name: \"trendingWeek\"});\r\n\tconst items = results.items.filter((item, i) => i < 3) as IMovieResultItem[];\r\n\r\n\treturn (\r\n\t\t<div className={styles.gridContainer}>\r\n\t\t\t{items.map((movie, i) => (\r\n\t\t\t\t<ThisWeekItem\r\n\t\t\t\t\tkey={movie.id}\r\n\t\t\t\t\titem={movie}\r\n\t\t\t\t\tbackgroundImage={`url(${getPosterSrcPathPrefix(i === 2 ? \"500\" : \"400\")}${movie.backdrop_path!})`}\r\n\t\t\t\t\tgridArea={`item${i + 1}`}\r\n\t\t\t\t\tonClickHandler={() => store.dispatch(setMovieView(movie))}\r\n\t\t\t\t/>\r\n\t\t\t))}\r\n\t\t\t{results.isLoading && <LoadingSpinner darken delay={500}/>}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\ninterface ThisWeekItemProps {\r\n\titem: IMovieResultItem;\r\n\tbackgroundImage: string;\r\n\tonClickHandler: () => void;\r\n\tgridArea: string;\r\n}\r\n\r\nconst ThisWeekItem: FC<ThisWeekItemProps> = ({item: movie, backgroundImage, onClickHandler, gridArea}) => {\r\n\treturn (\r\n\t\t<div movie-title={movie.title}\r\n\t\t     className={`${styles.gridItem} ${styles.hoveredBg}`}\r\n\t\t     style={{ gridArea }}\r\n\t\t     key={movie.id}\r\n\t\t     onClick={onClickHandler}\r\n\t\t>\r\n\t\t\t<div style={{ backgroundImage }}/>\r\n\t\t</div>\r\n\t)\r\n};\r\n\r\nexport default ThisWeekContainer;","import IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\nimport React, { FC, memo, MutableRefObject, useCallback, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { useSpring } from \"react-spring\";\r\nimport { setMovieView } from \"store/movie-view/movie-view.actions\";\r\nimport appProperties from \"../../appProperties\";\r\nimport styles from \"./items-scroll-x.module.scss\";\r\nimport store from \"../../store\";\r\n\r\nconst { getPosterSrcPathPrefix } = appProperties;\r\n\r\n\r\ninterface OwnProps {\r\n\tnoResultsFound: boolean;\r\n\tisLoading?: boolean;\r\n\titems?: IMovieResultItem[];\r\n\tclassName?: string;\r\n\tscrollByX?: number;\r\n\titemClassName?: string;\r\n\tinfoTabMessage?: string;\r\n}\r\n\r\nconst MovieItemsXScrollList: FC<OwnProps> =\r\n({isLoading = false, noResultsFound, items = [], className, scrollByX = 200, infoTabMessage, itemClassName}) => {\r\n\r\n\tconst rootRef = useRef<HTMLDivElement>(null);\r\n\r\n\tconst [scrollXPos, setScrollXPos] = useState(0);\r\n\r\n\tconst [, update] = useSpring(() => ({\r\n\t\tto: {scrollXPos},\r\n\t\tonFrame: ({scrollXPos}) => {\r\n\t\t\trootRef.current!.scroll(scrollXPos as number, 0);\r\n\t\t},\r\n\t}));\r\n\r\n\tuseEffect(() => {\r\n\t\tupdate({scrollXPos});\r\n\t}, [scrollXPos, update]);\r\n\r\n\tconst onMouseMoveHandler = useCallback(function onMouseMove(e: React.MouseEvent<HTMLDivElement>) {\r\n\t\tconst {scrollWidth, clientWidth} = e.currentTarget;\r\n\t\tconst maxScrollLeft = scrollWidth - clientWidth;\r\n\t\tlet {movementX} = e;\r\n\r\n\t\tif (e.buttons === 1)\r\n\t\t\tsetScrollXPos((prevState) => {\r\n\t\t\t\tlet nextState = prevState - movementX * 1.5;\r\n\t\t\t\tif (nextState > 0 && nextState <= maxScrollLeft) return nextState;\r\n\t\t\t\telse if (nextState > maxScrollLeft) return maxScrollLeft;\r\n\t\t\t\telse return 0;\r\n\t\t\t});\r\n\t}, []);\r\n\r\n\tconst onWheelHandler = useCallback(function onWheelHandler(e: React.WheelEvent<HTMLDivElement>) {\r\n\t\tconst {scrollWidth, clientWidth} = e.currentTarget;\r\n\t\tconst maxScrollLeft = scrollWidth - clientWidth;\r\n\r\n\t\tif (e.deltaY < 0)\r\n\t\t\t// scroll to left\r\n\t\t\tsetScrollXPos((prevState) => {\r\n\t\t\t\treturn prevState > 0 ? prevState - scrollByX : 0;\r\n\t\t\t});\r\n\t\telse\r\n\t\t\tsetScrollXPos((prevState) => {\r\n\t\t\t\tconst nextState = prevState + scrollByX;\r\n\t\t\t\tif (nextState < maxScrollLeft) return nextState;\r\n\t\t\t\telse return maxScrollLeft;\r\n\t\t\t});\r\n\t},[scrollByX]);\r\n\r\n\tconst onDownRef = useRef(0);\r\n\tconst onUpRef = useRef(0);\r\n\tconst canClick = () => onDownRef.current === onUpRef.current;\r\n\r\n\tconst itemChildren = useMemo(() => items.map((movie) => (\r\n\t\t<RelatedMovieItem\r\n\t\t\tkey={movie.id}\r\n\t\t\tmovie={movie}\r\n\t\t\tcanClick={canClick}\r\n\t\t\titemClassName={itemClassName}\r\n\t\t/>\r\n\t)), [items.length, itemClassName]);\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={`${styles.root} ${className || ''}`}\r\n\t\t\tonWheel={noResultsFound ? undefined:onWheelHandler}\r\n\t\t\tonMouseMove={noResultsFound ? undefined:onMouseMoveHandler}\r\n\t\t\tref={rootRef}\r\n\t\t\tonMouseDown={(setClientXOnRef.bind(null, onDownRef) as any)}\r\n\t\t\tonMouseUp={(setClientXOnRef.bind(null, onUpRef) as any)}\r\n\t\t\tstyle={{\r\n\t\t\t\toverflowX: isLoading || noResultsFound ? \"hidden\" : \"scroll\",\r\n\t\t\t\topacity: noResultsFound ? 0.5 : 1,\r\n\t\t\t}}\r\n\t\t\t{...(infoTabMessage ? {\"info-tab\": infoTabMessage} : {})}\r\n\t\t>\r\n\t\t\t{noResultsFound ? (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{[...new Array(5)].map((v, i) => (\r\n\t\t\t\t\t\t<RelatedMovieItem isLoading={false} movie={null} key={i}/>\r\n\t\t\t\t\t))}\r\n\t\t\t\t\t<div className={styles.noMoviesFound}>No related movies found</div>\r\n\t\t\t\t</>\r\n\t\t\t) : (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{itemChildren}\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\t\t\t{isLoading && [...new Array(5)].map((v, i) => (\r\n\t\t\t\t<RelatedMovieItem isLoading movie={null} key={i}/>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t)\r\n};\r\n\r\ninterface RelatedMovieItemProps {\r\n\tisLoading?: boolean;\r\n\tmovie: IMovieResultItem | null;\r\n\tcanClick?: () => boolean;\r\n\titemClassName?: string;\r\n}\r\n\r\nconst RelatedMovieItem: FC<RelatedMovieItemProps> =\r\n\tmemo(({isLoading = false, movie, canClick = (() => false), itemClassName}) => {\r\n\t\tconst imgSrc = movie && movie.poster_path && `url(${getPosterSrcPathPrefix(\"300\")}${movie.poster_path})`;\r\n\r\n\t\tconst onClickHandler = () => canClick() && movie && store.dispatch(setMovieView(movie));\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tclassName={`${styles.relatedMovieItemWrapper} ${itemClassName || ''}`}\r\n\t\t\t\tonDragStart={preventDefault as any}\r\n\t\t\t>\r\n\t\t\t\t<div className={`\r\n\t\t\t\t\t\t${styles.relatedMovieItem}\r\n\t\t\t\t\t\t${isLoading ? styles.isLoadingItem : ''}\r\n\t\t\t\t\t\t${(!imgSrc && !isLoading) ? styles.noPoster : ''}\r\n\t\t\t\t\t`}\r\n\t\t\t\t     title={movie?.title}\r\n\t\t\t\t     style={{backgroundImage: imgSrc || undefined}}\r\n\t\t\t\t     onDragStart={preventDefault as any}\r\n\t\t\t\t     onClick={movie ? onClickHandler : undefined}\r\n\t\t\t\t>{!imgSrc && movie ? movie.title : null}</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}, (prevProps, nextProps) => prevProps.isLoading === nextProps.isLoading);\r\n\r\n\r\nfunction setClientXOnRef(ref: MutableRefObject<number>, ev: React.MouseEvent) {\r\n\tref.current = ev.clientX;\r\n}\r\n\r\nfunction preventDefault(e: Event) {\r\n\te.preventDefault();\r\n}\r\n\r\nexport default MovieItemsXScrollList;","import ItemsScrollX from \"./items-scroll-x.component\";\r\n\r\nexport default ItemsScrollX;","import React, { FC } from \"react\";\r\nimport styles from \"../home-page.module.scss\";\r\nimport appProperties from \"appProperties\";\r\nimport { setMovieView } from \"store/movie-view/movie-view.actions\";\r\nimport store from \"store\";\r\nimport LoadingSpinner from \"components/loading-spinner\";\r\nimport MovieItemsXScrollList from \"components/items-scroll-x\";\r\nimport IMovieResultItem from \"../../../interfaces/app-types/IMovieResultItem\";\r\nimport useMovieItems from \"hooks/useMovieItems\";\r\n\r\nlet {getPosterSrcPathPrefix} = appProperties;\r\n\r\n\r\nconst NowPlayingContainer: FC = () => {\r\n\r\n\tconst results = useMovieItems({name: \"nowPlaying\"});\r\n\tconst items = (results.items as IMovieResultItem[])\r\n\r\n\tconst mainItem = items.length ? items[0] : null;\r\n\r\n\treturn (\r\n\t\t<div className={styles.nowPlayingContainer}>\r\n\t\t\t{(!results.isLoading && items.length && (\r\n\t\t\t\t<>\r\n\t                <div\r\n\t                    className={`${styles.mainMovieItem} ${styles.hoveredBg}`}\r\n\t                    movie-title={mainItem!.title}\r\n\t                    onClick={() => store.dispatch(setMovieView(mainItem!))}\r\n\t                >\r\n\t                    <div style={{backgroundImage: `url(${getPosterSrcPathPrefix(\"500\")}${mainItem!.backdrop_path!})`}}/>\r\n\t                </div>\r\n\t                <div className={styles.subMovieItemContainerWrapper}>\r\n\t\t                <MovieItemsXScrollList\r\n\t\t\t                noResultsFound={false}\r\n\t\t\t                items={items}\r\n\t\t\t                className={styles.subMovieItemContainer}\r\n\t\t\t                itemClassName={styles.subMovieItemContainerItem}\r\n\t\t\t                scrollByX={175}\r\n\t\t                />\r\n\t                </div>\r\n\t            </>\r\n\t\t\t)) || (results.isLoading && <LoadingSpinner darken delay={500}/>)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default NowPlayingContainer;","import React, { FC, memo } from \"react\";\r\nimport styles from \"./home-page.module.scss\";\r\nimport ThisWeekContainer from \"./subcomponents/this-week-container.component\";\r\nimport NowPlayingContainer from \"./subcomponents/now-playing-container.component\";\r\n\r\n\r\nconst HomePage: FC = () => {\r\n\r\n\treturn (\r\n\t\t<div className={styles.root}>\r\n\t\t\t<h1>Movie Ratings App</h1>\r\n\t\t\t<div className={styles.content}>\r\n\t\t\t\t<SpotlightSection title=\"Trending This Week\">\r\n\t\t\t\t\t<ThisWeekContainer/>\r\n\t\t\t\t</SpotlightSection>\r\n\t\t\t\t<SpotlightSection title=\"Now Playing\">\r\n\t\t\t\t\t<NowPlayingContainer/>\r\n\t\t\t\t</SpotlightSection>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst SpotlightSection: FC<{ title: string }> = ({title, children}) => (\r\n\t<div className={styles.sectionSpotlight}>\r\n\t\t<h2 className={styles.sectionTitle}>{title}</h2>\r\n\t\t<div className={styles.sectionContentWrapper}>\r\n\t\t\t<div className={styles.sectionContent}>\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n);\r\n\r\nexport default memo(HomePage, () => true);","import HomePage from \"./home-page.component\";\r\n\r\nexport default HomePage;","import React, { FC, ReactText } from \"react\";\r\nimport styles from \"./movie-view-info.module.scss\";\r\nimport { formatToUSD, getReadableDate, minutesToRuntimeDisplay } from \"utility\";\r\nimport IMovieView from \"../../interfaces/app-types/IMovieView\";\r\nimport { animated, useTransition } from \"react-spring\";\r\nimport { easeOutQuart } from \"../../utility/easingFuctions\";\r\n\r\n\r\ninterface OwnProps {\r\n    movieView: IMovieView\r\n}\r\n\r\ntype Props = OwnProps;\r\n\r\nconst MovieViewInfoChildren: FC<Props> = ({movieView: {budget, homepage, release_date, revenue, runtime, status}}) => {\r\n    let hostname = homepage ? (new URL(homepage).hostname) : null;\r\n    let jsx = (\r\n        <>\r\n            <h2 key={1} className={styles.title}>Facts</h2>\r\n\r\n            {status ? (<div key={2} className={styles.sideInfoItem}>\r\n                <h4>Status</h4>\r\n                <div>{status}</div>\r\n            </div>) : null}\r\n\r\n            {release_date ? (<div key={3} className={styles.sideInfoItem}>\r\n                <h4>Release Date</h4>\r\n                <div>{getReadableDate(release_date)}</div>\r\n            </div>) : null}\r\n\r\n            {budget ? (<div key={4} className={styles.sideInfoItem}>\r\n                <h4>Budget</h4>\r\n                <div>{'$' + formatToUSD(budget)}</div>\r\n            </div>) : null}\r\n\r\n            {revenue ? (<div key={5} className={styles.sideInfoItem}>\r\n                <h4>Revenue</h4>\r\n                <div>{'$' + formatToUSD(revenue)}</div>\r\n            </div>) : null}\r\n\r\n            {homepage ? (<div key={6} className={styles.sideInfoItem}>\r\n                <h4>Homepage</h4>\r\n                <a href={homepage} target=\"_blank\" rel=\"noopener noreferrer\">{hostname}</a>\r\n            </div>) : null}\r\n\r\n            {runtime ? (<div key={7} className={styles.sideInfoItem}>\r\n                <h4>Runtime</h4>\r\n                <div>{minutesToRuntimeDisplay(runtime)}</div>\r\n            </div>) : null}\r\n        </>\r\n    );\r\n\r\n    const transition = useTransition(\r\n        jsx!.props!.children, item => (item?.key as ReactText), {\r\n            initial: {\r\n                transform: 'translateX(300px)',\r\n                opacity: -1\r\n            },\r\n            enter: {\r\n                transform: 'translateX(0px)',\r\n                opacity: 1,\r\n            },\r\n            config: {\r\n                duration: 1300,\r\n                easing: easeOutQuart\r\n            },\r\n            trail: 105\r\n        });\r\n\r\n\r\n    return (\r\n        <>\r\n        {transition.map(({props, key, item}) => {\r\n            if(!item) return null;\r\n            // @ts-ignore\r\n            let Element = animated[item.type];\r\n            return <Element key={key} {...item.props} style={props}/>\r\n        })}\r\n        </>\r\n    );\r\n};\r\n\r\n\r\nexport default MovieViewInfoChildren;","import MovieViewInfo from \"./movie-view-info.component\";\r\n\r\nexport default MovieViewInfo;","import React, { FC } from \"react\";\r\nimport IMovieView from \"../../interfaces/app-types/IMovieView\";\r\nimport { getMovieImgObjFromSession } from \"utility\";\r\nimport styles from \"./movie-view-info.module.scss\";\r\nimport { fade } from \"@material-ui/core\";\r\nimport { animated, useSpring } from \"react-spring\";\r\nimport { easeOutQuart } from \"../../utility/easingFuctions\";\r\nimport MovieViewInfoChildren from \"./movie-view-info-children.component\";\r\nimport useOnMovieView from \"hooks/useOnMovieView\";\r\nimport useIsMobile from \"hooks/useIsMobile\";\r\n\r\ninterface OwnProps {\r\n    movieView: IMovieView | undefined;\r\n    movieId: number;\r\n}\r\n\r\ntype Props = OwnProps;\r\n\r\nconst defaultBgColor = 'rgba(160, 160, 160, .2)';\r\n\r\nconst MovieViewInfo: FC<Props> = ({movieView, movieId}) => {\r\n    const isMobile = useIsMobile();\r\n    const [left, propsState] = useOnMovieView(movieId, !isMobile ? 105 : 0, !isMobile ? {\r\n        onView: 0,\r\n        onClose: 0\r\n    } : {});\r\n\r\n    const opacity = propsState === \"close\" ? 0 : 1;\r\n\r\n    const props = useSpring({\r\n        left,\r\n        config: {\r\n            duration: 900,\r\n            easing: easeOutQuart\r\n        }\r\n    });\r\n\r\n    let colorSessionObj = getMovieImgObjFromSession(movieId);\r\n\r\n    let backgroundColor = colorSessionObj ? fade(colorSessionObj.averageColor, .2) : defaultBgColor;\r\n\r\n    return (\r\n        <animated.div className={styles.root} style={{\r\n            left: props.left.to(v => v+\"%\"),\r\n            backgroundColor,\r\n            opacity\r\n        }}>\r\n            {movieView && <MovieViewInfoChildren movieView={(movieView as IMovieView)} />}\r\n        </animated.div>\r\n    );\r\n};\r\n\r\nexport default MovieViewInfo;","import React, { CSSProperties, FC } from \"react\";\r\nimport styles from \"./movie-view-background.module.scss\";\r\nimport { fade } from \"@material-ui/core\";\r\nimport { useSessionAvgColor } from \"hooks/useSessionAvgColor\";\r\nimport useOnMovieView from \"hooks/useOnMovieView\";\r\n\r\n\r\ninterface OwnProps {\r\n    movieId: number\r\n}\r\n\r\ntype Props = OwnProps;\r\n\r\nconst bgColorOpacity = .6;\r\nconst defaultBgColor = `rgba(160, 160, 160, ${bgColorOpacity})`;\r\n\r\nconst MovieViewBackground: FC<Props> = ({movieId}) => {\r\n\r\n    const movieImgDataObj = useSessionAvgColor(movieId);\r\n\r\n    const [cssProps] = useOnMovieView<CSSProperties>(movieId, {opacity: 0}, {\r\n        onView: {\r\n            opacity: 1,\r\n            transitionDuration: \"800\"\r\n        },\r\n        onClose: {\r\n            opacity: 0,\r\n            transitionDuration: \"450\"\r\n        }\r\n    });\r\n\r\n    let bgColor = defaultBgColor;\r\n\r\n    if (movieImgDataObj)\r\n        bgColor = fade(movieImgDataObj.averageColor, bgColorOpacity);\r\n\r\n    let bgStyle: CSSProperties = {\r\n        background: `linear-gradient(180deg, transparent 0%, ${bgColor} 100%)`\r\n    };\r\n\r\n    return (\r\n        <div style={{...bgStyle, ...cssProps}} className={styles.root}/>\r\n    );\r\n};\r\n\r\n\r\nexport default React.memo(MovieViewBackground, () => true);","import MovieViewBackground from \"./movie-view-background.component\";\r\n\r\nexport default MovieViewBackground;","import React, { FC, useEffect, useState } from \"react\";\nimport styles from \"./movie-view-related.module.scss\";\nimport IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\nimport IMoviesResponseData from \"../../interfaces/app-types/IMoviesResponseData\";\nimport { goFetch } from \"utility\";\nimport appProperties from \"../../appProperties\";\nimport MovieItemsXScrollList from \"components/items-scroll-x\";\n\nconst {buildFetchMovieViewUrl} = appProperties;\n\ninterface OwnProps {\n\tmovieId: number;\n\tclassName?: string;\n}\n\nconst MovieViewRelated: FC<OwnProps> = ({movieId, className}) => {\n\n\tconst [relatedMovies, setRelatedMovies] = useState<IMovieResultItem[] | null>(\n\t\tnull\n\t);\n\n\tuseEffect(() => {\n\t\tlet ignore = false;\n\t\tgoFetch<IMoviesResponseData>(buildFetchMovieViewUrl(movieId, \"/similar\"))\n\t\t\t.then(data => {\n\t\t\t\t!ignore && setRelatedMovies(data.results)\n\t\t\t});\n\t\treturn () => { ignore = true };\n\t}, [movieId]);\n\n\n\tconst noResultsFound = !!relatedMovies && !relatedMovies.length;\n\n\treturn (\n\t\t<MovieItemsXScrollList\n\t\t\tclassName={`${styles.root} ${className || ''}`}\n\t\t\tisLoading={!relatedMovies}\n\t\t\tnoResultsFound={noResultsFound}\n\t\t\titems={relatedMovies ?? undefined}\n\t\t\tinfoTabMessage={'Related Movies \\u27A5'}\n\t\t\tscrollByX={200}\n\t\t/>\n\t);\n};\n\nexport default MovieViewRelated;\n\n","import MovieViewRelated from \"./movie-view-related.component\";\r\n\r\nexport default MovieViewRelated;","import MovieViewItem from \"./movie-view-item.component\";\r\n\r\nexport default MovieViewItem;","import React, { FC, memo, useEffect, useRef, useState } from \"react\";\r\nimport MovieResultItem from \"components/movie-result-item\";\r\nimport IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\nimport styles from \"./movie-view-item.module.scss\";\r\nimport IMovieView from \"../../interfaces/app-types/IMovieView\";\r\nimport MovieViewInfo from \"components/movie-view-info\";\r\nimport MovieViewBackground from \"components/movie-view-background\";\r\nimport MovieViewRelated from \"components/movie-view-related\";\r\nimport useOnMovieView from \"hooks/useOnMovieView\";\r\nimport { checkIsMobile, goFetchMovieView, isMovieView, scrollToTop } from \"utility\";\r\nimport MovieViewActionButtons from \"components/movie-view-actions\";\r\nimport RatingProgressBar from \"components/circled-progress-bar\";\r\nimport useIsMobile from \"hooks/useIsMobile\";\r\n\r\n\r\ninterface OwnProps {\r\n    movieItem: IMovieResultItem | IMovieView;\r\n}\r\n\r\nconst MovieViewItem: FC<OwnProps> = ({movieItem}) => {\r\n    const movieItemRef = useRef(movieItem);\r\n    const isMobile = useIsMobile();\r\n    const isMovView = isMovieView(movieItem);\r\n\r\n    const [movieView, setMovieView] = useState<IMovieView | null>(() =>\r\n        isMovView ? movieItem as IMovieView : null\r\n    );\r\n\r\n    useEffect(() => {\r\n        let ignore = false;\r\n        if (checkIsMobile())\r\n            scrollToTop();\r\n\r\n        if (!isMovieView(movieItemRef.current))\r\n            goFetchMovieView(movieItemRef.current as IMovieResultItem)\r\n                .then(movie => !ignore && setMovieView(movie))\r\n\r\n        return () => {\r\n            ignore = true\r\n        }\r\n    }, []);\r\n\r\n    const [ , state] = useOnMovieView(movieItem.id, false,  !isMobile ? {\r\n        onView: true,\r\n        onClose: false\r\n    } : {});\r\n\r\n    const isViewing = isMobile || state === \"view\";\r\n\r\n    return (\r\n        <div className={styles.root} id=\"movie-item-view\">\r\n            <MovieViewBackground movieId={movieItem.id}/>\r\n            <div className={styles.mainInfo}>\r\n                <MovieResultItem movie={movieItem as IMovieResultItem} itemView className={styles.movieItem}/>\r\n                {isMobile && (\r\n                    <>\r\n                        <div className={styles.mobileRateActions}>\r\n                            <RatingProgressBar score={movieItem.vote_average} itemView/>\r\n                            <MovieViewActionButtons item={(movieItem as IMovieResultItem)} />\r\n                        </div>\r\n                        <p className={styles.mobileOverview}>{movieItem.overview}</p>\r\n                    </>\r\n                )}\r\n                {isViewing ? <MovieViewRelated movieId={movieItem.id}/> : null}\r\n            </div>\r\n            <div className={styles.sideInfo}>\r\n                {movieView && <MovieViewInfo movieView={movieView} movieId={movieItem.id} />}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo<OwnProps>(MovieViewItem, (prevProps, nextProps) =>\r\n    prevProps.movieItem.id === nextProps.movieItem.id\r\n);","class MovieViewEvent extends CustomEvent<IMovieViewEventDetail> {\r\n    constructor(movieId: number, state: MovieViewEventState) {\r\n        super(\"movieView\", {\r\n            detail: {\r\n                movieId,\r\n                state\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nexport type MovieViewEventState = \"enter\" | \"update\" | \"view\" | \"close\" | \"leave\"\r\n\r\ninterface IMovieViewEventDetail {\r\n    movieId: number,\r\n    state: MovieViewEventState\r\n}\r\n\r\nexport default MovieViewEvent;","import { Reducer, useCallback, useEffect, useReducer, useState } from \"react\";\r\nimport useSearchParam from \"./useSearchParam\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { AppState } from \"store\";\r\nimport IMovieResultItem from \"../interfaces/app-types/IMovieResultItem\";\r\nimport IMovieView from \"../interfaces/app-types/IMovieView\";\r\nimport { goFetchMovieView } from \"utility\";\r\n\r\nconst INITIAL_STATE: MovieForViewState = {movieViewItem: null, isLoading: false};\r\n\r\nconst movieViewReducer: Reducer<MovieForViewState, ReducerAction<keyof ActionsTypesToPayloadTypeMap>> =\r\n\tfunction movieViewReducer(state, action) {\r\n\t\tswitch (action.type) {\r\n\t\t\tcase \"clear-item\":\r\n\t\t\t\treturn INITIAL_STATE;\r\n\t\t\tcase \"set-is-loading\":\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tisLoading: true\r\n\t\t\t\t};\r\n\t\t\tcase \"set-movie-item\":\r\n\t\t\t\treturn {\r\n\t\t\t\t\tisLoading: false,\r\n\t\t\t\t\tmovieViewItem: action.payload as ItemViewState\r\n\t\t\t\t};\r\n\t\t}\r\n\t};\r\n\r\n// Reducer action creators\r\nconst onSetMovieItem = (item: ItemViewState): ReducerAction<\"set-movie-item\"> => ({\r\n\ttype: \"set-movie-item\",\r\n\tpayload: item\r\n});\r\n\r\n// @ts-ignore (because \"payload\" type = undefined)\r\nconst onSetIsLoading = (): ReducerAction<\"set-is-loading\"> => ({\r\n\ttype: \"set-is-loading\",\r\n});\r\n\r\nfunction useMovieForView(): ReturnHookState {\r\n\tconst [movieIdParam = 0, setMovieId] = useSearchParam(\"movieId\");\r\n\r\n\tconst [state, dispatch] = useReducer(movieViewReducer, INITIAL_STATE);\r\n\tconst {movieViewItem, isLoading} = state;\r\n\r\n\tconst clearMovieId = () => setMovieId(null);\r\n\r\n\tconst selectMovieItem = useCallback((state: AppState) => {\r\n\t\tif (!movieIdParam) return null;\r\n\t\tconst results = state.search.searchData?.results;\r\n\t\tif (results) {\r\n\t\t\tfor (let key in results)\r\n\t\t\t\tif (results[key]?.id === movieIdParam)\r\n\t\t\t\t\treturn results[key] as IMovieResultItem;\r\n\t\t}\r\n\t\t// eslint-disable-next-line eqeqeq\r\n\t\treturn state.movieItem.item?.id == movieIdParam ? state.movieItem.item : null;\r\n\t}, [movieIdParam]);\r\n\r\n\tconst selectedMovie = useSelector<AppState, IMovieResultItem | null>(selectMovieItem, selectedAreEqual);\r\n\r\n\tconst fromSelectedId = selectedMovie?.id ?? 0;\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isLoading) return;\r\n\r\n\t\t// selectedMovie matches movieIdParam and the item id on state is not same as selectedMovie id;\r\n\t\tif (fromSelectedId === movieIdParam && movieViewItem?.id !== movieIdParam)\r\n\t\t\tdispatch(onSetMovieItem(selectedMovie)); // set selectedMovie for view\r\n\r\n\t\telse if (( !movieViewItem || ( movieViewItem && (\r\n\t\t\t\t\t\t// current itemId on state !== id on searchParam\r\n\t\t\t\t\t\t// eslint-disable-next-line eqeqeq\r\n\t\t\t\t\t\tmovieViewItem.id != movieIdParam\r\n\t\t\t\t))) && movieIdParam\r\n\t\t) {\r\n\t\t\tdispatch(onSetIsLoading());\r\n\t\t\tgoFetchMovieView(selectedMovie ?? movieIdParam)\r\n\t\t\t.then(movieView => {\r\n\t\t\t\tdispatch(onSetMovieItem(movieView))\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\telse if ( !movieIdParam && movieViewItem !== null) {\r\n\t\t\t// @ts-ignore (because \"payload\" type = undefined)\r\n\t\t\tdispatch({type: \"clear-item\"});\r\n\t\t}\r\n\r\n\t}, [movieIdParam, fromSelectedId, isLoading, movieViewItem, selectedMovie]);\r\n\r\n\tconst [movieForViewState, setMovieForViewState] =\r\n\t\tuseState<ReturnHookState>({movieViewItem, isLoading, clearMovieId});\r\n\r\n\tuseEffect(() => {\r\n\t\tsetMovieForViewState({movieViewItem, isLoading, clearMovieId})\r\n\t}, [state]);\r\n\r\n\treturn movieForViewState;\r\n}\r\n\r\nfunction selectedAreEqual(oldItem: IMovieResultItem | null, newItem: IMovieResultItem | null) {\r\n\treturn oldItem?.id === newItem?.id\r\n}\r\n\r\n// Types\r\ntype ItemViewState = IMovieResultItem | IMovieView | null;\r\ntype ReturnHookState = MovieForViewState & {clearMovieId: () => void};\r\n\r\ninterface MovieForViewState {\r\n\tmovieViewItem: ItemViewState;\r\n\tisLoading: boolean;\r\n}\r\n\r\ninterface ActionsTypesToPayloadTypeMap {\r\n\t\"set-is-loading\": undefined;\r\n\t\"set-movie-item\": ItemViewState;\r\n\t\"clear-item\": undefined;\r\n}\r\n\r\ninterface ReducerAction<Type extends keyof ActionsTypesToPayloadTypeMap> {\r\n\ttype: Type;\r\n\tpayload: ActionsTypesToPayloadTypeMap[Type]\r\n}\r\n\r\nexport default useMovieForView;","import React, { FC } from \"react\";\r\nimport styles from \"./movie-view-screen.module.scss\";\r\nimport { animated, UnknownProps, useTransition, UseTransitionProps } from \"react-spring\";\r\nimport IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\nimport usePrevious from \"hooks/usePrevious\";\r\nimport MovieViewItem from \"components/movie-view-item\";\r\nimport MovieViewEvent from \"../../utility/custom-events/MovieViewEvent\";\r\nimport useOnMovieView from \"hooks/useOnMovieView\";\r\nimport IMovieView from \"../../interfaces/app-types/IMovieView\";\r\nimport LoadingSpinner from \"components/loading-spinner\";\r\nimport useMovieForView from \"hooks/useMovieForView\";\r\nimport useIsMobile from \"hooks/useIsMobile\";\r\n\r\n\r\ntype ItemState = IMovieResultItem | IMovieView | null;\r\n\r\nconst MovieViewScreen: FC = () => {\r\n\tconst isMobile = useIsMobile();\r\n\r\n\tconst {movieViewItem, isLoading, clearMovieId} = useMovieForView();\r\n\r\n\tconst transitionConfig = getTransitionConfig(movieViewItem, isMobile);\r\n\r\n\tconst prevConfig = usePrevious(transitionConfig);\r\n\r\n\tconst appliedConfig = movieViewItem ? transitionConfig : (prevConfig ?? {});\r\n\r\n\tconst transition = useTransition(movieViewItem, movieViewItem?.id || 0, appliedConfig);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{!isMobile ? (\r\n\t\t\t\ttransition.map(({props, key, item: movieItem}) => movieItem &&\r\n                    <MovieViewRootDiv clearMovieId={clearMovieId} movieViewItem={movieItem} key={key}>\r\n                        <animated.div key={key} className={styles.transitionDiv} style={props as any}>\r\n                            <MovieViewItem movieItem={movieItem}/>\r\n                        </animated.div>\r\n                    </MovieViewRootDiv>\r\n\t\t\t\t)) : (\r\n\t\t\t\ttransition.map(({item: movieItem, key}) => movieItem &&\r\n                    <MovieViewItem key={key} movieItem={movieItem}/>\r\n\t\t\t\t)\r\n\t\t\t)}\r\n\t\t\t{isLoading && <LoadingSpinner fixed darken delay={700}/>}\r\n\t\t</>\r\n\t);\r\n};\r\n\r\ninterface RootDivProps {\r\n\tmovieViewItem: ItemState;\r\n\tclearMovieId: () => void;\r\n}\r\n\r\nconst MovieViewRootDiv: FC<RootDivProps> = React.memo(({children, movieViewItem, clearMovieId}) => {\r\n\tconst [backgroundColor] = useOnMovieView(movieViewItem?.id || 0, '', {\r\n\t\tonEnter: `rgba(0, 0, 0, 0.5)`,\r\n\t\tonClose: undefined\r\n\t});\r\n\r\n\tfunction handleClickAway({target, currentTarget}: React.MouseEvent<HTMLDivElement>) {\r\n\t\tif (target === currentTarget) {\r\n\t\t\t(target as HTMLDivElement).style.backgroundColor = \"rgba(0, 0, 0, 0)\";\r\n\t\t\tclearMovieId();\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className={styles.root} onClick={handleClickAway}\r\n\t\t     style={{backgroundColor}}>\r\n\t\t\t{children}\r\n\t\t</div>\r\n\t);\r\n}, () => true);\r\n\r\nfunction getTransitionConfig(movie: ItemState, isMobile: boolean): UnknownProps & UseTransitionProps<ItemState> {\r\n\tif (!movie) return {};\r\n\tlet animatedDiv = document.getElementById(\"main-container\") as HTMLDivElement;\r\n\tconst domRect = document.getElementById(String(movie.id))?.getBoundingClientRect();\r\n\tif (!!movie) {\r\n\t\tlet animatedDomRect = animatedDiv.firstElementChild!.getBoundingClientRect();\r\n\r\n\t\tlet initialPosition;\r\n\r\n\t\tif (domRect) {\r\n\t\t\tinitialPosition = {\r\n\t\t\t\ttop: domRect.top,\r\n\t\t\t\tleft: domRect.left,\r\n\t\t\t\tbottom: window.innerHeight - domRect.bottom,\r\n\t\t\t\twidth: domRect.width,\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tinitialPosition = {\r\n\t\t\t\ttop: window.innerHeight,\r\n\t\t\t\tleft: animatedDomRect.left,\r\n\t\t\t\tbottom: -10,\r\n\t\t\t\twidth: animatedDomRect.width,\r\n\t\t\t\topacity: 0\r\n\t\t\t};\r\n\t\t}\r\n\r\n\r\n\t\treturn {\r\n\t\t\tfrom: initialPosition,\r\n\t\t\tenter: {\r\n\t\t\t\ttop: window.innerHeight * .10,\r\n\t\t\t\tleft: animatedDomRect.x,\r\n\t\t\t\tbottom: -10,\r\n\t\t\t\twidth: animatedDomRect.width,\r\n\t\t\t\topacity: 1\r\n\t\t\t},\r\n\t\t\tleave: {\r\n\t\t\t\t...initialPosition,\r\n\t\t\t\tconfig: {\r\n\t\t\t\t\tmass: 1.5 && 12,\r\n\t\t\t\t\ttension: 170,\r\n\t\t\t\t\tfriction: 24,\r\n\t\t\t\t\tclamp: true\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tconfig: isMobile ? {\r\n\t\t\t\tduration: 0,\r\n\t\t\t} : {\r\n\t\t\t\tmass: 1.3 && 11,\r\n\t\t\t\ttension: 350,\r\n\t\t\t\tfriction: 97,\r\n\t\t\t\tprecision: 0.8,\r\n\t\t\t\tclamp: true\r\n\t\t\t},\r\n\t\t\tonStart: !isMobile ? (item: ItemState, state: string) => {\r\n\t\t\t\tif (item) {\r\n\t\t\t\t\tif (state === \"enter\") {\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tdispatchEvent(new MovieViewEvent(item.id, \"enter\"));\r\n\t\t\t\t\t\t}, 50);\r\n\t\t\t\t\t} else if (state === \"leave\")\r\n\t\t\t\t\t\tdispatchEvent(new MovieViewEvent(item.id, \"close\"));\r\n\t\t\t\t}\r\n\t\t\t} : undefined,\r\n\t\t\tonRest: !isMobile ? (item: ItemState, state: string) => {\r\n\t\t\t\tif (item) {\r\n\t\t\t\t\tif (state === \"leave\")\r\n\t\t\t\t\t\tdispatchEvent(new MovieViewEvent(item.id, \"leave\"));\r\n\t\t\t\t\telse if (state === \"enter\")\r\n\t\t\t\t\t\tdispatchEvent(new MovieViewEvent(item.id, \"view\"));\r\n\t\t\t\t}\r\n\t\t\t} : undefined\r\n\t\t};\r\n\t} else return {};\r\n}\r\n\r\nexport default React.memo(MovieViewScreen, () => true);","import MovieViewScreen from \"./movie-view-screen.component\";\r\n\r\nexport default MovieViewScreen;","import React, { FC } from \"react\";\r\nimport MovieItemImage from \"components/movie-item-image\";\r\nimport RatingProgressBar from \"components/circled-progress-bar\";\r\nimport MovieViewActionButtons from \"components/movie-view-actions\";\r\nimport IMovieResultItem from \"../../interfaces/app-types/IMovieResultItem\";\r\nimport appProperties from \"../../appProperties\";\r\nimport styles from \"./list-item.module.scss\";\r\nimport { setMovieView } from \"store/movie-view/movie-view.actions\";\r\nimport store from \"store\";\r\nimport { isMovieItem, PortionItemUI } from \"../../hooks/useMovieItems\";\r\nimport LoadingSpinner from \"../loading-spinner\";\r\n\r\nconst {getPosterSrcPathPrefix} = appProperties;\r\n\r\ninterface OwnProps {\r\n\titem: PortionItemUI\r\n}\r\nconst ListItem: FC<OwnProps> = ({item}) => {\r\n\r\n\tconst onSetMovieView = (item: IMovieResultItem) =>\r\n\t\tstore.dispatch(setMovieView(item))\r\n\r\n    return (\r\n\t    <div className={styles.root}>\r\n\t\t    {isMovieItem(item) ? <>\r\n\t\t\t    <MovieItemImage\r\n\t\t\t\t    backGroundUrl={`url(${getPosterSrcPathPrefix(\"300\")}${item.poster_path})`}\r\n\t\t\t\t    movie={item}\r\n\t\t\t\t    poster_path={item.poster_path}\r\n\t\t\t\t    className={styles.image}\r\n\t\t\t    />\r\n\t\t\t    <div className={styles.info}>\r\n\t\t\t\t    <h3 className={styles.movieTitle}\r\n\t\t\t\t        onClick={() => onSetMovieView(item!)}\r\n\t\t\t\t    >{item.title}</h3>\r\n\t\t\t\t    <div className={styles.itemActions}>\r\n\t\t\t\t\t    <RatingProgressBar score={item.vote_average} itemView/>\r\n\t\t\t\t\t    <MovieViewActionButtons item={item} className={styles.actionButtons}/>\r\n\t\t\t\t    </div>\r\n\t\t\t    </div>\r\n\t\t    </> : <LoadingSpinner delay={100} darken />}\r\n\t    </div>\r\n    );\r\n};\r\n\r\n\r\nexport default ListItem;","import ListItem from \"./list-item.component\";\r\n\r\nexport default ListItem;","import React, { CSSProperties, FC, memo, useEffect } from \"react\";\r\nimport PaginationControls from \"components/pagination-controls\";\r\nimport styles from \"./items-list.module.scss\";\r\nimport LoadingSpinner from \"components/loading-spinner\";\r\nimport ListItem from \"components/list-item\";\r\nimport MovieItemsContainer from \"components/movie-results-container\";\r\nimport { animated, useTransition } from \"react-spring\";\r\nimport { easeOutQuad } from \"../../utility/easingFuctions\";\r\nimport { UnknownProps, UseTransitionProps } from \"@react-spring/core\";\r\nimport useMovieItems, { ItemsPortionUI } from \"../../hooks/useMovieItems\";\r\nimport useSearchParam from \"../../hooks/useSearchParam\";\r\nimport { AccountItemsNames } from \"../../store/movies-browser\";\r\n\r\ninterface Props {\r\n\titemType: AccountItemsNames;\r\n}\r\n\r\nconst ItemsList: FC<Props> = ({itemType}) => {\r\n\r\n\tconst {items, totalPagesUI, pageUI, isLoading} = useMovieItems({name: itemType});\r\n\r\n\tconst [page, setPage] = useSearchParam(\"page\");\r\n\r\n\tuseEffect(() => {\r\n\t\t!page && setPage(1)\r\n\t}, [setPage, page]);\r\n\r\n\tconst title = itemType === \"favorite\" ? \"Favorites\" : \"Watchlist\";\r\n\r\n\treturn (\r\n\t\t<div className={styles.root}>\r\n\t\t\t<div className={styles.head}>\r\n\t\t\t\t<h2 className={styles.title}>{title}</h2>\r\n\t\t\t\t{totalPagesUI>1 && <PaginationControls totalPages={totalPagesUI}/>}\r\n\t\t\t</div>\r\n\r\n\t\t\t{isLoading && <LoadingSpinner darken fixed delay={750} />}\r\n\t\t\t<MovieItemsContainer page={pageUI}>\r\n\t\t\t\t{() => <ListChild items={items} />}\r\n\t\t\t</MovieItemsContainer>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\ninterface ListChildProps {\r\n\titems: ItemsPortionUI\r\n}\r\n\r\nconst ListChild: FC<ListChildProps> = memo(({items}) => {\r\n\r\n\tconst transition = useTransition(items, item => item.id, transitionConfig);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{\r\n\t\t\t\ttransition.map(({item, key, props}) => !!item && (\r\n\t\t\t\t\t<animated.div\r\n\t\t\t\t\t\tkey={key}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t...props,\r\n\t\t\t\t\t\t\ttransform: props.translateX.interpolate(v =>\r\n\t\t\t\t\t\t\t\tv ? `translateX(${v}px)` : ''\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ListItem item={item} />\r\n\t\t\t\t\t</animated.div>\r\n\t\t\t\t))\r\n\r\n\t\t\t}\r\n\t\t</>\r\n\t);\r\n})\r\n\r\nconst initialStyles: CSSProperties & UnknownProps = {\r\n\topacity: 1,\r\n\tmaxHeight: 500,\r\n\ttranslateX: 0,\r\n\tpaddingBottom: 20,\r\n};\r\n\r\nconst transitionConfig: UnknownProps & UseTransitionProps = {\r\n\tfrom: initialStyles,\r\n\tenter: initialStyles,\r\n\tleave: () => async next => {\r\n\t\t// @ts-ignore\r\n\t\tnext({maxHeight: 0, paddingBottom: 0, delay: 300}).catch(() => void 0)\r\n\t\t// @ts-ignore\r\n\t\tnext({ opacity: -.2, translateX: 300 }).catch(() => void 0)\r\n\t},\r\n\tconfig: {\r\n\t\tduration: 500,\r\n\t\teasing: easeOutQuad\r\n\t},\r\n\tunique: true\r\n}\r\n\r\nexport default ItemsList;","import ItemsList from \"./items-list.component\";\r\n\r\nexport default ItemsList;","import WatchlistPage from \"./watchlist-page.component\";\r\n\r\nexport default WatchlistPage;","import React, { FC } from \"react\";\r\nimport useSavedSessionParams from \"hooks/useSavedSessionParams\";\r\nimport ItemsList from \"components/items-list\";\r\n\r\nconst WatchlistPage: FC = () => {\r\n\r\n\tuseSavedSessionParams();\r\n\r\n    return <ItemsList itemType=\"watchlist\" />\r\n};\r\n\r\n\r\nexport default WatchlistPage;","import FavoritesPage from \"./favorites-page.component\";\r\n\r\nexport default FavoritesPage;","import React, { FC } from \"react\";\r\nimport useSavedSessionParams from \"hooks/useSavedSessionParams\";\r\nimport ItemsList from \"components/items-list\";\r\n\r\n\r\nconst FavoritesPage: FC = () => {\r\n\r\n    useSavedSessionParams();\r\n\r\n    return <ItemsList itemType=\"favorite\" />\r\n};\r\n\r\nexport default FavoritesPage;","import AuthRoute from \"./auth-route.component\";\r\n\r\nexport default AuthRoute;","import React, { FC } from 'react';\r\nimport { RouteProps } from \"react-router\";\r\nimport useAuth from \"../../hooks/useAuth\";\r\nimport { Route } from 'react-router-dom';\r\nimport AuthPage from \"../../pages/auth-page\";\r\n\r\n\r\nconst AuthRoute: FC<RouteProps> = ({component: Component, render, ...rest}) => {\r\n\tconst {isAuth} = useAuth();\r\n\r\n\treturn <Route {...rest} render={(props) => {\r\n\t\tif (!isAuth)\r\n\t\t\treturn <AuthPage/>\r\n\t\telse if (Component)\r\n\t\t\treturn <Component {...props} />\r\n\t\telse if (render)\r\n\t\t\treturn render(props)\r\n\t\telse return null\r\n\t}}/>\r\n};\r\n\r\n\r\nexport default AuthRoute;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"style\", null, \".cls-1{fill:url(#linear-gradient);}\"), /*#__PURE__*/React.createElement(\"linearGradient\", {\n  id: \"linear-gradient\",\n  y1: 17.76,\n  x2: 273.42,\n  y2: 17.76,\n  gradientUnits: \"userSpaceOnUse\"\n}, /*#__PURE__*/React.createElement(\"stop\", {\n  offset: 0,\n  stopColor: \"#90cea1\"\n}), /*#__PURE__*/React.createElement(\"stop\", {\n  offset: 0.56,\n  stopColor: \"#3cbec9\"\n}), /*#__PURE__*/React.createElement(\"stop\", {\n  offset: 1,\n  stopColor: \"#00b3e5\"\n})));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"title\", null, \"Asset 3\");\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Layer_2\",\n  \"data-name\": \"Layer 2\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Layer_1-2\",\n  \"data-name\": \"Layer 1\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-1\",\n  d: \"M191.85,35.37h63.9A17.67,17.67,0,0,0,273.42,17.7h0A17.67,17.67,0,0,0,255.75,0h-63.9A17.67,17.67,0,0,0,174.18,17.7h0A17.67,17.67,0,0,0,191.85,35.37ZM10.1,35.42h7.8V6.92H28V0H0v6.9H10.1Zm28.1,0H46V8.25h.1L55.05,35.4h6L70.3,8.25h.1V35.4h7.8V0H66.45l-8.2,23.1h-.1L50,0H38.2ZM89.14.12h11.7a33.56,33.56,0,0,1,8.08,1,18.52,18.52,0,0,1,6.67,3.08,15.09,15.09,0,0,1,4.53,5.52,18.5,18.5,0,0,1,1.67,8.25,16.91,16.91,0,0,1-1.62,7.58,16.3,16.3,0,0,1-4.38,5.5,19.24,19.24,0,0,1-6.35,3.37,24.53,24.53,0,0,1-7.55,1.15H89.14Zm7.8,28.2h4a21.66,21.66,0,0,0,5-.55A10.58,10.58,0,0,0,110,26a8.73,8.73,0,0,0,2.68-3.35,11.9,11.9,0,0,0,1-5.08,9.87,9.87,0,0,0-1-4.52,9.17,9.17,0,0,0-2.63-3.18A11.61,11.61,0,0,0,106.22,8a17.06,17.06,0,0,0-4.68-.63h-4.6ZM133.09.12h13.2a32.87,32.87,0,0,1,4.63.33,12.66,12.66,0,0,1,4.17,1.3,7.94,7.94,0,0,1,3,2.72,8.34,8.34,0,0,1,1.15,4.65,7.48,7.48,0,0,1-1.67,5,9.13,9.13,0,0,1-4.43,2.82V17a10.28,10.28,0,0,1,3.18,1,8.51,8.51,0,0,1,2.45,1.85,7.79,7.79,0,0,1,1.57,2.62,9.16,9.16,0,0,1,.55,3.2,8.52,8.52,0,0,1-1.2,4.68,9.32,9.32,0,0,1-3.1,3A13.38,13.38,0,0,1,152.32,35a22.5,22.5,0,0,1-4.73.5h-14.5Zm7.8,14.15h5.65a7.65,7.65,0,0,0,1.78-.2,4.78,4.78,0,0,0,1.57-.65,3.43,3.43,0,0,0,1.13-1.2,3.63,3.63,0,0,0,.42-1.8A3.3,3.3,0,0,0,151,8.6a3.42,3.42,0,0,0-1.23-1.13A6.07,6.07,0,0,0,148,6.9a9.9,9.9,0,0,0-1.85-.18h-5.3Zm0,14.65h7a8.27,8.27,0,0,0,1.83-.2,4.67,4.67,0,0,0,1.67-.7,3.93,3.93,0,0,0,1.23-1.3,3.8,3.8,0,0,0,.47-1.95,3.16,3.16,0,0,0-.62-2,4,4,0,0,0-1.58-1.18,8.23,8.23,0,0,0-2-.55,15.12,15.12,0,0,0-2.05-.15h-5.9Z\"\n})));\n\nvar SvgLogo = function SvgLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 273.42 35.52\",\n    ref: svgRef\n  }, props), _ref2, title === undefined ? _ref3 : title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref4);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/logo.fb0541f7.svg\";\nexport { ForwardRef as ReactComponent };","import React, { FC } from 'react';\r\nimport { ReactComponent as Logo } from \"./logo.svg\";\r\nimport styles from \"./api-logo.module.scss\";\r\n\r\nconst ApiLogo: FC = () =>\r\n    <div className={styles.root}>\r\n        Made with <a href={\"https://www.themoviedb.org/\"} target=\"_blank\" rel=\"noopener noreferrer\"><Logo title=\"themoviedb.org\"/></a> API\r\n    </div>\r\n\r\n\r\nexport default ApiLogo;","import React, { FC, useEffect } from \"react\";\nimport AppBar from \"./components/app-bar\";\nimport Container from \"@material-ui/core/Container\";\nimport styles from \"./App.module.scss\";\nimport SearchPage from \"pages/search-page\";\nimport { goFetchUserAccount } from \"utility\";\nimport { Route, Switch } from \"react-router-dom\";\nimport HomePage from \"pages/home-page\";\nimport MovieViewScreen from \"components/movie-view-screen\";\nimport { setUser } from \"store/user/user.actions\";\nimport store from \"store\";\nimport AuthPage from \"pages/auth-page\";\nimport useIsMobile from \"hooks/useIsMobile\";\nimport WatchlistPage from \"pages/watchlist-page\";\nimport FavoritesPage from \"pages/favorites-page\";\nimport AuthRoute from \"components/auth-route\";\nimport ApiLogo from \"./components/api-logo/api-logo.component\";\n\nconst routesChildren = (\n\t<>\n\t\t<Route exact path=\"/\" render={() => <HomePage /> } />\n\t\t<Route path=\"/search\" render={() => <SearchPage /> } />\n\t\t<AuthRoute path=\"/favorites\" render={() => <FavoritesPage /> } />\n\t\t<AuthRoute path=\"/watchlist\" render={() => <WatchlistPage /> } />\n\t\t<Route path=\"/account\" render={() => <AuthPage /> } />\n\t</>\n);\n\n\nconst App: FC = () => {\n\tconst isMobile = useIsMobile();\n\n\tuseEffect(() => {\n\t\tconsole.log(\"loaded movie-ratings-app v1.1.2\");\n\t\tsessionStorage.clear();\n\t\tgoFetchUserAccount()\n\t\t\t.then(user => store.dispatch(setUser(user)))\n\t\t\t.catch(console.error)\n\t}, []);\n\n\treturn (\n\t\t<div className={styles.root}>\n\t\t\t<AppBar/>\n\t\t\t<main className={styles.main} id=\"main-container\">\n\t\t\t\t<Container>\n\t\t\t\t\t{!isMobile ? (\n\t\t\t\t\t\t<Switch>\n\t\t\t\t\t\t\t{routesChildren}\n\t\t\t\t\t\t</Switch>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t<Route render={ ({location}) => {\n\t\t\t\t\t\t\tif (!location.search.includes('movieId'))\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Switch location={location}>\n\t\t\t\t\t\t\t\t\t\t{routesChildren}\n\t\t\t\t\t\t\t\t\t</Switch>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\telse return <MovieViewScreen/>\n\t\t\t\t\t\t}}/>\n\t\t\t\t\t)}\n\t\t\t\t</Container>\n\t\t\t\t{!isMobile && <MovieViewScreen/>}\n\t\t\t</main>\n\t\t\t<ApiLogo />\n\t\t</div>\n\t);\n};\n\n\nexport default App;\n","// @ts-nocheck\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport './styles/index.scss';\nimport * as serviceWorker from \"./serviceWorker\";\nimport 'typeface-roboto';\nimport { HashRouter } from \"react-router-dom\";\nimport { Provider } from \"react-redux\";\nimport store from \"store\";\nimport { StylesProvider } from \"@material-ui/core/styles\";\nimport { onWorkerFetchedDoneEvent } from \"utility\";\n// @ts-ignore\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport Worker from \"worker-loader!./myWebWorker\";\n\nwindow.worker = new Worker();\nwindow.worker.onmessage = onWorkerFetchedDoneEvent;\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n\n\nconst render = () => {\n    const App = require('./App').default\n\n    ReactDOM.render(\n        <Provider store={store}>\n            <HashRouter>\n                <StylesProvider injectFirst>\n                    <App />\n                </StylesProvider>\n            </HashRouter>\n        </Provider>,\n        document.getElementById('root')\n    )\n}\n\nrender();\n\n// @ts-ignore\nif (process.env.NODE_ENV === 'development' && module.hot) module.hot.accept('./App', render);\n"],"sourceRoot":""}